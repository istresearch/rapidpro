(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,n){e.exports={unicode_char:"UnicodeList_unicode_char__3oGkq",unicode_list:"UnicodeList_unicode_list__36pET"}},113:function(e,t,n){e.exports={scheme_selection:"AddURNForm_scheme_selection__3qqeb",path:"AddURNForm_path__vTuFJ"}},114:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",chosen:"MultiChoice_chosen__3fQUn",item:"MultiChoice_item__2hkE_"}},115:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",text:"SayMsg_text__2WoYr",recording:"SayMsg_recording__3JHw8"}},116:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",code:"TransferAirtime_code__3WV9i",amount:"TransferAirtime_amount__3mMNG"}},117:function(e,t,n){e.exports={optional_text_input:"OptionalTextInput_optional_text_input__N6zb8",toggle_link:"OptionalTextInput_toggle_link__3-B4a"}},118:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",errors:"ValidationFailures_errors__3qGX8",error:"ValidationFailures_error__2Q3Gg"}},120:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",case_list:"CaseList_case_list__8CbuZ",kase:"CaseList_kase__1FwXZ"}},121:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",lead_in:"FieldRouterForm_lead_in__ShYLI",field_select:"FieldRouterForm_field_select__n0Csy"}},123:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",draggable:"CanvasDraggable_draggable__cqsGq",selected:"CanvasDraggable_selected__2GgF7"}},13:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",sim_container:"Simulator_sim_container__H7rj0",simulator:"Simulator_simulator__2tU1d",sim_hidden:"Simulator_sim_hidden__1ggwF",screen:"Simulator_screen__2Qp5p",header:"Simulator_header__2r6Gy",close:"Simulator_close__1RMuB",time:"Simulator_time__3FKl6",battery:"Simulator_battery__3Wa1Y",wifi:"Simulator_wifi__2E-6D",footer:"Simulator_footer__1_obl",reset:"Simulator_reset__1A78l",inactive:"Simulator_inactive__3bLl7",active:"Simulator_active__1MwaM",messages:"Simulator_messages__3Oalm",controls:"Simulator_controls__1TlMu",show_attachments_button:"Simulator_show_attachments_button__3LFcV",attachment_buttons:"Simulator_attachment_buttons__hDIT5",visible:"Simulator_visible__3BBvQ",drawer:"Simulator_drawer__340zx",drawer_visible:"Simulator_drawer_visible__1jBzI",forced:"Simulator_forced__19aUl",drawer_header:"Simulator_drawer_header__nlorO",map_thumb:"Simulator_map_thumb__1zB9o",audio_picker:"Simulator_audio_picker__V2K8X",audio_icon:"Simulator_audio_icon__Ve23Y",audio_message:"Simulator_audio_message___4Yvw",keypad:"Simulator_keypad__29cCi",keypad_entry:"Simulator_keypad_entry__2S4e_",keys:"Simulator_keys__W8GcS",row:"Simulator_row__mtRhr",key:"Simulator_key__Wv2KS",drawer_items:"Simulator_drawer_items__PYHpL",drawer_item:"Simulator_drawer_item__yZRIg",simulator_tab:"Simulator_simulator_tab__uRMHB",tab_hidden:"Simulator_tab_hidden__1BDkU",simulator_tab_icon:"Simulator_simulator_tab_icon__3cmxe",simulator_tab_text:"Simulator_simulator_tab_text__1aI0Q",detail_webhook_called:"Simulator_detail_webhook_called__1A8Iu",quick_replies:"Simulator_quick_replies__3wan9",quick_reply:"Simulator_quick_reply__sSRfK"}},149:function(e,t,n){e.exports=n.p+"static/media/map.5e547148.jpg"},157:function(e){e.exports={actions:{add_contact_groups:{description:"Add the contact to a group",name:"Add to Group"},add_contact_urn:{description:"Add a URN for the contact",name:"Add URN"},add_input:{description:"Label the incoming message",name:"Add Labels"},call_resthook:{description:"Call Zapier",name:"Call Zapier"},call_webhook:{description:"Call a webhook",name:"Call Webhook"},enter_flow:{description:"Enter another flow",name:"Enter a Flow"},play_audio:{description:"Play a contact recording",name:"Play Recording"},play_message:{description:"Play a message",name:"Play Message"},remove_contact_groups:{description:"Remove the contact from a group",name:"Remove from Group"},say_msg:{placeholder:"Send a message to the contact"},send_broadcast:{description:"Send somebody else a message",name:"Send Broadcast",placeholder:"Send a message to the contact"},send_email:{description:"Send an email",name:"Send Email"},send_msg:{description:"Send the contact a message",name:"Send Message",placeholder:"Send a message to the contact"},set_contact_field:{description:"Update the contact",name:"Update Contact"},set_run_result:{description:"Save a result for this flow",name:"Save Flow Result"},split_by_contact_field:{description:"Split by a contact field",name:"Split by Contact Field"},split_by_expression:{description:"Split by a custom expression",name:"Split by Expression"},split_by_groups:{description:"Split by group membership",name:"Split by Group Membership"},split_by_intent:{description:"Split by intent",name:"Split by Intent"},split_by_random:{description:"Split by random chance",name:"Split Randomly"},split_by_run_result:{description:"Split by a result in the flow",name:"Split by Flow Result"},start_session:{description:"Start somebody else in a flow",name:"Start Somebody Else"},transfer_airtime:{description:"Send the contact airtime",name:"Send Airtime"},wait_for_audio:{description:"Wait for an audio recording",name:"Wait for Audio"},wait_for_digits:{description:"Wait for multiple digits",name:"Wait for Digits"},wait_for_image:{description:"Wait for an image",name:"Wait for Image"},wait_for_location:{description:"Wait for location GPS coordinates",name:"Wait for Location"},wait_for_menu:{description:"Wait for menu selection",name:"Wait for Menu Selection"},wait_for_response:{description:"Wait for the contact to respond",name:"Wait for Response"},wait_for_video:{description:"Wait for a video",name:"Wait for Video"}},add:"Add",asset_selector:{placeholder:"Select existing [[name]] or enter a new one",placeholder_plural:"Select existing [[name]] or enter a new one"},body:"Body",buttons:{cancel:"Cancel",ok:"Ok"},create_group:"Create Group",create_label:"Create Label",drag_helper:"To connect nodes, <1>drag</1> from the red circle.",empty_flow_message:"<0>Let's get started</0><1>We recommend starting your flow by sending a message. This message will be sent to anybody right after they join the flow. This is your chance to send a single message or ask them a question.</1>",enter_to_create_group:"Enter a name to create a new group",enter_to_create_label:"Enter the name of an existing label or create a new one",errors:{group_not_found:"Enter the name of an existing group",http_header_missing_name:"HTTP headers must have a name"},forms:{add_groups:{summary:"Select the groups to add the contact to."},add_labels:{summary:"Select the labels to apply to the incoming message."},add_urn:{summary:"Add a new URN to reach the contact such as a phone number."},call_webhook:{body_summary:"Modify the body of the [[method]] request that will be sent to your webhook.",example:'This response would add <1>@webhook.product</1> and <4>@webhook["stock level"]</4> for use in the flow.',header:"Header",header_name:"Header Name",header_summary:"Add any additional headers below that you would like to send along with your request.",header_value:"Value",help:"If your server responds with JSON, each property will be added to the Flow.",url_placeholder:"Enter a URL"},expression_label:"If the expression...",message_label:"If the message response...",play_audio:{help_text:"Enter a variable that contains a recording the contact has previously recorded. For example, @results.voicemail or @fields.short_bio.",recording_label:"Previous Recording"},remove_groups:{placeholder:"Enter the name of an existing group",remove_from_all_label:"Remove from all",remove_from_all_summary:"Remove the active contact from all groups they're a member of.",summary:"Select the groups to remove the contact from."},result_name_help:"By naming the result, you can reference it later using [[resultFormat]]",save_as_title:"Save as..",save_result_name:"Result Name",send_email:{message_name:"Message",recipient_name:"Recipient",recipient_placeholder:"To",recipient_prompt:"Enter email address",subject_name:"Subject",subject_placeholder:"Subject"},send_msg:{add_quick_reply:"Add a new Quick Reply and press enter.",all_destinations:"Send a message to all destinations known for this contact. If you aren't sure what this means, leave it unchecked.",localized_quick_replies:"Add a new [[language]] Quick Reply and press enter.",quick_replies:'Quick Replies are made into buttons for supported channels. For example, when asking a question, you might add a Quick Reply for "Yes" and one for "No".',summary:"Add an attachment to each message. The attachment can be a file you upload or a dynamic URL using expressions and variables from your Flow.",summary_plural:"Add an attachment to each message. The attachment can be a file you upload or a dynamic URL using expressions and variables from your Flow.",whatsapp_warning:"Sending messages over a WhatsApp channel requires that a template be used if you have not received a message from a contact in the last 24 hours. Setting a template to use over WhatsApp is especially important for the first message in your flow."},set_run_result:{create_prefix:"New: "},split:{localize_rules:"Sometimes languages need special rules to route things properly. If a translation is not provided, the original rule will be used."},split_by_group:{label:"Select the groups you'd like to split by below"},type_label:"When a contact arrives at this point in your flow..."},groups:"Groups",message:"Message",operator:{has_pattern:"matches regex"},operators:{has_all_words:"has all of the words",has_any_word:"has any of the words",has_beginning:"starts with",has_category:"has the category",has_date:"has a date",has_date_category:"Has Date",has_date_eq:"has a date equal to",has_date_gt:"has a date after",has_date_lt:"has a date before",has_district:"has district",has_district_category:"Has District",has_email:"has an email",has_email_category:"Has Email",has_error:"has an error",has_error_category:"Has Error",has_group:"is in the group",has_intent:"has intent",has_number:"has a number",has_number_between:"has a number between",has_number_eq:"has a number equal to",has_number_gt:"has a number above",has_number_gte:"has a number at or above",has_number_lt:"has a number below",has_number_lte:"has a number at or below",has_only_phrase:"has only the phrase",has_phone:"has a phone number",has_phone_category:"Has Phone",has_phrase:"has the phrase",has_state:"has state",has_state_category:"Has State",has_text:"has some text",has_time:"has a time",has_top_intent:"has top intent",has_value:"is not empty",has_value_category:"Not Empty",has_ward:"has ward",has_ward_category:"Has Ward"},removal_confirmation:"Remove?",revisions:{header:"Revisions",label:"Revision History"},schemes:{email:"Email Address",external:"External ID",facebook:"Facebook ID",firebase:"Firebase ID",jiochat:"Jiochat ID",line:"Line ID",phone:"Phone Number",telegram:"Telegram ID",twitter:"Twitter Handle",twitterid:"Twitter ID",viber:"Viber ID",wechat:"Wechat ID",whatsapp:"Whatsapp Number"},simulator:{added_to_group:"Added to ",airtime_transferred:"Transferred [[amount]] [[currency]] to [[recipient]]",contact_field_changed:'Set contact "[[field]]" to "[[value]]"',contact_language_changed:'Set preferred language to "[[language]]"',contact_name_changed:'Set contact name to "[[name]]"',flow_entered:'Entered flow "[[flow]]"',httplog_dialog:"HTTP Request Details",msg_wait:"Waiting for reply",removed_from_group:"Removed from ",resthook_called:'Triggered flow event "[[resthook]]"',run_result_changed:'Set result "[[field]]" to "[[value]]"',sent_email:{subject:"Subject",to:"To"},sent_email_dialog:"Email Details",session_triggered:'Started somebody else in "[[flow]]"'},sticky:{body:"...",title:"New Note"},translation:"Translation"}},158:function(e){e.exports={forms:{send_msg:{summary_plural:"Add up to [[count]] attachments to each message. Each attachment can be a file you upload or a dynamic URL using expressions and variables from your Flow."}}}},159:function(e){e.exports={}},162:function(e,t,n){e.exports={type_list:"TypeList_type_list__3OATW"}},165:function(e,t,n){e.exports={checkbox:"RemoveGroupsForm_checkbox__3W5g6"}},166:function(e,t,n){e.exports={value:"UpdateContactForm_value__19Fyz"}},167:function(e,t,n){e.exports={result_name:"AirtimeRouterForm_result_name__IPVnQ"}},169:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",lead_in:"DigitsRouterForm_lead_in__1_8u2"}},170:function(e,t,n){e.exports={result_name:"ResthookRouterForm_result_name__dcAsY"}},171:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",result_name:"WaitRouterForm_result_name__1QlYs"}},172:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",link:"ClassifyRouterForm_link__20QgF"}},173:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",loading:"Loading_loading__3-t_e",pulse:"Loading_pulse__apphI"}},176:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",empty_flow:"Flow_empty_flow__roKNh"}},180:function(e,t,n){e.exports=n(336)},181:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13"}},182:function(e,t,n){},25:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",evt:"LogEvent_evt__1J8Uq",fadein:"LogEvent_fadein__kgfF4",msg_text:"LogEvent_msg_text__1HqoJ",ivr_msg:"LogEvent_ivr_msg__2pGYZ",send_msg:"LogEvent_send_msg__195Tn",msg_received:"LogEvent_msg_received__gf2kP",image_attachment:"LogEvent_image_attachment__2Ku4T",error:"LogEvent_error__2oBQ9",info:"LogEvent_info__12nsu",email:"LogEvent_email__1XyUb",webhook:"LogEvent_webhook__3jEK2",video_attachment:"LogEvent_video_attachment__2xn3C",audio_attachment:"LogEvent_audio_attachment__2iBWG",media_player:"LogEvent_media_player__22CtH",audio_text:"LogEvent_audio_text__3j-uW",email_details:"LogEvent_email_details__1f2TW",to:"LogEvent_to__H-JTa",subject:"LogEvent_subject__mN7Lz",body:"LogEvent_body__2hSdi",webhook_details:"LogEvent_webhook_details__3mtJW",response:"LogEvent_response__2oEy0",event_viewer:"LogEvent_event_viewer__2D4uw",has_detail:"LogEvent_has_detail__ZRVpP",classification:"LogEvent_classification__2arCX"}},26:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",clickable:"Dialog_clickable__1gSoh",dialog:"Dialog_dialog__16A3R",header:"Dialog_header__YD-Nm",header_overlay:"Dialog_header_overlay__1Of6F",header_icon:"Dialog_header_icon__2z4U8",title:"Dialog_title__1IRe1",barber:"Dialog_barber__3x6cp",iconed:"Dialog_iconed__2eQKD",title_container:"Dialog_title_container__2HiUa",content:"Dialog_content__1YGhY",footer:"Dialog_footer__3UylY",gutter:"Dialog_gutter__1Xxy-",buttons:"Dialog_buttons__1T0cB",left_buttons:"Dialog_left_buttons__31hp_",right_buttons:"Dialog_right_buttons__3NHBO",tabs:"Dialog_tabs__2gLgU",tab:"Dialog_tab__1x47g",tab_icon:"Dialog_tab_icon__28etF",active:"Dialog_active__3yOgq"}},28:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",option_list:"TextInputElement_option_list__18zXF",option_summary:"TextInputElement_option_summary__qaT6A",option_signature:"TextInputElement_option_signature__3c1zs",option:"TextInputElement_option__5N_r_",selected:"TextInputElement_selected__2bCI1",first_option:"TextInputElement_first_option__2owME",fn_marker:"TextInputElement_fn_marker__38I-n",function_help:"TextInputElement_function_help__2jwVQ",completion_container:"TextInputElement_completion_container__3c00R",options_wrapper:"TextInputElement_options_wrapper__2knDu",fn_container:"TextInputElement_fn_container__3tmtw",option_name:"TextInputElement_option_name__2G-0k",option_examples:"TextInputElement_option_examples__2l6sa",example_header:"TextInputElement_example_header__3a5qK",example:"TextInputElement_example__3MAGO",fn_signature:"TextInputElement_fn_signature__efYOL",wrapper:"TextInputElement_wrapper__1q0lN",help:"TextInputElement_help__1dGMQ",hidden:"TextInputElement_hidden__3Xul8",textinput:"TextInputElement_textinput__2eOxW"}},32:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",exit:"Exit_exit__36tB1",translating:"Exit_translating__mA2Hf",unnamed_exit:"Exit_unnamed_exit__1H6-H",endpoint:"Exit_endpoint__1D08c",missing_localization:"Exit_missing_localization__h2WGJ",name:"Exit_name__22WdX",activity:"Exit_activity__11sTW",count:"Exit_count__1tNM8",confirm_delete:"Exit_confirm_delete__26Wo-",confirm_x:"Exit_confirm_x__1AODA",recent_messages:"Exit_recent_messages__1wUzf",no_recents:"Exit_no_recents__R97kK",title:"Exit_title__3Ugsu",loading:"Exit_loading__37ssZ",message:"Exit_message__Q_zU9",text:"Exit_text__1-x4W",sent:"Exit_sent__1DkCx"}},33:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",yellow:"Sticky_yellow__39XW4",color_option:"Sticky_color_option__32vU5",sticky:"Sticky_sticky__3QUKK",blue:"Sticky_blue__3s2JL",purple:"Sticky_purple__278EO",gray:"Sticky_gray__39re9",green:"Sticky_green__3BQ0M",color_chooser_container:"Sticky_color_chooser_container__2lT4F",color_chooser:"Sticky_color_chooser__3Jbqj",sticky_container:"Sticky_sticky_container__CAgg9",selected:"Sticky_selected__1Ra33",removal:"Sticky_removal__2Ktvw",title_wrapper:"Sticky_title_wrapper__2QWs9",remove_button:"Sticky_remove_button__2jDO8",title:"Sticky_title__1kkPN",confirmation:"Sticky_confirmation__wEJ6P",body_wrapper:"Sticky_body_wrapper__3vHL0",body:"Sticky_body__18mNO"}},336:function(e,t,n){"use strict";n.r(t);n(181),n(182);var a,r,i,o,s,l,c,u,d,p=n(3),h=n(4),m=n(6),f=n(5),v=n(8),g=n(7),_=n(2),y=n(9),b=n(0),O=n.n(b),k=n(29);!function(e){e.switch="switch",e.random="random"}(a||(a={})),function(e){e.msg="msg"}(r||(r={})),function(e){e.digits="digits",e.audio="audio",e.image="image",e.video="video",e.location="location"}(i||(i={})),function(e){e.UUID="uuid",e["Created By"]="created_by",e["Modified By"]="modified_by",e.Org="org",e.Name="name",e.Language="language",e.Timezone="timezone",e.Channel="channel",e.Email="email",e.Mailto="mailto",e.Phone="phone",e.Groups="groups"}(o||(o={})),function(e){e.text="text",e.numeric="numeric",e.datetime="datetime",e.state="state",e.district="district",e.ward="ward"}(s||(s={})),function(e){e.Complete="C",e.Expired="E"}(l||(l={})),function(e){e.Complete="Complete",e.Expired="Expired"}(c||(c={})),function(e){e.Success="Success",e.Failure="Failure"}(u||(u={})),function(e){e.Success="Success",e.Failure="Failed"}(d||(d={}));var E=function(){function e(t,n){var a=n.id,r=n.name;Object(p.a)(this,e),this.localizedKeys={},this.localizedObject=void 0,this.localized=!1,this.iso=void 0,this.name=void 0,this.language=void 0,this.localizedObject=t,this.iso=a,this.language={iso:this.iso,name:r}}return Object(h.a)(e,[{key:"getLanguage",value:function(){return this.language||this.iso&&(this.language={iso:this.iso,name:this.name}),this.language}},{key:"hasTranslation",value:function(e){return e in this.localizedKeys}},{key:"addTranslation",value:function(e,t){this.localized||(this.localizedObject=Object.assign({},this.localizedObject),this.localized=!0),Array.isArray(this.localizedObject[e])?this.localizedObject[e]=t:1===t.length&&(this.localizedObject[e]=t[0]),this.localizedKeys[e]=!0}},{key:"isLocalized",value:function(){return this.localized}},{key:"getObject",value:function(){return this.localizedObject}}]),e}(),C=function(){function e(){Object(p.a)(this,e)}return Object(h.a)(e,null,[{key:"translate",value:function(e,t,n){var a=new E(e,t);if(n&&e.uuid in n){var r=n[e.uuid];Object.keys(r).forEach(function(e){return a.addTranslation(e,r[e])})}return a}}]),e}(),w=n(108),S=n(94),j=n.n(S);var N,x=/\s+(?=\S)/g,P=parseInt(j.a.grid_size,10)||20,D=parseInt(j.a.node_spacing,10)||10,R=parseInt(j.a.node_padding,10)||10,T=function(e,t){var n=e%P,a=t%P;return n>P/3?n=P-n:n*=-1,a>P/3?a=P-a:a*=-1,{left:Math.max(e+n,0),top:Math.max(t+a,0)}},A=function(e){var t=e.left%P,n=e.top%P;t>P/3?t=P-t:t*=-1,n>P/3?n=P-n:n*=-1;var a=Math.max(e.left+t,0),r=Math.max(e.top+n,0);return{left:a,top:r,right:a+e.right-e.left,bottom:r+e.bottom-e.top}},U=function(e){return e.toLowerCase().trim().replace(x,"_")},F=function(e){return e.replace(/\b\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},I=function(e){return 0===e?"react-select select-base":"react-select select-base select-invalid"},M=function(e,t){if(!e.length)return!1;var n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,l=!0,c=!1,u=void 0;try{for(var d,p=t[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var h=d.value;if(s.match(h))return!0}}catch(m){c=!0,u=m}finally{try{l||null==p.return||p.return()}finally{if(c)throw u}}}}catch(m){a=!0,r=m}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return!1},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return{onMouseDown:function(e){n&&n(e)},onMouseUp:function(n){t&&t()||e(n)}}},z=function(e,t,n){return C.translate(e,n,t[n.id])},B=function(e){return b.createElement("span",{className:"emph"},e)},V=function(e){return function(t,n){return e?t:n||null}},q=function(e){return null!==e&&void 0!==e},H=function(e){return!1},K=function(e){return{$set:e}},G=function(e){return{$merge:e}},W=function(e){return{$unset:e}},Y=function(e){return{$push:e}},Q=function(e){return{$splice:e}},X=function(){return Object(w.v4)()},Z=function(e,t){return Array.from({length:t-e},function(t,n){return n+e})},$=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return"".concat(t).concat(1!==e?n:"")},J=function(e,t){return!!e.find(function(e){return e===t})},ee=n(80),te=n.n(ee);!function(e){e.primary="primary",e.secondary="secondary",e.tertiary="tertiary"}(N||(N={}));var ne,ae=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={active:!1},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleMouseDown",value:function(e){this.setState({active:!0})}},{key:"handleMouseUp",value:function(e){this.setState({active:!1})}},{key:"render",value:function(){var e=this.props,t=e.onRef,n=e.name,a=e.onClick,r=e.type,i=e.disabled,o=e.leftSpacing,s=e.topSpacing,l=e.iconName;return b.createElement("div",{ref:t,style:{marginLeft:o?10:0,marginTop:s?10:0},onClick:a,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,className:"".concat(te.a.btn," ").concat(te.a[r]," ").concat(i?te.a.disabled:""," ").concat(this.state.active?te.a.active:"")},V(null!=l)(b.createElement("span",{style:{paddingRight:4},className:l})),n)}}]),t}(b.Component),re=n(54),ie=n.n(re),oe=n(26),se=n.n(oe);!function(e){e.NORMAL="normal",e.BARBER="barber"}(ne||(ne={}));var le,ce=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).tabFocus=null,n.primaryButton=null,n.state={activeTab:-1},Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^get/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"showTab",value:function(e){this.setState({activeTab:e})}},{key:"handlePrimaryButton",value:function(e){var t=this;e(),this.tabFocus=window.setTimeout(function(){var e=!1;(t.props.tabs||[]).forEach(function(n,a){if(n.hasErrors)return t.setState({activeTab:a}),void(e=!0)}),e||t.setState({activeTab:-1})},0)}},{key:"handleKey",value:function(e){"Enter"===e.key&&e.shiftKey&&(this.primaryButton?(e.preventDefault(),e.stopPropagation(),e.target.blur(),this.primaryButton.click(),e.target.focus()):console.log("No primary button!"))}},{key:"componentDidMount",value:function(){window.document.addEventListener("keydown",this.handleKey,{capture:!0})}},{key:"componentWillUnmount",value:function(){window.clearTimeout(this.tabFocus),window.document.removeEventListener("keydown",this.handleKey,{capture:!0})}},{key:"getButtons",value:function(){var e=this,t=[],n=this.props.buttons||{primary:null,secondary:null,tertiary:null};n.secondary&&t.push(b.createElement(ae,Object.assign({key:0,type:N.secondary},n.secondary))),n.primary&&t.push(b.createElement(ae,{key:"button_"+n.primary.name,onRef:function(t){e.primaryButton=t},onClick:function(){e.handlePrimaryButton(n.primary.onClick)},leftSpacing:!0,name:n.primary.name,disabled:n.primary.disabled,type:N.primary}));var a=[];return n.tertiary&&a.push(b.createElement(ae,Object.assign({key:0,type:N.tertiary},n.tertiary))),{leftButtons:a,rightButtons:t}}},{key:"render",value:function(){var e=this,t=[se.a.header];this.state.activeTab>-1&&t.push(se.a.clickable),this.props.headerClass&&t.push(ie.a[this.props.headerClass]),this.props.headerIcon&&t.push(se.a.iconed),this.props.headerStyle===ne.BARBER&&t.push(se.a.barber);var n=[se.a.dialog],a=this.getButtons(),r=a.leftButtons,i=a.rightButtons;return this.props.className&&n.push(this.props.className),b.createElement("div",{className:n.join(" ")},(this.props.tabs||[]).length>0?b.createElement("div",{className:se.a.tabs},(this.props.tabs||[]).map(function(t,n){return b.createElement("div",{key:"tab_"+t.name,className:se.a.tab+" "+(n===e.state.activeTab?se.a.active:""),onClick:function(t){t.stopPropagation(),e.setState({activeTab:n})}},t.name," ",t.icon?b.createElement("span",{className:se.a.tab_icon+" "+t.icon}):null,t.checked?b.createElement("span",{className:se.a.tab_icon+" fe-check"}):null)})):null,b.createElement("div",{onClick:function(){e.setState({activeTab:-1})},className:t.join(" ")},this.state.activeTab>-1?b.createElement("div",{className:se.a.header_overlay}):null,V(void 0!==this.props.headerIcon)(b.createElement("span",{className:"".concat(se.a.header_icon," ").concat(this.props.headerIcon)})),b.createElement("div",{className:se.a.title_container},b.createElement("div",{className:se.a.title},this.props.title),b.createElement("div",{className:se.a.subtitle},this.props.subtitle))),b.createElement("div",{className:this.props.noPadding?"":se.a.content},this.state.activeTab>-1?this.props.tabs[this.state.activeTab].body:this.props.children),b.createElement("div",{className:se.a.footer},b.createElement("div",{className:se.a.buttons},V(r.length>0)(b.createElement("div",{className:se.a.left_buttons},r)),V(null!=this.props.gutter)(b.createElement("div",{className:se.a.gutter},this.props.gutter)),b.createElement("div",{className:se.a.right_buttons},i))))}}]),t}(b.Component),ue=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).ele=void 0,n.state={top:0,fixed:!1},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleScroll",value:function(){var e=window.scrollY>this.state.top;this.setState({fixed:e})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll)}},{key:"componentDidMount",value:function(){var e=this.ele.getBoundingClientRect().top+window.scrollY,t=window.scrollY>e;this.setState({top:e,fixed:t}),window.addEventListener("scroll",this.handleScroll)}},{key:"render",value:function(){var e=this,t={position:"absolute"};return this.state.fixed&&(t={position:"fixed",top:0}),b.createElement("div",{ref:function(t){e.ele=t},style:t},this.props.children)}}]),t}(b.PureComponent),de=n(18);!function(e){e.UPDATE_EDITOR_STATE="UPDATE_EDITOR_STATE",e.UPDATE_NODE_EDITOR_SETTINGS="UPDATE_NODE_EDITOR_SETTINGS",e.UPDATE_TRANSLATING="UPDATE_TRANSLATING",e.UPDATE_BASE_LANGUAGE="UPDATE_BASE_LANGUAGE",e.UPDATE_LANGUAGES="UPDATE_LANGUAGES",e.UPDATE_LANGUAGE="UPDATE_LANGUAGE",e.UPDATE_FETCHING_FLOW="FETCHING_FLOW",e.UPDATE_DEFINITION="UPDATE_DEFINITION",e.UPDATE_NODE_DRAGGING="UPDATE_NODE_DRAGGING",e.UPDATE_FLOWS="UPDATE_FLOWS",e.UPDATE_DEPENDENCIES="UPDATE_DEPENDENCIES",e.UPDATE_PENDING_CONNECTIONS="UPDATE_PENDING_CONNECTIONS",e.REMOVE_PENDING_CONNECTION="REMOVE_PENDING_CONNECTION",e.UPDATE_COMPONENTS="UPDATE_COMPONENTS",e.UPDATE_CONTACT_FIELDS="UPDATE_CONTACT_FIELDS",e.UPDATE_GROUPS="UPDATE_GROUPS",e.UPDATE_RESULT_MAP="UPDATE_RESULT_MAP",e.UPDATE_ASSET_MAP="UPDATE_ASSET_MAP",e.UPDATE_NODES="UPDATE_NODES",e.UPDATE_EXITS="UPDATE_EXITS",e.UPDATE_NODE_EDITOR_OPEN="UPDATE_NODE_EDITOR_OPEN",e.UPDATE_CREATE_NODE_POSITION="UPDATE_CREATE_NODE_POSITION",e.UPDATE_DRAG_GROUP="UPDATE_DRAG_GROUP",e.UPDATE_TYPE_CONFIG="UPDATE_TYPE_CONFIG",e.UPDATE_USER_ADDING_ACTION="UPDATE_USER_ADDING_ACTION",e.INCREMENT_SUGGESTED_RESULT_NAME_COUNT="INCREMENT_SUGGESTED_RESULT_NAME_COUNT"}(le||(le={}));var pe,he=le;!function(e){e.Channel="channel",e.Classifier="classifier",e.Contact="contact",e.ContactProperty="property",e.Currency="currency",e.Environment="environment",e.Expression="expression",e.Field="field",e.Flow="flow",e.Global="global",e.Group="group",e.Label="label",e.Language="language",e.Remove="remove",e.Resthook="resthook",e.Result="result",e.Revision="revision",e.Scheme="scheme",e.Template="template",e.URN="urn"}(pe||(pe={}));var me,fe,ve,ge,_e={id:pe.Remove,name:"Remove Value",type:pe.Remove},ye={id:"base",name:"Default",type:pe.Language},be={definition:null,dependencies:null,baseLanguage:null,contactFields:{},nodes:{},assetStore:{}},Oe=function(e){return{type:he.UPDATE_DEFINITION,payload:{definition:e}}},ke=function(e){return{type:he.UPDATE_NODES,payload:{nodes:e}}},Ee=function(e){return{type:he.UPDATE_ASSET_MAP,payload:{assets:e}}},Ce=Object(de.combineReducers)({definition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.definition,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_DEFINITION:return t.payload.definition;default:return e}},nodes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.nodes,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_NODES:return t.payload.nodes;default:return e}},dependencies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.dependencies,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_DEPENDENCIES:return t.payload.dependencies;default:return e}},assetStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.assetStore,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_ASSET_MAP:return t.payload.assets;default:return e}},baseLanguage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.baseLanguage,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_BASE_LANGUAGE:return t.payload.baseLanguage;default:return e}},contactFields:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.contactFields,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_CONTACT_FIELDS:return t.payload.contactFields;default:return e}}}),we=n(54),Se=function(e,t){return e.originalAction&&e.originalAction.type===t?e.originalAction.uuid:X()},je=function(e){var t=(e.groups||[]).map(function(e){return{id:e.uuid,name:e.name,type:pe.Group}});return t=(t=t.concat((e.contacts||[]).map(function(e){return{id:e.uuid,name:e.name,type:pe.Contact}}))).concat((e.legacy_vars||[]).map(function(e){return{id:e,name:e,type:pe.Expression}}))},Ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2?arguments[2]:void 0;return e.reduce(function(e,a,r){return r<=t-1?e.push(xe(a,n)):r>t-1&&e.length===t&&e.push(b.createElement("div",{key:"ellipses"},"...")),e},[])},xe=function(e,t){switch(e.type){case pe.Group:return b.createElement("div",{className:we.node_asset,key:e.id},b.createElement("span",{className:"".concat(we.node_group," fe-group")}),e.name);case pe.Label:return b.createElement("div",{className:we.node_asset,key:e.id},b.createElement("span",{className:"".concat(we.node_label," fe-label")}),e.name);case pe.Flow:return b.createElement("div",{className:we.node_asset,key:e.id},b.createElement("span",{className:"".concat(we.node_label," fe-split")}),b.createElement("a",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},onMouseUp:function(e){e.preventDefault(),e.stopPropagation()},href:"".concat(t.editor,"/").concat(e.id),rel:"noopener noreferrer",target:"_blank"},e.name))}return b.createElement("div",{className:we.node_asset,key:e.id},e.name)},Pe=function(e){return(e.validationFailures||[]).concat(e.persistantFailures||[])},De=function(e){return Pe(e).length>0},Re=function(e){return e.filter(function(e){return e.type===pe.Expression}).map(function(e){return e.id})},Te=function(e,t){return e.filter(function(e){return e.type===t}).map(function(e){return{uuid:e.id,name:e.name}})},Ae={name:F(o.Name),id:o.Name,type:pe.ContactProperty},Ue={name:F(o.Channel),id:o.Channel,type:pe.ContactProperty},Fe={name:F(o.Language),id:o.Language,type:pe.ContactProperty};!function(e){e.MESSAGE="message",e.VOICE="voice",e.SURVEY="message_offline",e.NONE="-"}(me||(me={})),function(e){e.execute_actions="execute_actions",e.add_contact_urn="add_contact_urn",e.add_contact_groups="add_contact_groups",e.add_input_labels="add_input_labels",e.remove_contact_groups="remove_contact_groups",e.set_contact_channel="set_contact_channel",e.set_contact_field="set_contact_field",e.set_contact_name="set_contact_name",e.set_contact_language="set_contact_language",e.set_run_result="set_run_result",e.call_classifier="call_classifier",e.call_resthook="call_resthook",e.call_webhook="call_webhook",e.send_msg="send_msg",e.send_email="send_email",e.send_broadcast="send_broadcast",e.enter_flow="enter_flow",e.start_session="start_session",e.transfer_airtime="transfer_airtime",e.split_by_airtime="split_by_airtime",e.split_by_expression="split_by_expression",e.split_by_contact_field="split_by_contact_field",e.split_by_run_result="split_by_run_result",e.split_by_run_result_delimited="split_by_run_result_delimited",e.split_by_groups="split_by_groups",e.split_by_intent="split_by_intent",e.split_by_random="split_by_random",e.split_by_resthook="split_by_resthook",e.split_by_subflow="split_by_subflow",e.split_by_webhook="split_by_webhook",e.wait_for_response="wait_for_response",e.wait_for_menu="wait_for_menu",e.wait_for_digits="wait_for_digits",e.wait_for_audio="wait_for_audio",e.wait_for_video="wait_for_video",e.wait_for_location="wait_for_location",e.wait_for_image="wait_for_image",e.missing="missing",e.say_msg="say_msg",e.play_audio="play_audio"}(fe||(fe={})),function(e){e.has_any_word="has_any_word",e.has_all_words="has_all_words",e.has_phrase="has_phrase",e.has_only_phrase="has_only_phrase",e.has_beginning="has_beginning",e.has_text="has_text",e.has_date="has_date",e.has_date_lt="has_date_lt",e.has_date_eq="has_date_eq",e.has_date_gt="has_date_gt",e.has_time="has_time",e.has_number="has_number",e.has_number_between="has_number_between",e.has_number_lt="has_number_lt",e.has_number_lte="has_number_lte",e.has_number_eq="has_number_eq",e.has_number_gte="has_number_gte",e.has_number_gt="has_number_gt",e.has_run_status="has_run_status",e.has_only_text="has_only_text",e.has_group="has_group",e.has_phone="has_phone",e.has_email="has_email",e.has_value="has_value",e.has_district="has_district",e.has_state="has_state",e.has_ward="has_ward",e.has_pattern="has_pattern",e.has_error="has_error",e.has_intent="has_intent",e.has_top_intent="has_top_intent",e.has_category="has_category"}(ve||(ve={})),function(e){e.HAS_RESTHOOK="resthook",e.HAS_WHATSAPP="whatsapp",e.HAS_AIRTIME="airtime",e.HAS_CLASSIFIER="classifier"}(ge||(ge={}));var Ie=[me.NONE],Me=[me.VOICE],Le=[me.SURVEY],ze=[me.MESSAGE,me.SURVEY],Be=[me.MESSAGE,me.VOICE],Ve=function(){return null};Ve.isRequired=function(){return null};var qe="ConfigProvider expects only one child component.",He="ConfigProvider expects a valid React element: https://reactjs.org/docs/react-api.html#isvalidelement",Ke=function(e){function t(e){var n;if(Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),b.Children.count(e.children)>1)throw new Error(qe);if(!b.isValidElement(e.children))throw new Error(He);return n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getChildContext",value:function(){return{config:this.props.config}}},{key:"render",value:function(){return b.Children.only(this.props.children)}}]),t}(b.Component);Ke.childContextTypes={config:Ve,assetService:Ve};var Ge=function(e,t){var n=e.labels;return b.createElement(b.Fragment,null,Ne(n.map(function(e){return{id:e.uuid,name:e.name,type:pe.Label}}),3,t.config.endpoints))};Ge.contextTypes={config:Ve};var We=Ge,Ye=function(e,t){return e.type!==t.type?t.type.localeCompare(e.type):e.name.localeCompare(t.name)},Qe=n(37),Xe=n.n(Qe),Ze=n(43),$e=n.n(Ze),Je=Xe.a.bind($e.a),et=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(n),{include:[/^get/,/^has/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getName",value:function(){return V(this.props.showLabel&&void 0!==this.props.name&&null!==this.props.name&&this.props.name.length>0)(b.createElement("div",{className:$e.a.label},this.props.name))}},{key:"getHelpText",value:function(){return V(null!=this.props.helpText)(b.createElement("div",{className:$e.a.help_text},this.props.helpText," "))}},{key:"hasErrors",value:function(){return this.getMergedErrors().length>0}},{key:"getMergedErrors",value:function(){return this.props.entry?(this.props.entry.validationFailures||[]).concat(this.props.entry.persistantFailures||[]):[]}},{key:"getErrors",value:function(){var e=this;if(this.hasErrors()&&!this.props.hideError){var t=this.getMergedErrors().map(function(t,n){var a,r=Je((a={},Object(_.a)(a,$e.a.error,!0),Object(_.a)(a,$e.a.send_msg_error,!0===e.props.sendMsgError),a));return b.createElement("div",{key:n,className:r},b.createElement("div",{className:$e.a.arrow_up}),b.createElement("div",null,t.message))});return b.createElement("div",{className:$e.a.error_list},t)}return null}},{key:"render",value:function(){var e,t=this.getName(),n=this.getHelpText(),a=this.getErrors(),r=Je((e={},Object(_.a)(e,$e.a.ele,!0),Object(_.a)(e,$e.a.border,this.props.border),Object(_.a)(e,$e.a.invalid,this.hasErrors()),Object(_.a)(e,this.props.__className,void 0!==this.props.__className),e));return b.createElement("div",{className:r},t,this.props.children,n,a)}}]),t}(b.PureComponent),tt=n(60),nt=n.n(tt),at=n(79),rt=n(31),it=n.n(rt),ot={ARS:{id:"ARS",name:"Argentine Peso",type:pe.Currency},AUD:{id:"AUD",name:"Australian Dollar",type:pe.Currency},BIF:{id:"BIF",name:"Burundi Franc",type:pe.Currency},BRL:{id:"BRL",name:"Brazilian Real",type:pe.Currency},CAD:{id:"CAD",name:"Canadian Dollar",type:pe.Currency},CDF:{id:"CDF",name:"Congolese Franc",type:pe.Currency},CLP:{id:"CLP",name:"Chilean Peso",type:pe.Currency},COP:{id:"COP",name:"Colombian Peso",type:pe.Currency},DJF:{id:"DJF",name:"Djibouti Franc",type:pe.Currency},DOP:{id:"DOP",name:"Dominican Peso",type:pe.Currency},DZD:{id:"DZD",name:"Algerian Dinar",type:pe.Currency},EUR:{id:"EUR",name:"Euro",type:pe.Currency},GBP:{id:"GBP",name:"Pound Sterling",type:pe.Currency},GHS:{id:"GHS",name:"Ghana Cedi",type:pe.Currency},GNF:{id:"GNF",name:"Guinean Franc",type:pe.Currency},KES:{id:"KES",name:"Kenyan Shilling",type:pe.Currency},LBP:{id:"LBP",name:"Lebanese Pound",type:pe.Currency},LKR:{id:"LKR",name:"Sri Lanka Rupee",type:pe.Currency},LRD:{id:"LRD",name:"Liberian Dollar",type:pe.Currency},MWK:{id:"MWK",name:"Malawi Kwacha",type:pe.Currency},MXN:{id:"MXN",name:"Mexican Peso",type:pe.Currency},NAD:{id:"NAD",name:"Namibia Dollar",type:pe.Currency},NPR:{id:"NPR",name:"Nepalese Rupee",type:pe.Currency},NZD:{id:"NZD",name:"New Zealand Dollar",type:pe.Currency},PHP:{id:"PHP",name:"Philippine Piso",type:pe.Currency},PKR:{id:"PKR",name:"Pakistan Rupee",type:pe.Currency},RUB:{id:"RUB",name:"Russian Ruble",type:pe.Currency},RWF:{id:"RWF",name:"Rwanda Franc",type:pe.Currency},SDG:{id:"SDG",name:"Sudanese Pound",type:pe.Currency},SGD:{id:"SGD",name:"Singapore Dollar",type:pe.Currency},SLL:{id:"SLL",name:"Leone",type:pe.Currency},SOS:{id:"SOS",name:"Somali Shilling",type:pe.Currency},SRD:{id:"SRD",name:"Surinam Dollar",type:pe.Currency},SVC:{id:"SVC",name:"El Salvador Colon",type:pe.Currency},TND:{id:"TND",name:"Tunisian Dinar",type:pe.Currency},TRY:{id:"TRY",name:"Turkish Lira",type:pe.Currency},TZS:{id:"TZS",name:"Tanzanian Shilling",type:pe.Currency},UGX:{id:"UGX",name:"Uganda Shilling",type:pe.Currency},USD:{id:"USD",name:"US Dollar",type:pe.Currency},UYU:{id:"UYU",name:"Peso Uruguayo",type:pe.Currency},UZS:{id:"UZS",name:"Uzbekistan Sum",type:pe.Currency},VEF:{id:"VEF",name:"Bol\xedvar",type:pe.Currency},XCD:{id:"XCD",name:"East Caribbean Dollar",type:pe.Currency},YER:{id:"YER",name:"Yemeni Rial",type:pe.Currency},ZAR:{id:"ZAR",name:"Rand",type:pe.Currency},ZMW:{id:"ZMW",name:"Zambian Kwacha",type:pe.Currency},ZWL:{id:"ZWL",name:"Zimbabwe Dollar",type:pe.Currency}};it.a.defaults.headers.post["Content-Type"]="application/javascript",it.a.defaults.responseType="json";var st=function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=document.cookie.split(";")[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,s=o.indexOf("="),l=o.substr(0,s),c=o.substr(s+1);if(l=l.trim(),c=c.trim(),l===e)return c}}catch(u){n=!0,a=u}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}return null},lt=function(e,t){return new Promise(function(n,a){ut(e.endpoint,e.type,e.id).then(function(e){n(e.find(function(e){return e.id===t}))})})},ct=function(e,t,n){return new Promise(function(a,r){it.a.get(e).then(function(e){var r=e.data.results.map(function(e,a){var r=dt(e,t,n);return r.order=a,r});a({assets:r,next:e.data.next})}).catch(function(e){return r(e)})})},ut=function(){var e=Object(at.a)(nt.a.mark(function e(t,n,a){var r,i,o;return nt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",new Promise(function(e,t){return e([])}));case 2:r=[],i=t;case 4:if(!i){e.next=12;break}return e.next=7,ct(i,n,a);case 7:o=e.sent,r=r.concat(o.assets),i=o.next,e.next=4;break;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),dt=function(e,t,n){var a=n||"uuid",r=t;if(t===pe.Flow&&e.type)switch(e.type){case"message":e.type=me.MESSAGE;break;case"voice":e.type=me.VOICE;break;case"survey":e.type=me.SURVEY}t!==pe.Flow&&e.type&&(r=e.type);var i={name:e.name||e.text||e.label||e[a],id:e[a],type:r};return delete e[a],delete e.name,delete e.text,i.content=e,i},pt=function(e,t,n){if(n&&n(t))return!1;var a=e.toLowerCase();return!(t.type!==pe.Currency&&t.type!==pe.Language||!t.id.toLowerCase().includes(a))||t.name.toLowerCase().includes(a)},ht=function(e,t,n,a){var r=e.toLowerCase(),i=Object.keys(t).map(function(e){return t[e]}).filter(function(e){return pt(r,e,a)});return i=i.concat(n||[]).filter(function(e){return pt(r,e,a)})},mt=function(e){return new Promise(function(t,n){var a={channels:{endpoint:_t(e.channels),type:pe.Channel,items:{}},classifiers:{endpoint:_t(e.classifiers),type:pe.Classifier,items:{}},languages:{endpoint:_t(e.languages),type:pe.Language,items:{},id:"iso"},flows:{endpoint:_t(e.flows),type:pe.Flow,items:{}},fields:{endpoint:_t(e.fields),type:pe.Field,id:"key",items:{}},globals:{endpoint:_t(e.globals),type:pe.Global,id:"key",items:{}},groups:{endpoint:_t(e.groups),type:pe.Group,items:{}},revisions:{endpoint:_t(e.revisions),type:pe.Revision,id:"id",items:{}},labels:{endpoint:_t(e.labels),type:pe.Label,items:{}},results:{type:pe.Result,items:{}},recipients:{endpoint:_t(e.recipients),type:pe.Contact||pe.Group||pe.URN,items:{},id:"id"},resthooks:{endpoint:_t(e.resthooks),type:pe.Resthook,id:"resthook",items:{}},templates:{endpoint:_t(e.templates),type:pe.Template,items:{}},currencies:{type:pe.Currency,id:"id",items:ot,prefetched:!0}},r=[];["languages","fields","groups","labels","globals"].forEach(function(e){var t=a[e];r.push(ut(t.endpoint,t.type,t.id||"uuid").then(function(e){t.items=Pc(e),t.prefetched=!0}))}),Promise.all(r).then(function(e){t(a)})})},ft=function(e){return new Promise(function(t,n){it.a.get(e).then(function(e){t(e.data)}).catch(function(e){return n(e)})})},vt=function(e){return new Promise(function(t,n){it.a.get(e).then(function(e){t(e.data)})})},gt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(n,a){Object(at.a)(nt.a.mark(function r(){var i,o,s;return nt.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=t){r.next=12;break}return r.prev=2,r.next=5,it.a.get("".concat(e.endpoint));case 5:(o=r.sent).data.results.length>0&&(i=o.data.results[0].id),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(2),a(new Error("Couldn't reach revisions endpoint"));case 12:i?(s="".concat(e.endpoint).concat(i),it.a.get(s).then(function(e){var t=e.data;return n(t)}).catch(function(e){return a(e)})):a(new Error("No revision found for flow"));case 13:case"end":return r.stop()}},r,null,[[2,9]])}))()})},_t=function(e){var t=e;return t.endsWith("/")||-1!==t.indexOf("?")||-1!==t.indexOf("groups")||(t+="/"),t.startsWith("http://")||t.startsWith("https://")?t:"".concat(function(){var e=window.location;return e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")}()+t)};function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ot={placeholder:function(e,t){return bt({},e,{color:"#ddd",marginLeft:"3px"})},singleValue:function(e,t){return bt({},e,{marginLeft:"3px"})},multiValue:function(e,t){return bt({},e,{marginLeft:"0px"})},input:function(e,t){return bt({},e,{marginLeft:"0px",caretColor:"#999",marginBottom:"0px",boxShadow:"none",border:"none"})},control:function(e,t){return bt({},e,{borderColor:"#ccc",boxShadow:"none",transition:"all 0.3s ease-in-out","&:hover":{borderColor:"#ccc"}})}},kt={control:function(e,t){return bt({},e,{borderColor:"#ccc",boxShadow:"none",borderBottom:"none",borderBottomRightRadius:"0px",borderBottomLeftRadius:"0px","&:hover":{borderColor:"#ccc"}})}},Et=function(e){return{control:function(t){return bt({},t,{},e,{borderColor:"tomato",boxShadow:"0 0 0 3px rgba(255,196,186,0.5) !important;","&:hover":{borderColor:"tomato"}})}}},Ct={control:function(e){return bt({},e,{borderColor:"#ccc",boxShadow:"none","&:hover":{borderColor:"#ccc"},maxHeight:"28px",minHeight:"28px",fontSize:"12px",lineHeight:"12px"})},menuList:function(e){return bt({},e,{maxHeight:200})},option:function(e){return bt({},e,{fontSize:12})},singleValue:function(e){return bt({},e,{maxHeight:28,lineHeight:"13px"})},indicatorsContainer:function(e){return bt({},e,{height:28,maxHeight:28})},valueContainer:function(e){return bt({},e,{height:28,maxHeight:28})},input:function(e){return bt({},e,{marginLeft:"-2px",marginTop:"-10px",caretColor:"#999",boxShadow:"none",border:"none",maxHeight:"20px",minHeight:"20px",lineHeight:"12px"})}},wt={control:function(e,t){return bt({},e,{borderColor:"#ccc",boxShadow:"none",transition:"all 0.3s ease-in-out","&:hover":{borderColor:"#ccc"}})},input:function(e,t){return bt({},e,{marginLeft:"0px",caretColor:"#999",marginBottom:"0px",boxShadow:"none",border:"none"})},multiValue:function(e){return bt({},e,{maxHeight:24,minHeight:24,lineHeight:"17px",backgroundColor:"hsl(0, 0%, 94%)",border:"1px solid hsl(0, 0%, 85%)"})}},St=n(73),jt=n.n(St),Nt=function(e,t){return e.filter(function(e){return!!e.signature&&0===e.signature.indexOf(t)})},xt=function(e,t){for(var n=(t||"").split("."),a=e.schema.root,r="",i="";n.length>0;){if(i=n.shift())if("break"===function(){var t=a.find(function(e){return e.key===i});if(!t)return a=a.filter(function(e){return e.key.startsWith(i.toLowerCase())}),"break";var n=e.schema.types.find(function(e){return e.name===t.type});if(n&&n.properties)a=n.properties,r+=i+".";else{if(!n||!n.property_template)return a=a.filter(function(e){return e.key.startsWith(i.toLowerCase())}),"break";r+=i+".";var o=n.property_template,s=e.assetStore[n.name];a=s?Object.keys(s.items).map(function(e){return{key:o.key.replace("{key}",e),help:o.help.replace("{key}",e),type:o.type}}):[]}}())break}return a.map(function(e){return{name:"__default__"===e.key?r.substr(0,r.length-1):r+e.key,summary:e.help}})},Pt=n(125),Dt=n(19),Rt=n(156),Tt={defaults:{translation:n(157)},en:{translation:n(158)},es:{translation:n(159)}};Pt.a.use(Rt.a).use(Dt.b).init({resources:Tt,fallbackLng:["en","defaults"],interpolation:{prefix:"[[",suffix:"]]"}});var At=Pt.a,Ut=n(20),Ft=n(91),It=n(161);function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Lt=function(e){var t=e.data,n="";return t.type===pe.Currency&&(n=" (".concat(t.id,")")),e.isDisabled?null:b.createElement("div",Object.assign({ref:e.innerRef},e.innerProps),b.createElement(Ut.z.Option,e,"",function(e){switch(e.type){case pe.Group:return b.createElement("span",{className:"fe-group"});case pe.Label:return b.createElement("span",{className:"fe-label"});case pe.Flow:return b.createElement("span",{className:"fe-split"});case pe.Scheme:return b.createElement("span",{className:"fe-connection"});case pe.Template:return e.content.translations.find(function(e){return"pending"===e.status})?b.createElement("span",{className:"fe-hourglass"}):b.createElement("span",{className:"fe-check"});case pe.Remove:return b.createElement(b.Fragment,null,b.createElement("span",{className:"fe-trash"}),"\xa0");default:return null}}(t)," ",t.name,n))},zt=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).lastCreation=0,Object(y.react)(Object(v.a)(n),{include:[/^is/,/^handle/,/^get/]});var a=[];return e.assets.endpoint||(a=ht("",e.assets.items)),n.state={menuOpen:!1,defaultOptions:a,entry:n.props.entry,isLoading:!1},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleChanged",value:function(e){this.setState({message:null}),Array.isArray(e)||!e?this.props.onChange(e):this.props.onChange&&this.props.onChange([e])}},{key:"handleLoadOptions",value:function(e,t){var n=this,a=this.props.additionalOptions||[];if(this.props.completion&&e.startsWith("@")){var r=xt(this.props.completion,e.substr(1));t(r.map(function(e){return{id:"@"+e.name,name:"@"+e.name,type:pe.Expression}}))}else{var i=ht(e,this.props.assets.items,a,this.props.shouldExclude),o=this.props.assets;if(o.prefetched)this.props.onFilter&&(i=i.filter(this.props.onFilter)),t(i.sort(this.props.sortFunction||Ye));else{var s=o.endpoint;s&&e&&(s+=s.indexOf("?")<0?"?":"&",s+="search="+encodeURIComponent(e)),ut(s,o.type,o.id||"uuid").then(function(a){var r=a.filter(function(t){return pt(e,t,n.props.shouldExclude)}),o=n.props.valueClearable?[_e]:[],s=function(e,t){var n={};return e.filter(function(e){var a=e[t];return!n.hasOwnProperty(a)&&(n[a]=!0)})}(i.concat(r).concat(o),"id");if(n.props.entry.value&&!n.props.entry.value.name){var l=s.find(function(e){return e.id===n.props.entry.value.id});l&&n.props.onChange([l])}n.props.onFilter&&(s=s.filter(n.props.onFilter)),t(s.sort(n.props.sortFunction||Ye))})}}}},{key:"handleCheckValid",value:function(e,t,n){return!!this.props.createAssetFromInput&&(e.length>0&&0===ht(e,this.props.assets.items,this.props.additionalOptions,this.props.shouldExclude).filter(function(t){return t.name.toLowerCase()===e.toLowerCase()}).length)}},{key:"handleCreatePrompt",value:function(e){return(this.props.createPrefix||"New ".concat(this.props.name,": "))+e}},{key:"handleGetNewOptionData",value:function(e,t){return{id:"_",name:t,type:null}}},{key:"handleLoadingComplete",value:function(){this.setState({isLoading:!1})}},{key:"handleMenuOpen",value:function(){this.setState({menuOpen:!0,message:null})}},{key:"handleMenuClose",value:function(){this.setState({menuOpen:!1})}},{key:"handleClearMessage",value:function(){this.state.message&&this.setState({message:null})}},{key:"handleCreateOption",value:function(e){var t=this,n=(new Date).getTime();if(!(n-this.lastCreation<1e3)){this.lastCreation=n;var a=this.props.createAssetFromInput(e);this.props.assets.endpoint?(this.setState({isLoading:!0,message:null}),function(e,t){var n=st("csrftoken"),a=n?{"X-CSRFToken":n}:{};return new Promise(function(n,r){it.a.post(e.endpoint,t,{headers:a}).then(function(t){n(dt(t.data,e.type,e.id))}).catch(function(e){return r(e)})})}(this.props.assets,a).then(function(e){t.setState({isLoading:!1}),t.props.onAssetCreated(e)}).catch(function(n){var a="";n.response&&n.response.data&&n.response.data.non_field_errors&&(a=" "+n.response.data.non_field_errors.join(", ")),t.setState({message:"Couldn't create new ".concat(t.props.assets.type,' "').concat(e,'".').concat(a),isLoading:!1})})):this.props.onChange([a])}}},{key:"getStyle",value:function(){if(this.state.message)return kt;var e=this.props.styles||Ot;if(De(this.props.entry)){var t=Et(e.control({},{}));e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{},t)}return e}},{key:"getOptionValue",value:function(e){return e.value||e.id}},{key:"getOptionLabel",value:function(e){return e.label||e.name}},{key:"render",value:function(){var e=this,t=At.t("asset_selector.placeholder","Select existing [[name]] or enter a new one",{name:this.props.name.toLocaleLowerCase(),count:this.props.multi?1e3:1}),n={className:"react-select "+jt.a.selection,captureMenuScroll:!1,value:this.state.entry.value,components:{Option:Lt},styles:this.getStyle(),onChange:this.handleChanged,onMenuOpen:this.handleMenuOpen,onMenuClose:this.handleMenuClose,onBlur:this.handleClearMessage,menuShouldBlockScroll:!0,isMulti:this.props.multi,isDisabled:this.state.isLoading,isLoading:this.state.isLoading,isClearable:this.props.formClearable,isSearchable:this.props.searchable,getOptionValue:this.getOptionValue,getOptionLabel:this.getOptionLabel,placeholder:this.props.placeholder||t};if(this.props.createAssetFromInput){var a=ht("",this.props.assets.items,this.props.additionalOptions,this.props.shouldExclude);return b.createElement(et,{name:this.props.name,entry:this.props.entry,showLabel:this.props.showLabel,helpText:this.props.helpText,hideError:this.state.menuOpen,__className:jt.a.ele},b.createElement(Ft.a,Object.assign({},n,{options:a.sort(this.props.sortFunction||Ye),isValidNewOption:this.handleCheckValid,formatCreateLabel:this.handleCreatePrompt,getNewOptionData:this.handleGetNewOptionData,onCreateOption:this.handleCreateOption})),this.state.message?b.createElement("div",{className:jt.a.message},this.state.message):null)}var r=void 0!==this.props.assets.endpoint;return r||(r=this.state.defaultOptions,this.props.shouldExclude&&(r=ht("",this.props.assets.items,this.props.additionalOptions,this.props.shouldExclude))),b.createElement(et,{name:this.props.name,entry:this.props.entry,showLabel:this.props.showLabel,helpText:this.props.helpText,hideError:this.state.menuOpen,__className:jt.a.ele},b.createElement(It.a,Object.assign({},n,{defaultOptions:r,cacheOptions:!0,loadOptions:this.handleLoadOptions,noOptionsMessage:function(t){return e.props.noOptionsMessage||"No ".concat(e.props.name," Found")}})),this.state.message?b.createElement("div",{className:jt.a.message},this.state.message):null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.entry;if(t.defaultOptions&&n.value&&!n.value.name){var a=t.defaultOptions.find(function(e){return e.id===n.value.id});a&&(n={value:a})}return{entry:n}}}]),t}(b.Component),Bt=function(e,t){return e.filter(function(e){return!(e.filter&&!(t.filters||[]).find(function(t){return t===e.filter}))&&(void 0===e.visibility||e.visibility.findIndex(function(e){return e===t.flowType})>-1)})},Vt=n(57),qt=n(162),Ht=n.n(qt),Kt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).typeConfigs=void 0,n.state={config:n.props.initialType},n.handleChangeType=n.handleChangeType.bind(Object(v.a)(n)),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleChangeType",value:function(e){var t=this;this.setState({config:e},function(){return t.props.onChange(e)})}},{key:"getTypeConfigs",value:function(){var e,t;return void 0===this.typeConfigs&&(this.typeConfigs=(e=El,t=this.context.config,Bt(e,t))),this.typeConfigs}},{key:"render",value:function(){return b.createElement("div",{className:"".concat(this.props.__className," ").concat(Ht.a.type_list)},b.createElement("p",null,At.t("forms.type_label","When a contact arrives at this point in your flow...")),b.createElement("div",null,b.createElement(Vt.a,{className:"react-select",styles:Ot,value:this.state.config,onChange:this.handleChangeType,isSearchable:!0,isClearable:!1,getOptionValue:function(e){return e.type},getOptionLabel:function(e){return e.description},options:this.getTypeConfigs()})))}}]),t}(b.PureComponent);Kt.contextTypes={config:Ve};var Gt,Wt=n(14),Yt=n.n(Wt),Qt=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=e||{},r=0,i=Object.keys(t);r<i.length;r++){var o=i[r],s=t[o];if(Array.isArray(s)){var l=!0,c=!1,u=void 0;try{for(var d,p=function(){var t=d.value,n=t.hasOwnProperty("value")&&"object"===typeof t.value;if(n&&t.value.uuid||t.uuid){var r=e[o].findIndex(function(e){return n?e.value.uuid===t.value.uuid:e.uuid===t.uuid});a=r>-1?Yt()(a,Object(_.a)({},o,{$merge:Object(_.a)({},r,t)})):Yt()(a,Object(_.a)({},o,{$push:[t]}))}},h=s[Symbol.iterator]();!(l=(d=h.next()).done);l=!0)p()}catch(q){c=!0,u=q}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}delete t[o]}}var m=!0,f=!1,v=void 0;try{for(var g,y=n.filter(function(e){return"object"===typeof e})[Symbol.iterator]();!(m=(g=y.next()).done);m=!0)for(var b=g.value,O=0,k=Object.keys(b);O<k.length;O++){var E=k[O],C=b[E];if(Array.isArray(C)){var w=!0,S=!1,j=void 0;try{for(var N,x=function(){var e=N.value,t=e.hasOwnProperty("value")&&"object"===typeof e.value;(t&&e.value.uuid||e.uuid)&&(a=Yt()(a,Object(_.a)({},E,function(n){return n.filter(function(n){return t?n.value.uuid!==e.value.uuid:n.uuid!==e.uuid})})))},P=C[Symbol.iterator]();!(w=(N=P.next()).done);w=!0)x()}catch(q){S=!0,j=q}finally{try{w||null==P.return||P.return()}finally{if(S)throw j}}}}}catch(q){f=!0,v=q}finally{try{m||null==y.return||y.return()}finally{if(f)throw v}}var D=n.filter(function(e){return"string"===typeof e});a=Yt()(a,{$merge:t,$unset:D});for(var R=!0,T=0,A=Object.keys(e);T<A.length;T++){var U=A[T],F=a[U];if(Array.isArray(F)){var I=!0,M=!1,L=void 0;try{for(var z,B=F[Symbol.iterator]();!(I=(z=B.next()).done);I=!0){var V=z.value;if(De(V)){R=!1;break}}}catch(q){M=!0,L=q}finally{try{I||null==B.return||B.return()}finally{if(M)throw L}}}else if(F&&"object"===typeof F&&De(F)){R=!1;break}}return Yt()(a,{$merge:{valid:R}})},Xt={typeConfig:null,userAddingAction:!1,settings:null},Zt=function(e){return{type:he.UPDATE_NODE_EDITOR_SETTINGS,payload:{settings:e}}},$t=function(e){return{type:he.UPDATE_USER_ADDING_ACTION,payload:{userAddingAction:e}}},Jt=Object(de.combineReducers)({typeConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt.typeConfig,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_TYPE_CONFIG:return t.payload.typeConfig;default:return e}},userAddingAction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt.userAddingAction,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_USER_ADDING_ACTION:return t.payload.userAddingAction;default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt.settings,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_NODE_EDITOR_SETTINGS:return t.payload.settings;default:return e}}}),en=n(163),tn=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?:u:\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),nn=function(e,t){return function(n,a){var r=function(e){var t=e;return"string"===typeof e?t+"":(e&&"object"===typeof e&&(t=e.name||void 0),t?t+"":null)}(a);return r&&!e.test(r)?{value:a,failures:[{message:"".concat(n," ").concat(t)}]}:{failures:[],value:a}}},an=function(e,t,n){var a=[],r=t;return n.forEach(function(n){var i=n(e,t);r=i.value,a=a.concat(i.failures)}),{value:r,validationFailures:a}},rn=function(e,t){if(t)return{value:t,failures:[{message:"".concat(e," is not finished")}]};if("string"===typeof t){if(0!==t.trim().length)return{value:t,failures:[{message:"".concat(e," is not finished")}]}}else if(Array.isArray(t)&&0!==t.length)return{value:t,failures:[{message:"".concat(e," is not finished")}]};return{failures:[],value:t}},on=function(e,t){if(!t)return{value:t,failures:[{message:"".concat(e," is required")}]};if("string"===typeof t){if(0===t.trim().length)return{value:t,failures:[{message:"".concat(e," is required")}]}}else if(Array.isArray(t)&&0===t.length)return{value:t,failures:[{message:"".concat(e," are required")}]};return{failures:[],value:t}},sn=function(e,t){if("string"===typeof t){var n=t;if(n.trim().startsWith("@"))return{failures:[],value:t};try{new RegExp(n)}catch(a){return{value:t,failures:[{message:"".concat(e," is not a valid regex")}]}}}return{failures:[],value:t}},ln=function(e,t){return function(n,a){return"string"===typeof a&&parseFloat(a)<=e?{value:a,failures:[{message:"".concat(n," must be a more than ").concat(t)}]}:{failures:[],value:a}}},cn=function(e){return function(t,n){return e?on(t,n):{failures:[],value:n}}},un=function(e,t){return"string"===typeof t&&t.trim().length>0&&!en.validateHeaderName(t)?{failures:[{message:"Invalid header name"}],value:t}:{failures:[],value:t}},dn=(Gt=10,function(e,t){return Array.isArray(t)&&t.length>Gt?{value:t,failures:[{message:"".concat(e," cannot have more than ").concat(Gt," entries")}]}:{failures:[],value:t}}),pn=nn(/^(?!\d)/,"can't start with a number"),hn=nn(tn,"is not a valid URL"),mn=nn(/^([-+]?((\.\d+)|(\d+)(\.\d+)?)$)/,"must be a number"),fn=nn(/^[a-z\d\-_\s]+$/i,"can only have letters and numbers"),vn=nn(/^@.*$|^([-+]?((\.\d+)|(\d+)(\.\d+)?)$)/,"must be a number"),gn=function(e){return e.originalAction&&e.originalAction.type===fe.add_input_labels?{labels:{value:e.originalAction.labels.map(function(e){return{id:e.uuid,name:e.name,type:pe.Label}})},valid:!0}:{labels:{value:[]},valid:!1}},_n=function(e,t){return e.filter(function(e){return e.type===t}).map(function(e){return{uuid:e.id,name:e.name}})},yn=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=gn(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleSave",value:function(){var e,t;if(this.handleLabelsChanged(this.state.labels.value,!0)){var n=(e=this.props.nodeSettings,t=this.state,{type:fe.add_input_labels,labels:_n(t.labels.value,pe.Label),uuid:Se(e,fe.add_input_labels)});this.props.updateAction(n),this.props.onClose(!1)}}},{key:"handleLabelsChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={labels:an("Labels",e,[cn(t)])},a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleCreateAssetFromInput",value:function(e){return{name:e}}},{key:"handleLabelCreated",value:function(e){this.props.addAsset("labels",e),this.handleLabelsChanged(this.state.labels.value.concat(e))}},{key:"render",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("p",{"data-spec":"label"},b.createElement(Dt.a,{i18nKey:"forms.add_labels.summary"},"Select the labels to apply to the incoming message.")),b.createElement(zt,{name:"Labels",placeholder:At.t("enter_to_create_label","Enter the name of an existing label or create a new one"),assets:this.props.assetStore.labels,entry:this.state.labels,searchable:!0,multi:!0,onChange:this.handleLabelsChanged,createPrefix:At.t("create_label","Create Label")+": ",createAssetFromInput:this.handleCreateAssetFromInput,onAssetCreated:this.handleLabelCreated}))}}]),t}(b.PureComponent);yn.contextTypes={assetService:Ve};var bn=function(e){return Ol.find(function(t){return t.scheme===e})},On=function(e){return kn(bn(e))},kn=function(e){return{value:e.scheme,label:e.name}},En=function(e){if(e.originalAction&&e.originalAction.type===fe.add_contact_urn){var t=e.originalAction,n=t.scheme,a=t.path;return{scheme:{value:On(n)},path:{value:a},valid:!0}}return{scheme:{value:On("tel")},path:{value:""},valid:!1}},Cn=function(e){var t=e.scheme,n=e.path,a=bn(t),r=a?a.name:t;return b.createElement(b.Fragment,null,At.t("add","Add")," ",r," ",n)};function wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Sn,jn=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getStyle",value:function(){var e=this.props.styles||Ot;if(De(this.props.entry)){var t=Et(e.control({},{}));e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wn(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{},t)}return e}},{key:"render",value:function(){return b.createElement(et,{name:this.props.name,entry:this.props.entry},b.createElement(Vt.a,{isDisabled:void 0===this.props.onChange,placeholder:this.props.placeholder,styles:this.getStyle(),name:this.props.name,value:this.props.entry.value,onChange:this.props.onChange,onMenuOpen:this.props.onMenuOpen,onMenuClose:this.props.onMenuClose,isSearchable:!1,isClearable:!1,options:this.props.options}))}}]),t}(b.Component),Nn=n(30),xn=n(110),Pn=n.n(xn),Dn=function(e){var t,n=e.unicodeChars,a=Object.keys(n);return V(a.length>0)(b.createElement("span",{"data-testid":"unicode-list-container"},(t=a.length," Note that your message may require more segments to send because it contains the following ".concat($(t,"character"),":")),b.createElement("div",{className:Pn.a.unicode_list,"data-testid":"unicode-list"},a.map(function(e,t){return b.createElement("span",{key:e,className:Pn.a.unicode_char},e)}))))},Rn=n(61),Tn=n.n(Rn),An=Xe.a.bind(Tn.a),Un=function(e){var t,n=e.count,a=e.parts,r=e.unicodeChars,i=Object.keys(r).length>0,o=An((t={},Object(_.a)(t,Tn.a.tooltip_text,!0),Object(_.a)(t,Tn.a.unicode,i),t));return O.a.createElement("div",{className:Tn.a.count},O.a.createElement("div",{className:Tn.a.tooltip},n,O.a.createElement("span",{className:Tn.a.divider},"/"),a,O.a.createElement("span",{className:o},"This message will be about ",O.a.createElement("b",null,n)," ",$(n,"character")," long. We estimate it will take ",O.a.createElement("b",null,a)," ",$(a,"message")," to send over SMS.",i&&O.a.createElement(Dn,{unicodeChars:r}),O.a.createElement("div",{className:Tn.a.fine_print},"Using variables may result in longer messages that require more messages to send over SMS."))))};!function(e){e.KEY_AT="@",e.KEY_SPACE=" ",e.KEY_ENTER="Enter",e.KEY_UP="ArrowUp",e.KEY_DOWN="ArrowDown",e.KEY_RIGHT="ArrowRight",e.KEY_LEFT="ArrowLeft",e.KEY_TAB="Tab",e.KEY_ESC="Escape",e.KEY_BACKSPACE="Backspace",e.KEY_N="n",e.KEY_P="p",e.KEY_F="f",e.KEY_B="b"}(Sn||(Sn={}));var Fn={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,"\n":10,"\f":12,"\r":13," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"&":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,":":58,";":59,"<":60,"=":61,">":62,"?":63,"@":64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,"[":91,"\\":92,"]":93,"^":94,_:95,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,"\xa1":161,"\xa3":163,"\xa4":164,"\xa5":165,"\xa7":167,"\xbf":191,"\xc4":196,"\xc5":197,"\xc6":198,"\xc7":199,"\xc9":201,"\xd1":209,"\xd6":214,"\xd8":216,"\xdc":220,"\xdf":223,"\xe0":224,"\xe4":228,"\xe5":229,"\xe6":230,"\xe8":232,"\xe9":233,"\xec":236,"\xf1":241,"\xf2":242,"\xf6":246,"\xf8":248,"\xf9":249,"\xfc":252,"\u0393":915,"\u0394":916,"\u0398":920,"\u039b":923,"\u039e":926,"\u03a0":928,"\u03a3":931,"\u03a6":934,"\u03a8":936,"\u03a9":937,"\u20ac":8364},In=function(e,t,n){var a=e.substring(1);if("("===a[0])return!0;var r=a.split(".")[0].toLowerCase();if(!n)return t.indexOf(r)>=0;var i,o=!0,s=!1,l=void 0;try{for(var c,u=t[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d=c.value;if(i=r,0===d.indexOf(i,0))return!0}}catch(p){s=!0,l=p}finally{try{o||null==u.return||u.return()}finally{if(s)throw l}}return!1},Mn=function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"_"===e},Ln=function(e){var t=0,n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){'"'===i.value&&t++}}catch(s){a=!0,r=s}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return t%2!==0},zn=function(){function e(t,n){Object(p.a)(this,e),this.expressionPrefix=void 0,this.allowedTopLevels=void 0,this.expressionPrefix=t,this.allowedTopLevels=n}return Object(h.a)(e,[{key:"expressionContext",value:function(e){var t=this.findExpressions(e);if(0===t.length)return null;var n=t[t.length-1];return n.end<e.length||n.closed?null:n.text.substring(1)}},{key:"autoCompleteContext",value:function(e){if(Ln(e))return null;for(var t=[],n="",a=!1,r=!1,i="",o=e.length-1;o>=0;o--){var s=e[o];if(" "===s&&(a=!0),","===s&&(a=!0,"("!==t[t.length-1]&&t.push("(")),")"!==s||r||(a=!0,t.push("("),t.push("(")),'"'===s&&(r=!r),a&&("("!==s||r||("("===t[t.length-1]&&t.pop(),0===t.length&&(a=!1))),"("===s&&""===n&&(i="#"),!(a||r||"("===s&&""===n)){if(!Mn(s)&&"."!==s)break;n=s+n}}return n.match(/[A-Za-z][\w]*(\.[\w]+)*/)?i+n:null}},{key:"functionContext",value:function(e){for(var t=Ln(e)?4:6,n="",a="("===e[-1]?0:1,r=e.length-1;r>=0;r--){var i=e[r];if("@"===i)return"";if(6===t)0!==a||!Mn(i)&&"."!==i?'"'===i?t=4:"("===i?a--:")"===i&&a++:(t=2,n=i+n);else if(2===t){if(!Mn(i)&&"."!==i)return n;n=i+n}else 4===t&&'"'===i&&(t=6)}return""}},{key:"getContactFields",value:function(e){var t={},n=/((parent|child\.)*contact\.)*fields\.([a-z0-9_]+)/g,a=this.findExpressions(e),r=!0,i=!1,o=void 0;try{for(var s,l=a[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)for(var c=s.value,u=void 0;u=n.exec(c.text);)t[u[3]]=!0}catch(d){i=!0,o=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return Object.keys(t)}},{key:"findExpressions",value:function(e){for(var t=[],n=0,a=null,r=0,i=0;i<e.length;i++){var o=e[i],s=i<e.length-1?e[i+1]:0,l=i<e.length-2?e[i+2]:0;if(0===n?o!==this.expressionPrefix||!Mn(s)&&"("!==s?o===this.expressionPrefix&&s===this.expressionPrefix&&(n=5):(n=1,a={start:i,end:null,text:o,closed:!1}):1===n?(Mn(o)?n=2:"("===o&&(n=3,r+=1),a.text+=o):2===n?a.text+=o:3===n?("("===o?r+=1:")"===o?r-=1:'"'===o&&(n=4),a.text+=o,0===r&&(a.end=i+1)):4===n?('"'===o&&(n=3),a.text+=o):5===n&&(n=0),2===n&&(!Mn(s)&&"."!==s||"."===s&&!Mn(l))&&(a.end=i+1),null!=a&&(null!=a.end||0===s)){var c=0===s;In(a.text,this.allowedTopLevels,c)&&(a.closed="("===a.text[1]&&0===r,a.end=i+1,t.push(a)),a=null,n=0}}return t}}]),e}(),Bn=n(164),Vn=function(e){var t,n={},a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;t=l,Fn.hasOwnProperty(t)||(n[l]=!0)}}catch(c){r=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return n},qn=function(e,t){var n=e;n.constructor===Array&&(n=n[0]),t&&(n=n.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[\u2013\u2014]/g,"-").replace(/\u2026/g,"...").replace(/\u2002/g," "));var a=Object(Bn.split)(n);return{value:n,parts:a.parts,characterCount:a.length,unicodeChars:Vn(n)}},Hn=n(27),Kn=n(112),Gn=n.n(Kn),Wn=n(28),Yn=n.n(Wn);function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Zn,$n=n(229);!function(e){e.SMS="SMS"}(Zn||(Zn={}));var Jn={caretCoordinates:{left:0,top:0},completionVisible:!1,selectedOptionIndex:0,matches:[],query:""},ea=Xe.a.bind(Xn({},Yn.a,{},$e.a)),ta=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).selectedEl=void 0,n.textEl=void 0,n.parser=void 0,n.nextCaret=-1,n.completion=void 0,n.completion={schema:n.props.completionSchema,assetStore:n.props.assetStore};var a="";return n.props.entry&&n.props.entry.value&&(a=n.props.entry.value),n.state=Xn({value:a},Jn,{},n.props.count&&n.props.count===Zn.SMS?qn(a):{}),n.parser=new zn("@",["contact","child","fields","globals","input","parent","results","run","trigger","urns","webhook"]),Object(y.react)(Object(v.a)(n),{include:[/^on/,/Ref$/,"setSelection","validate",/^has/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"selectedElRef",value:function(e){return this.selectedEl=e}},{key:"textElRef",value:function(e){return this.textEl=e}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;(e.entry.value!==this.props.entry.value||this.nextCaret>-1)&&this.setState({value:e.entry.value},function(){t.nextCaret>-1&&(t.textEl.selectionStart=t.nextCaret,t.textEl.selectionEnd=t.nextCaret,t.nextCaret=-1)})}},{key:"componentDidMount",value:function(){return this.checkForMissingFields(),this.props.focus&&this.focusInput()}},{key:"componentDidUpdate",value:function(e){this.selectedEl&&this.selectedEl.scrollIntoView&&this.selectedEl.scrollIntoView(!1)}},{key:"handleKeyDown",value:function(e){var t=this;if(this.props.autocomplete&&(e.key!==Sn.KEY_ENTER||!this.props.onEnter||!this.props.onEnter(e)))switch(e.key){case Sn.KEY_SPACE:e.ctrlKey&&this.reevaluate(e.currentTarget.value,e.currentTarget.selectionStart,!0);break;case Sn.KEY_P:e.ctrlKey&&this.state.completionVisible&&(this.setSelection(this.state.selectedOptionIndex-1),e.preventDefault());break;case Sn.KEY_UP:this.state.completionVisible&&(this.setSelection(this.state.selectedOptionIndex-1),e.preventDefault());break;case Sn.KEY_N:e.ctrlKey&&this.state.completionVisible&&(this.setSelection(this.state.selectedOptionIndex+1),e.preventDefault());break;case Sn.KEY_DOWN:return void(this.state.completionVisible&&(this.setSelection(this.state.selectedOptionIndex+1),e.preventDefault()));case Sn.KEY_AT:return void this.setState({completionVisible:!0,caretCoordinates:Gn()(this.textEl,this.textEl.selectionEnd)});case Sn.KEY_ESC:return void(this.state.completionVisible&&(this.setState({completionVisible:!1}),e.preventDefault(),e.stopPropagation()));case Sn.KEY_TAB:case Sn.KEY_ENTER:var n=e.currentTarget.selectionStart;if(this.state.completionVisible&&this.state.matches.length>0){var a=this.state.matches[this.state.selectedOptionIndex],r=this.state.value.substr(0,n-this.state.query.length);if(a.signature){var i=1;a.signature.indexOf("()")>-1&&i++,r+=a.signature.substring(0,a.signature.indexOf("(")+i)}else r+=a.name;var o=r.length,s=!0,l=!1,c=void 0;try{for(var u,d=this.state.value.substr(n)[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var p=u.value;if(!Mn(p)&&"."!==p)break;n++}}catch(g){l=!0,c=g}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}r+=this.state.value.substr(n);var h=null,m="",f=!1,v=[];return(e.key===Sn.KEY_TAB||a.signature)&&(m=a.name,v.push.apply(v,Object(Nn.a)(xt(this.completion,m)).concat(Object(Nn.a)(Nt(this.props.functions,m)))),f=v.length>0,a.signature&&-1===a.signature.indexOf("()")&&(h=a)),this.setState({fn:h,query:m,value:r,matches:v,completionVisible:f,selectedOptionIndex:0},function(){t.props.onChange&&t.props.onChange(t.state.value,t.props.name),t.nextCaret=o}),e.preventDefault(),void e.stopPropagation()}return void(this.props.onEnter&&(this.checkForMissingFields(),this.props.onEnter(e)));case Sn.KEY_BACKSPACE:return void this.executeQuery(e.currentTarget.value,e.currentTarget.selectionStart-1)}}},{key:"reevaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(this.state.completionVisible||n)&&this.setState(this.executeQuery(e,t))}},{key:"handleKeyUp",value:function(e){if(e.currentTarget){var t=e.currentTarget,n=t.value,a=t.selectionStart;switch(e.key){case Sn.KEY_P:case Sn.KEY_N:if(this.state.completionVisible&&e.ctrlKey)return;return void this.reevaluate(n,a);case Sn.KEY_F:case Sn.KEY_B:return void this.reevaluate(n,a);case Sn.KEY_RIGHT:case Sn.KEY_LEFT:return void this.reevaluate(n,a);case Sn.KEY_UP:case Sn.KEY_DOWN:if(this.state.completionVisible)return;this.reevaluate(n,a)}}}},{key:"handleClick",value:function(e){if(e.currentTarget){var t=e.currentTarget,n=t.value,a=t.selectionStart;this.reevaluate(n,a)}}},{key:"checkForMissingFields",value:function(){var e=this;if(this.props.autocomplete&&this.props.onFieldFailures){var t=this.parser.getContactFields(this.state.value).filter(function(t){return!(t in e.props.assetStore.fields.items)}).map(function(e){return{message:"".concat(e," is not a valid contact field")}});return this.props.onFieldFailures(t),t.length>0}return!1}},{key:"handleBlur",value:function(e){var t=this;this.checkForMissingFields()?this.props.onBlur&&this.props.onBlur(e):this.setState({query:"",matches:[],selectedOptionIndex:0,completionVisible:!1},function(){return t.props.onBlur&&t.props.onBlur(e)})}},{key:"executeQuery",value:function(e,t){var n=this.parser.expressionContext(e.substr(0,t)),a=null;if(null!==n){var r=n.startsWith("(");if(r){var i=this.parser.functionContext(n);if(i){var o=Nt(this.props.functions,i);o.length>0&&(a=o[0])}}for(var s=n.length;s>=0;s--){var l=n[s];if("@"===l||"("===l||" "===l||0===s){if(("("===l||" "===l)&&(s++,!r))return{completionVisible:!1};var c=n.substr(s,n.length-s),u=xt(this.completion,c);return r&&u.push.apply(u,Object(Nn.a)(Nt(this.props.functions,c))),{query:c,matches:u,completionVisible:u.length>0,selectedOptionIndex:0,caretCoordinates:Gn()(this.textEl,t-c.length),fn:a,value:e}}}}return{value:e,query:null,completionVisible:!1,matches:[],selectedOptionIndex:0}}},{key:"handleChange",value:function(e){var t=e.currentTarget,n=t.value,a=t.selectionStart,r=this.executeQuery(n,a);if(this.props.autocomplete){if(this.props.count===Zn.SMS){var i=qn(n,!0),o=i.parts,s=i.characterCount,l=i.unicodeChars;r.parts=o,r.characterCount=s,r.unicodeChars=l}r.selectedOptionIndex=0,this.setState(r)}this.props.onChange&&this.props.onChange(n,this.props.name)}},{key:"setSelection",value:function(e){var t=e;e>=this.state.matches.length&&(t=this.state.matches.length-1),e<0&&(t=0),t!==this.state.selectedOptionIndex&&this.setState({selectedOptionIndex:t})}},{key:"focusInput",value:function(){var e=this.textEl.value.length;this.textEl.focus(),this.textEl.selectionStart=e}},{key:"getOption",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=function(e){return e.name||e.signature.substr(0,e.signature.indexOf("("))}(e),r=null,i=null;return t&&(r=b.createElement("div",{"data-spec":"option-summary",className:Yn.a.option_summary},b.createElement($n,{source:e.summary}))),e.examples&&n>0&&(i=b.createElement("div",{"data-spec":"option-example",className:Yn.a.option_examples},b.createElement("div",{className:Yn.a.example_header},"EXAMPLE",1!==n?"S":""),b.createElement("div",{className:Yn.a.example},e.examples.slice(0,n).map(function(t,n){return b.createElement("div",{key:e.name+"_example_"+n}," ",t.template)})))),b.createElement(b.Fragment,null,b.createElement("div",{"data-spec":"option-name",className:Yn.a.option_name},e.signature?b.createElement("div",{className:Yn.a.fn_marker},"\u0192"):null,a,t&&e.signature?b.createElement("div",{className:Yn.a.option_signature},function(e){return e.signature.substr(e.signature.indexOf("("))}(e)):null),r,i)}},{key:"getOptions",value:function(){var e=this;return this.state.matches.map(function(t,n){var a=[Yn.a.option];return n===e.state.selectedOptionIndex?(a.push(Yn.a.selected),0===n&&a.push(Yn.a.first_option),b.createElement("li",{ref:e.selectedElRef,className:a.join(" "),key:t.signature||t.name},e.getOption(t,!0,1))):b.createElement("li",{className:a.join(" "),key:t.signature||t.name},e.getOption(t,!1))})}},{key:"hasErrors",value:function(){return this.getMergedErrors().length>0}},{key:"getMergedErrors",value:function(){return this.props.entry?(this.props.entry.validationFailures||[]).concat(this.props.entry.persistantFailures||[]):[]}},{key:"getScroll",value:function(){return this.textEl?this.textEl.scrollTop:0}},{key:"getError",value:function(){return this.props.entry.validationFailures&&this.props.entry.validationFailures.length>0?this.props.entry.validationFailures[0].message:null}},{key:"getTextElement",value:function(){var e,t=ea((e={},Object(_.a)(e,Yn.a.textinput,!0),Object(_.a)(e,$e.a.invalid,this.hasErrors()||!0===this.props.showInvalid),e)),n=this.state.value;return this.props.entry&&(n=this.props.entry.value),this.props.textarea?b.createElement("textarea",{name:this.props.name,"data-spec":"input","data-testid":"input",ref:this.textElRef,className:t,value:n,onClick:this.handleClick,onChange:this.handleChange,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,placeholder:this.props.placeholder,maxLength:this.props.maxLength||-1}):b.createElement("input",{name:this.props.name,"data-spec":"input","data-testid":"input",ref:this.textElRef,type:"text",className:t,value:n,onClick:this.handleClick,onChange:this.handleChange,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,placeholder:this.props.placeholder,maxLength:this.props.maxLength||-1})}},{key:"render",value:function(){var e,t,n=ea((e={},Object(_.a)(e,Yn.a.completion_container,!0),Object(_.a)(e,Yn.a.hidden,!this.state.completionVisible||0===this.state.matches.length),e)),a=ea((t={},Object(_.a)(t,Yn.a.fn_container,!0),Object(_.a)(t,Yn.a.hidden,!this.state.completionVisible||0===this.state.matches.length),t)),r=this.getOptions(),i=this.props.count&&this.props.count===Zn.SMS?b.createElement(Un,{count:this.state.characterCount,parts:this.state.parts.length,unicodeChars:this.state.unicodeChars}):null,o=this.hasErrors()&&"Message"===this.props.name&&(this.props.typeConfig.type===fe.send_msg||this.props.typeConfig.type===fe.send_broadcast),s=this.state.fn&&!this.state.query;return b.createElement(et,{__className:this.props.__className,name:this.props.name,helpText:this.props.helpText,showLabel:this.props.showLabel,entry:this.props.entry,sendMsgError:o},b.createElement("div",{className:Yn.a.wrapper},this.getTextElement(),b.createElement("div",{className:n,style:{top:this.state.caretCoordinates.top-this.getScroll(),left:this.state.caretCoordinates.left},"data-spec":"completion-options"},b.createElement("div",{className:Yn.a.options_wrapper},b.createElement("ul",{className:Yn.a.option_list,"data-spec":"completion-list"},r),b.createElement("div",{className:Yn.a.help,"data-spec":"completion-help"},"Tab to complete, enter to select")),s?b.createElement("div",{className:a},this.getOption(this.state.fn,!0,3)):null)),i)}}]),t}(b.Component),na=Object(Hn.b)(function(e){var t=e.flowContext.assetStore,n=e.editorState,a=n.completionSchema,r=n.functions;return{typeConfig:e.nodeEditor.typeConfig,assetStore:t,completionSchema:a,functions:r}},null,null,{forwardRef:!0})(ta),aa=n(113),ra=n.n(aa);function ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var oa=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=En(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleSave",value:function(){var e,t;if(this.handlePathChanged(this.state.path.value,null,!0)){var n=(e=this.props.nodeSettings,t=this.state,{type:fe.add_contact_urn,uuid:Se(e,fe.add_input_labels),scheme:t.scheme.value.value,path:t.path.value});this.props.updateAction(n),this.props.onClose(!1)}}},{key:"handleSchemeChanged",value:function(e){var t={scheme:{value:e}},n=Qt(this.state,t);return this.setState(n),n.valid}},{key:"handlePathChanged",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={path:an("URN",e,[cn(n)])},r=Qt(this.state,a);return this.setState(r),r.valid}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this,t=this.props.typeConfig;return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement("p",{"data-spec":"label"},b.createElement(Dt.a,{i18nKey:"forms.add_urn.summary"},"Add a new URN to reach the contact such as a phone number.")),b.createElement("div",{className:ra.a.scheme_selection},b.createElement(jn,{name:"URN Type",entry:this.state.scheme,onChange:this.handleSchemeChanged,options:Ol.map(function(e){return kn(e)})})),b.createElement("div",{className:ra.a.path},b.createElement(na,{name:"URN",placeholder:"Enter the URN value",entry:this.state.path,onChange:this.handlePathChanged,onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ia(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ia(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.path,{persistantFailures:t});e.setState({path:n,valid:e.state.valid&&!De(n)})},autocomplete:!0})))}}]),t}(b.PureComponent),sa=function(e){var t=e.resthook;return b.createElement("div",null,t)},la=function(e){var t=e.url;return b.createElement("div",null,t)},ca=function(e){return e.content&&e.content.query},ua=function(e){return e.map(function(e){return{name:e.name,id:e.uuid,type:pe.Group}})},da=function(e){return e?e.map(function(e){return{uuid:e.id,name:e.name}}):[]},pa=function(e){if(e.originalAction&&e.originalAction.type===fe.add_contact_groups){var t=e.originalAction;return{groups:{value:ua(t.groups)},valid:!0}}return{groups:{value:null},valid:!1}},ha=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=pa(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleSave",value:function(){var e,t;if(this.handleGroupsChanged(this.state.groups.value,!0)){var n=(e=this.props.nodeSettings,t=this.state,{type:fe.add_contact_groups,groups:da(t.groups.value),uuid:Se(e,fe.add_contact_groups)});this.props.updateAction(n),this.props.onClose(!1)}}},{key:"handleGroupsChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={groups:an("Groups",e,[cn(t)])},a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleGroupAdded",value:function(e){this.props.addAsset("groups",e),this.handleGroupsChanged((this.state.groups.value||[]).concat(e),!1)}},{key:"handleCreateAssetFromInput",value:function(e){return{name:e}}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("p",{"data-spec":"label"},b.createElement(Dt.a,{i18nKey:"forms.add_groups.summary"},"Select the groups to add the contact to.")),b.createElement(zt,{name:At.t("groups","Groups"),multi:!0,noOptionsMessage:At.t("enter_to_create_group","Enter a name to create a new group"),assets:this.props.assetStore.groups,entry:this.state.groups,onChange:this.handleGroupsChanged,searchable:!0,shouldExclude:ca,createPrefix:At.t("create_group","Create Group")+": ",createAssetFromInput:this.handleCreateAssetFromInput,onAssetCreated:this.handleGroupAdded}))}}]),t}(b.Component),ma=function(e,t){var n=e.type,a=e.groups,r=[];return n!==fe.remove_contact_groups||a&&a.length?Ne(a.map(function(e){return{id:e.uuid,name:e.name,type:pe.Group}}),3,t):(r.push(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"remove_from_all",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"remove_from_all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Remove from all groups";return b.createElement("div",{key:e,"data-spec":t},n)}()),r)},fa=function(e,t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"content";return b.createElement("div",{"data-spec":n},ma(e,t))}(e,t.config.endpoints)};fa.contextTypes={config:Ve};var va=fa,ga=n(74),_a=n.n(ga),ya=Xe.a.bind(_a.a),ba=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={checked:n.props.checked},n.handleChange=n.handleChange.bind(Object(v.a)(n)),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(){var e=this;this.setState({checked:!this.state.checked},function(){e.props.onChange&&e.props.onChange(e.state.checked)})}},{key:"validate",value:function(){return!0}},{key:"render",value:function(){var e=this.state.checked?"fe-check-square":"fe-square";return b.createElement("label",{className:ya(_a.a.label,this.props.labelClassName),onClick:this.handleChange},b.createElement("span",{"data-spec":"checkbox",className:ya(e,this.props.checkboxClassName)}),V(q(this.props.title))(b.createElement("div",{"data-spec":"title",className:_a.a.title},this.props.title)),V(q(this.props.description))(b.createElement("div",{"data-spec":"description",className:this.props.title?_a.a.description:_a.a.description_solo},this.props.description)))}}]),t}(b.Component),Oa=function(e){if(e.originalAction&&e.originalAction.type===fe.remove_contact_groups){var t=e.originalAction,n=t.groups||[];return{groups:{value:ua(n)},removeAll:0===n.length||t.all_groups,valid:!0}}return{groups:{value:null},removeAll:!1,valid:!1}},ka=n(165),Ea=n.n(ka),Ca=At.t("forms.remove_groups.summary","Select the groups to remove the contact from."),wa=(At.t("errors.group_not_found","Enter the name of an existing group"),At.t("forms.remove_groups.placeholder","Enter the name of an existing group"),At.t("forms.remove_groups.remove_from_all_label","Remove from all")),Sa=At.t("forms.remove_groups.remove_from_all_summary","Remove the active contact from all groups they're a member of."),ja=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Oa(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleSave",value:function(){var e,t;if(this.handleGroupsChanged(this.state.groups.value,!0)){var n=(e=this.props.nodeSettings,t=this.state,{type:fe.remove_contact_groups,groups:t.removeAll?[]:da(t.groups.value),all_groups:!!t.removeAll,uuid:Se(e,fe.remove_contact_groups)});this.props.updateAction(n),this.props.onClose(!1)}}},{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={},a=this.state.removeAll?[]:[cn(t)];e.hasOwnProperty("removeAll")&&(n.removeAll=e.removeAll,e.removeAll&&(a=[])),e.hasOwnProperty("groups")&&(n.groups=an("Groups",e.groups,a));var r=Qt(this.state,n);return this.setState(r),r.valid}},{key:"handleGroupsChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.handleUpdate({groups:e},t)}},{key:"handleRemoveAllUpdate",value:function(e){return this.handleUpdate({removeAll:e})}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),V(!this.state.removeAll)(b.createElement("div",null,b.createElement("p",{"data-spec":"label"},Ca),b.createElement(zt,{name:At.t("groups","Groups"),assets:this.props.assetStore.groups,entry:this.state.groups,shouldExclude:ca,searchable:!0,onChange:this.handleGroupsChanged,multi:!0}))),b.createElement(ba,{name:wa,title:wa,labelClassName:this.state.removeAll?"":Ea.a.checkbox,checked:this.state.removeAll,description:Sa,onChange:this.handleRemoveAllUpdate}))}}]),t}(b.Component);ja.contextTypes={assetService:Ve};var Na=n(39),xa=n.n(Na),Pa=function(e){var t={},n=e.localizations[0],a=n.getObject();return(e.originalAction&&wl(e.originalAction.type).localizeableKeys||[]).forEach(function(e){t[e]={value:e in n.localizedKeys?a[e]:""}}),{keyValues:t,valid:!0}},Da=function(e){if(e.originalAction&&(e.originalAction.type===fe.send_msg||e.originalAction.type===fe.say_msg)&&e.localizations&&e.localizations.length>0){var t=e.localizations[0];if(t.isLocalized()){var n=t.getObject();return{message:{value:"text"in t.localizedKeys?n.text:""},quickReplies:{value:"quick_replies"in t.localizedKeys&&n.quick_replies||[]},audio:{value:"audio_url"in t.localizedKeys?n.audio_url:null},valid:!0}}}return{message:{value:""},quickReplies:{value:[]},audio:{value:null},valid:!0}},Ra=function(e){var t=e.originalNode,n=t&&t.node;if(e.originalAction&&e.originalAction.type)return wl(e.originalAction.type);if(n&&n.actions&&n.actions.length>0)return wl(n.actions[n.actions.length-1].type);try{var a=Sl(t),r=wl(a);if(r.type!==fe.missing)return r}catch(Error){}if(n&&n.router)return wl(n.router.type);throw new Error("Couldn't determine type config for: ".concat(n.uuid))};function Ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ta(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ta(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ua=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Pa(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^on/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleKeyUpdate",value:function(e,t){var n=Aa({},this.state.keyValues);return n[t.toLowerCase()]={value:e},this.setState({keyValues:n}),!0}},{key:"handleSave",value:function(){var e=this,t={};Object.keys(this.state.keyValues).forEach(function(n){var a=e.state.keyValues[n].value;a?t[n]=a:delete t[n]}),this.props.updateLocalizations(this.props.language.id,[{uuid:this.props.nodeSettings.originalAction.uuid,translations:t}]),this.props.onClose(!1)}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e,t=this,n=Ra(this.props.nodeSettings),a=[];return n.localizeableKeys.forEach(function(n){var r=n[0].toUpperCase()+n.slice(1),i=b.createElement("div",{key:"localize_form_".concat(n)},b.createElement("div",{"data-spec":"translation-container"},b.createElement("div",{"data-spec":"text-to-translate",className:xa.a.translate_from},t.props.nodeSettings.originalAction[n])),b.createElement(na,{name:r,showLabel:!1,onChange:t.handleKeyUpdate,entry:t.state.keyValues[n],placeholder:"".concat(t.props.language.name," Translation"),onFieldFailures:function(e){var a=t.state.keyValues;a[n]=Aa({},t.state.keyValues[n],{persistantFailures:e}),t.setState({keyValues:a,valid:t.state.valid})},autocomplete:!0,focus:!0,textarea:!0}));e?a.push({name:r+" "+At.t("translation","Translation"),body:i,checked:!!t.state.keyValues[n].value}):e=i}),b.createElement(ce,{title:n.name,headerClass:n.type,buttons:this.getButtons(),tabs:a},e)}}]),t}(b.Component);Ua.contextTypes={config:Ve};var Fa=n(82),Ia=n.n(Fa),Ma=function(e){var t=e.text;e.text.startsWith("@")?t="@(exp)":e.maxLength&&t.length>e.maxLength&&(t=e.text.substring(0,e.maxLength)+"...");var n=[Ia.a.pill];return e.large&&n.push(Ia.a.large),e.onClick&&n.push(Ia.a.clickable),b.createElement("div",{style:e.style,"data-advanced":e.advanced,onClick:e.onClick,className:n.join(" ")},t,e.icon?b.createElement("span",{"data-advanced":e.advanced,className:Ia.a.icon+" "+e.icon}):null)},La=n(114),za=n.n(La);function Ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Va=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).props.entry?n.state={currentInput:n.props.entry}:n.state={currentInput:{value:""}},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleInputChanged",value:function(e){this.setState({currentInput:{value:e}}),this.props.onEntryChanged&&this.props.onEntryChanged({value:e})}},{key:"handleAddItem",value:function(e){var t=this;return window.setTimeout(function(){if(!((t.state.currentInput.persistantFailures||[]).length>0)&&t.state.currentInput.value.trim().length>0){var e=t.state.currentInput.value.trim();t.props.onItemAdded(e)&&t.setState({currentInput:{value:""}}),t.props.onEntryChanged&&t.props.onEntryChanged({value:""})}},0),!0}},{key:"handleValidateEmpty",value:function(){var e=this,t=an(this.props.name,this.state.currentInput.value,[rn]);this.setState({currentInput:t},function(){e.props.onEntryChanged&&e.props.onEntryChanged(t)})}},{key:"getChosenItems",value:function(){var e=this;return this.props.items.value.length>0?b.createElement("div",{className:za.a.chosen},this.props.items.value.map(function(t){return b.createElement("div",{key:"item_".concat(t),className:za.a.item},b.createElement(Ma,{icon:"fe-x",text:" "+t,large:!0,onClick:function(){e.props.onRemoved(t)}}))})):null}},{key:"render",value:function(){var e=this;return b.createElement(b.Fragment,null,this.getChosenItems(),this.props.helpText?b.createElement("p",null,this.props.helpText):b.createElement("p",null),b.createElement(na,{name:this.props.name,placeholder:this.props.name,showLabel:!1,onChange:this.handleInputChanged,entry:this.state.currentInput,autocomplete:!0,focus:!0,onBlur:this.handleValidateEmpty,onEnter:this.handleAddItem,onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ba(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ba(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.currentInput,{persistantFailures:t});e.setState({currentInput:n},function(){e.props.onEntryChanged&&e.props.onEntryChanged(n)})}}))}}]),t}(b.Component),qa=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).filePicker=void 0,n.state={},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleRemoveUpload",value:function(){this.props.onUploadChanged(null)}},{key:"handleUploadFile",value:function(e){var t=this,n=new FormData;n.append("file",e[0]);var a=st("csrftoken"),r=a?{"X-CSRFToken":a}:{};it.a.post(this.props.endpoint,n,{headers:r}).then(function(e){t.props.onUploadChanged(e.data.url)}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this;return b.createElement(b.Fragment,null,b.createElement("input",{style:{display:"none"},ref:function(t){e.filePicker=t},type:"file",onChange:function(t){return e.handleUploadFile(t.target.files)}}),this.props.url?b.createElement(ae,{iconName:"fe-trash",name:this.props.removeText,topSpacing:!0,onClick:this.handleRemoveUpload,type:N.tertiary}):b.createElement(ae,{iconName:this.props.icon,name:this.props.uploadText,topSpacing:!0,onClick:function(){e.filePicker.click()},type:N.tertiary}))}}]),t}(b.Component);function Ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Ka(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ha(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ha(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ga=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Da(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^on/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleMessageUpdate",value:function(e){return this.handleUpdate({text:e})}},{key:"handleQuickRepliesUpdate",value:function(e){return this.handleUpdate({quickReplies:e})}},{key:"handleAudioChanged",value:function(e){this.handleUpdate({audio:e})}},{key:"handleUpdate",value:function(e){var t={};e.hasOwnProperty("text")&&(t.message=an("Message",e.text,[])),e.hasOwnProperty("quickReplies")&&(t.quickReplies=an("Quick Replies",e.quickReplies,[dn])),e.hasOwnProperty("audio")&&(t.audio={value:e.audio});var n=Qt(this.state,t);return this.setState(n),n.valid}},{key:"handleSave",value:function(){var e=this.state,t=e.message,n=e.quickReplies,a=e.audio;if(!(Ra(this.props.nodeSettings).localizeableKeys.indexOf("quick_replies")>-1)||this.handleQuickRepliesUpdate(this.state.quickReplies.value)){var r={};t.value&&(r.text=t.value),n.value&&n.value.length>0&&(r.quick_replies=n.value),a.value&&(r.audio_url=a.value),this.props.updateLocalizations(this.props.language.id,[{uuid:this.props.nodeSettings.originalAction.uuid,translations:r}]),this.props.onClose(!1)}}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleAddQuickReply",value:function(e){var t=Object(Nn.a)(this.state.quickReplies.value);return!(t.length>=10)&&(!t.find(function(t){return t.toLowerCase()===e.toLowerCase()})&&(t.push(e),this.setState({quickReplies:{value:t}}),!0))}},{key:"handleRemoveQuickReply",value:function(e){this.setState({quickReplies:{value:this.state.quickReplies.value.filter(function(t){return t!==e})}})}},{key:"handleQuickReplyFieldFailures",value:function(e){var t=Ka({},this.state.quickReplies,{persistantFailures:e});this.setState({quickReplies:t,valid:this.state.valid&&!De(t)})}},{key:"render",value:function(){var e=this,t=Ra(this.props.nodeSettings),n=[];t.localizeableKeys.indexOf("quick_replies")>-1&&n.push({name:"Quick Replies",body:b.createElement(b.Fragment,null,b.createElement(Va,{name:"Quick Reply",helpText:b.createElement(Dt.a,{i18nKey:"forms.send_msg.localized_quick_replies",values:{language:this.props.language.name}},"Add a new [[language]] Quick Reply and press enter."),items:this.state.quickReplies,onRemoved:this.handleRemoveQuickReply,onItemAdded:this.handleAddQuickReply,onFieldErrors:this.handleQuickReplyFieldFailures})),checked:this.state.quickReplies.value.length>0});var a=null;return t.localizeableKeys.indexOf("audio_url")>0&&(a=b.createElement(qa,{icon:"fe-mic",uploadText:"Upload Recording",removeText:"Remove Recording",url:this.state.audio.value,endpoint:this.context.config.endpoints.attachments,onUploadChanged:this.handleAudioChanged})),b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons(),tabs:n},b.createElement("div",{"data-spec":"translation-container"},b.createElement("div",{"data-spec":"text-to-translate",className:xa.a.translate_from},this.props.nodeSettings.originalAction.text)),b.createElement(na,{name:"Message",showLabel:!1,onChange:this.handleMessageUpdate,entry:this.state.message,placeholder:"".concat(this.props.language.name," Translation"),onFieldFailures:function(t){var n=Ka({},e.state.message,{persistantFailures:t});e.setState({message:n,valid:e.state.valid&&!De(n)})},autocomplete:!0,focus:!0,textarea:!0}),a)}}]),t}(b.Component);Ga.contextTypes={config:Ve};var Wa=function(e){var t=e.type;return b.createElement("div",{className:"placeholder"},"No implementation yet for ",t)},Ya=function(e){return b.createElement("div",null,e.audio_url)},Qa=function(e){return e.originalAction&&e.originalAction.type===fe.play_audio?{audio:{value:e.originalAction.audio_url},valid:!0}:{audio:{value:""},valid:!1}};function Xa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Za=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Qa(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleAudioUpdate",value:function(e){var t={};t.audio=an("Recording",e,[on]);var n=Qt(this.state,t);return this.setState(n),n.valid}},{key:"handleSave",value:function(){var e;this.handleAudioUpdate(this.state.audio.value)&&(this.props.updateAction((e=this.props.nodeSettings,{audio_url:this.state.audio.value,type:fe.play_audio,uuid:Se(e,fe.say_msg)})),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this,t=this.props.typeConfig;return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement("p",null,At.t("forms.play_audio.recording_label","Previous Recording")),b.createElement(na,{name:At.t("message","Message"),showLabel:!1,onChange:this.handleAudioUpdate,entry:this.state.audio,onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xa(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xa(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.audio,{persistantFailures:t});e.setState({audio:n,valid:e.state.valid&&!De(n)})},autocomplete:!0,focus:!0,helpText:b.createElement(Dt.a,{i18nKey:"forms.play_audio.help_text"},"Enter a variable that contains a recording the contact has previously recorded. For example, @results.voicemail or @fields.short_bio.")}))}}]),t}(b.Component),$a=n(62),Ja=n.n($a),er=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).ele=void 0,n.stroke=1,n.radius=9,n.radiusNormalized=n.radius-2*n.stroke,n.circumference=2*n.radiusNormalized*Math.PI,n.state={durationSeconds:0,currentSeconds:0,playing:!1,progress:0},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleTimeUpdate",value:function(e){var t=this,n=this.ele.currentTime||0,a=this.ele.duration||0;this.setState(function(e){return(t.ele.ended||0===n)&&e.playing&&setTimeout(function(){t.setState({progress:0,playing:!1})},500),{currentSeconds:t.ele.ended?0:n,durationSeconds:a,playing:n>0,progress:a>0?Math.floor(n/a*100):0}})}},{key:"componentDidMount",value:function(){this.props.triggered&&this.handleTogglePlay(null)}},{key:"handleTogglePlay",value:function(e){this.state.playing?(this.ele.pause(),this.ele.currentTime=0):this.ele.play(),null!==e&&(e.preventDefault(),e.stopPropagation())}},{key:"handleRef",value:function(e){return this.ele=e}},{key:"componentDidUpdate",value:function(e){this.props.url!==e.url&&this.setState({durationSeconds:0,currentSeconds:0,playing:!1,progress:0})}},{key:"render",value:function(){var e=this.state.progress||0,t=this.circumference-e/100*this.circumference;return b.createElement("div",{className:Ja.a.player+" "+(this.state.playing?Ja.a.playing:""),style:{height:2*this.radius,width:2*this.radius},onMouseDown:this.handleTogglePlay},b.createElement("audio",{ref:this.handleRef,onTimeUpdate:this.handleTimeUpdate,src:this.props.url}),b.createElement("div",{className:Ja.a.circles},b.createElement("svg",{height:2*this.radius,width:2*this.radius},b.createElement("circle",{className:Ja.a.circle_background,stroke:"#fff",fill:"#fff",strokeWidth:this.stroke,r:this.radiusNormalized,cx:this.radius,cy:this.radius}),b.createElement("circle",{className:Ja.a.circle_background,stroke:"#ddd",fill:"transparent",strokeWidth:this.stroke,r:this.radiusNormalized,cx:this.radius,cy:this.radius}),b.createElement("circle",{className:Ja.a.circle_foreground,stroke:"cornflowerblue",fill:"transparent",strokeWidth:this.stroke,strokeDasharray:this.circumference+" "+this.circumference,style:{strokeDashoffset:t},r:this.radiusNormalized,cx:this.radius,cy:this.radius}))),b.createElement("div",{className:Ja.a.button+" "+(this.state.playing?"fe-stop":"fe-play_arrow")}))}}]),t}(b.Component),tr=n(115),nr=n.n(tr),ar=At.t("actions.say_msg.placeholder","Send a message to the contact"),rr=function(e){return e.text?b.createElement(b.Fragment,null,b.createElement("div",{className:nr.a.text},e.text),e.audio_url?b.createElement("div",{className:nr.a.recording},b.createElement(er,{url:e.audio_url})):null):b.createElement("div",{className:"placeholder"},ar)},ir=function(e){if(e.originalAction&&e.originalAction.type===fe.say_msg){var t=e.originalAction;return{message:{value:t.text},audio:{value:t.audio_url},valid:!0}}return{message:{value:""},audio:{value:""},valid:!1}};function or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var sr=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=ir(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("text")&&(n.message=an("Message",e.text,[cn(t)]));var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleMessageUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.handleUpdate({text:e},n)}},{key:"handleSave",value:function(){var e,t;this.handleUpdate({text:this.state.message.value},!0)&&(this.props.updateAction((e=this.props.nodeSettings,{text:(t=this.state).message.value,audio_url:t.audio.value,type:fe.say_msg,uuid:Se(e,fe.say_msg)})),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleUploadChanged",value:function(e){this.setState({audio:{value:e}})}},{key:"render",value:function(){var e=this,t=this.props.typeConfig;return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement(na,{name:"Message",showLabel:!1,onChange:this.handleMessageUpdate,entry:this.state.message,onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?or(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):or(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.message,{persistantFailures:t});e.setState({message:n,valid:e.state.valid&&!De(n)})},autocomplete:!0,focus:!0,textarea:!0}),b.createElement(qa,{icon:"fe-mic",uploadText:"Upload Recording",removeText:"Remove Recording",url:this.state.audio.value,endpoint:this.context.config.endpoints.attachments,onUploadChanged:this.handleUploadChanged}))}}]),t}(b.Component);sr.contextTypes={config:Ve};var lr=n(83),cr=n.n(lr),ur=At.t("actions.send_broadcast.placeholder","Send a message to the contact"),dr=function(e,t){var n=je(e);return e.text?b.createElement("div",{className:cr.a.node},b.createElement("div",{className:cr.a.to},Ne(n,3,t.config.endpoints)),b.createElement("div",{className:cr.a.message},e.text.split(/\r?\n/).map(function(t,n){return b.createElement("div",{key:e.uuid+n,className:cr.a.line},t)}))):b.createElement("div",{className:"placeholder"},ur)};dr.contextTypes={config:Ve};var pr=dr,hr=function(e){if(e.originalAction&&e.originalAction.type===fe.send_broadcast){var t=e.originalAction;if(e.localizations&&e.localizations.length>0){if(!e.localizations[0].isLocalized())return{message:{value:""},recipients:{value:[]},valid:!0};t=e.localizations[0].getObject()}return{message:{value:t.text},recipients:{value:je(t)},valid:!0}}return{message:{value:""},recipients:{value:[]},valid:!1}};function mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var fr=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=hr(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleRecipientsChanged",value:function(e){return this.handleUpdate({recipients:e})}},{key:"handleMessageUpdate",value:function(e){return this.handleUpdate({text:e})}},{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("recipients")&&(n.recipients=an("Recipients",e.recipients,[cn(t)])),e.hasOwnProperty("text")&&(n.message=an("Message",e.text,[cn(t)]));var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleSave",value:function(){var e,t;this.handleUpdate({text:this.state.message.value,recipients:this.state.recipients.value},!0)&&(this.props.updateAction((e=this.props.nodeSettings,t=this.state,{legacy_vars:Re(t.recipients.value),contacts:Te(t.recipients.value,pe.Contact),groups:Te(t.recipients.value,pe.Group),text:t.message.value,type:fe.send_broadcast,uuid:Se(e,fe.send_broadcast)})),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this,t=this.props.typeConfig;return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement(zt,{name:"Recipients",assets:this.props.assetStore.recipients,entry:this.state.recipients,completion:{assetStore:this.props.assetStore,schema:this.props.completionSchema},searchable:!0,multi:!0,onChange:this.handleRecipientsChanged}),b.createElement("p",null),b.createElement(na,{name:"Message",showLabel:!1,count:Zn.SMS,onChange:this.handleMessageUpdate,entry:this.state.message,onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mr(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.message,{persistantFailures:t});e.setState({message:n,valid:e.state.valid&&!De(n)})},autocomplete:!0,focus:!0,textarea:!0}))}}]),t}(b.Component);fr.contextTypes={endpoints:Ve,assetService:Ve};var vr=function(e){var t=e.subject;return b.createElement("div",null,t)},gr=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateTags",value:function(e){this.props.onChange&&this.props.onChange(function(e){return e.map(function(e){return e.label})}(e))}},{key:"handleCheckValid",value:function(e){return!(!e||0===e.trim().length)&&this.props.onCheckValid(e)}},{key:"arrowRenderer",value:function(){return O.a.createElement("div",null)}},{key:"render",value:function(){var e=this,t=I((this.props.entry.validationFailures||[]).length),n=function(e){return e.value.map(function(e){return{label:e,value:e}})}(this.props.entry);return O.a.createElement(et,{name:this.props.name,entry:this.props.entry},O.a.createElement(Ft.a,{styles:wt,className:t,name:this.props.name,placeholder:this.props.placeholder,value:n,onChange:this.handleUpdateTags,isMulti:!0,isSearchable:!0,isValidNewOption:this.handleCheckValid,noOptionsMessage:function(){return e.props.prompt},formatCreateLabel:function(t){return void 0!==e.props.createPrompt?e.props.createPrompt+t:"Create new "+t},options:[]}))}}]),t}(O.a.Component),_r=function(e){if(e.originalAction&&e.originalAction.type===fe.send_email){var t=e.originalAction;return{body:{value:t.body},subject:{value:t.subject},recipients:{value:t.addresses},valid:!0}}return{body:{value:""},subject:{value:""},recipients:{value:[]},valid:!0}},yr=n(95),br=n.n(yr);function Or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function kr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Or(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Or(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Er=/\S+@\S+\.\S+/,Cr=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=_r(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleRecipientsChanged",value:function(e){return this.handleUpdate({recipients:e})}},{key:"handleSubjectChanged",value:function(e){return this.handleUpdate({subject:e})}},{key:"handleBodyChanged",value:function(e){return this.handleUpdate({body:e})}},{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("recipients")&&(n.recipients=an("Recipients",e.recipients,[cn(t)])),e.hasOwnProperty("subject")&&(n.subject=an("Subject",e.subject,[cn(t)])),e.hasOwnProperty("body")&&(n.body=an("Body",e.body,[cn(t)]));var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleSave",value:function(){var e,t;this.handleUpdate({recipients:this.state.recipients.value,subject:this.state.subject.value,body:this.state.body.value},!0)&&(this.props.updateAction((e=this.props.nodeSettings,{addresses:(t=this.state).recipients.value,subject:t.subject.value,body:t.body.value,type:fe.send_email,uuid:Se(e,fe.send_email)})),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleCheckValid",value:function(e){return Er.test(e)||e.startsWith("@")}},{key:"render",value:function(){var e=this,t=this.props.typeConfig;return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement("div",{className:br.a.ele},b.createElement(gr,{name:At.t("forms.send_email.recipient_name","Recipient"),placeholder:At.t("forms.send_email.recipient_placeholder","To"),prompt:At.t("forms.send_email.recipient_prompt","Enter email address"),onCheckValid:this.handleCheckValid,entry:this.state.recipients,onChange:this.handleRecipientsChanged,createPrompt:""}),b.createElement(na,{__className:br.a.subject,name:At.t("forms.send_email.subject_name","Subject"),placeholder:At.t("forms.send_email.subject_placeholder","Subject"),onChange:this.handleSubjectChanged,entry:this.state.subject,onFieldFailures:function(t){var n=kr({},e.state.subject,{persistantFailures:t});e.setState({subject:n,valid:e.state.valid&&!De(n)})},autocomplete:!0}),b.createElement(na,{__className:br.a.message,name:At.t("forms.send_email.message_name","Message"),showLabel:!1,onChange:this.handleBodyChanged,entry:this.state.body,onFieldFailures:function(t){var n=kr({},e.state.body,{persistantFailures:t});e.setState({body:n,valid:e.state.valid&&!De(n)})},autocomplete:!0,textarea:!0})))}}]),t}(b.Component),wr=n(75),Sr=n.n(wr),jr=At.t("actions.send_msg.placeholder","Send a message to the contact"),Nr=function(e){if(e.text){var t=null;return(e.quick_replies||[]).length>0&&(t=b.createElement("div",{className:Sr.a.quick_replies},e.quick_replies.map(function(t){return b.createElement(Ma,{style:{marginLeft:4,marginTop:4},maxLength:20,advanced:!0,key:e.uuid+t,text:t})}))),b.createElement(b.Fragment,null,b.createElement("div",null,e.text.split(/\r?\n/).map(function(t,n){return b.createElement("div",{key:e.uuid+n,className:Sr.a.line},t)}),e.attachments&&e.attachments.length>0?b.createElement("div",{"data-advanced":!0,className:"".concat(Sr.a.attachment," fe-paperclip")}):null,e.templating&&e.templating.template?b.createElement("div",{"data-advanced":!0,className:"".concat(Sr.a.whatsapp," fe-whatsapp")}):null),b.createElement("div",{className:Sr.a.summary},t))}return b.createElement("div",{className:"placeholder"},jr)},xr=function(e,t){var n={value:null},a=[];if(e.originalAction&&e.originalAction.type===fe.send_msg){var r=e.originalAction,i=[];if((r.attachments||[]).forEach(function(e){var t=e.indexOf(":"),n=e.substring(0,t),a={type:n,url:e.substring(t+1),uploaded:n.indexOf("/")>-1};i.push(a)}),r.templating){var o=r.templating.template;n={value:{id:o.uuid,name:o.name,type:pe.Template}},a=r.templating.variables.map(function(e){return{value:e}})}return{template:n,templateVariables:a,attachments:i,message:{value:r.text},quickReplies:{value:r.quick_replies||[]},quickReplyEntry:{value:""},sendAll:r.all_urns,valid:!0}}return{template:n,templateVariables:[],attachments:[],message:{value:""},quickReplies:{value:[]},quickReplyEntry:{value:""},sendAll:!1,valid:!1}},Pr=n(45),Dr=n.n(Pr);function Rr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rr(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ar=[{value:"image",label:"Image URL"},{value:"audio",label:"Audio URL"},{value:"video",label:"Video URL"}],Ur=Ar.concat([{value:"upload",label:"Upload Attachment"}]),Fr=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).filePicker=void 0,n.state=xr(n.props.nodeSettings,n.props.assetStore),Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^on/]}),null!==n.state.template.value&&lt(n.props.assetStore.templates,n.state.template.value.id).then(function(e){null!==e&&n.handleTemplateChanged([e])}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("text")&&(n.message=an("Message",e.text,[cn(t)])),e.hasOwnProperty("sendAll")&&(n.sendAll=e.sendAll),e.hasOwnProperty("quickReplies")&&(n.quickReplies=an("Quick Replies",e.quickReplies,[dn]));var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleMessageUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.handleUpdate({text:e},n)}},{key:"handleQuickRepliesUpdate",value:function(e){return this.handleUpdate({quickReplies:e})}},{key:"handleSendAllUpdate",value:function(e){return this.handleUpdate({sendAll:e})}},{key:"handleSave",value:function(){var e=this.handleMessageUpdate(this.state.message.value,null,!0),t=this.state.templateVariables;this.state.templateVariables.forEach(function(n,a){var r=an("Variable ".concat(a+1),n.value,[on]);t=Yt()(t,Object(_.a)({},a,{$merge:r})),e=e&&!De(r)}),(e=e&&!De(this.state.quickReplyEntry))?(this.props.updateAction(function(e,t){var n=t.attachments.filter(function(e){return e.url.trim().length>0}).map(function(e){return"".concat(e.type,":").concat(e.url)}),a=null;t.template&&t.template.value&&(a={template:{uuid:t.template.value.id,name:t.template.value.name},variables:t.templateVariables.map(function(e){return e.value})});var r={attachments:n,text:t.message.value,type:fe.send_msg,all_urns:t.sendAll,quick_replies:t.quickReplies.value,uuid:Se(e,fe.send_msg)};return a&&(r.templating=a),r}(this.props.nodeSettings,this.state)),this.props.onClose(!1)):this.setState({templateVariables:t,valid:e})}},{key:"handleFieldFailures",value:function(e){var t=Tr({},this.state.message,{persistantFailures:e});this.setState({message:t,valid:this.state.valid&&!De(t)})}},{key:"handleQuickReplyFieldFailures",value:function(e){var t=Tr({},this.state.quickReplies,{persistantFailures:e});this.setState({quickReplies:t,valid:this.state.valid&&!De(t)})}},{key:"handleAttachmentRemoved",value:function(e){var t=Yt()(this.state.attachments,{$splice:[[e,1]]});this.setState({attachments:t})}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderUpload",value:function(e,t){var n=this;return b.createElement("div",{className:Dr.a.url_attachment,key:e>-1?"url_attachment_"+e:X()},b.createElement("div",{className:Dr.a.type_choice},b.createElement(jn,{name:"Type",styles:Ct,entry:{value:{label:t.type}},options:Ar})),b.createElement("div",{className:Dr.a.url},b.createElement("span",{className:Dr.a.upload},b.createElement(Ma,{icon:"fe-download",text:" Download",large:!0,onClick:function(){window.open(t.url,"_blank")}}),b.createElement("div",{className:Dr.a.remove_upload},b.createElement(Ma,{icon:"fe-x",text:" Remove",large:!0,onClick:function(){n.handleAttachmentRemoved(e)}})))))}},{key:"handleUploadFile",value:function(e){var t=this,n=this.state.attachments,a=st("csrftoken"),r=a?{"X-CSRFToken":a}:{},i=new FormData;i.append("file",e[0]),it.a.post(this.context.config.endpoints.attachments,i,{headers:r}).then(function(e){n=Yt()(n,{$push:[{type:e.data.type,url:e.data.url,uploaded:!0}]}),t.setState({attachments:n})}).catch(function(e){console.log(e)})}},{key:"renderAttachment",value:function(e,t){var n,a=this,r=this.state.attachments;return b.createElement("div",{className:Dr.a.url_attachment,key:e>-1?"url_attachment_"+e:X()},b.createElement("div",{className:Dr.a.type_choice},b.createElement(jn,{styles:Ct,name:"Type Options",placeholder:"Add Attachment",entry:{value:e>-1?(n=t.type,Ar.find(function(e){return e.value===n})):null},onChange:function(n){"upload"===n.value?window.setTimeout(function(){a.filePicker.click()},200):(r=-1===e?Yt()(r,{$push:[{type:n.value,url:""}]}):Yt()(r,Object(_.a)({},e,{$set:{type:n.value,url:t.url}})),a.setState({attachments:r}))},options:e>-1?Ar:Ur})),e>-1?b.createElement(b.Fragment,null,b.createElement("div",{className:Dr.a.url},b.createElement(na,{placeholder:"URL",name:"url",onChange:function(n){r=Yt()(r,Object(_.a)({},e,{$set:{type:t.type,url:n}})),a.setState({attachments:r})},entry:{value:t.url},autocomplete:!0})),b.createElement("div",{className:Dr.a.remove},b.createElement(Ma,{icon:"fe-x",text:" Remove",large:!0,onClick:function(){a.handleAttachmentRemoved(e)}}))):null)}},{key:"renderAttachments",value:function(){var e=this,t=this.state.attachments.map(function(t,n){return t.uploaded?e.renderUpload(n,t):e.renderAttachment(n,t)}),n=this.state.attachments.length<3?this.renderAttachment(-1,{url:"",type:""}):null;return b.createElement(b.Fragment,null,b.createElement("p",null,At.t("forms.send_msg.summary","Add an attachment to each message. The attachment can be a file you upload or a dynamic URL using expressions and variables from your Flow.",{count:3})),t,n,b.createElement("input",{style:{display:"none"},ref:function(t){e.filePicker=t},type:"file",onChange:function(t){return e.handleUploadFile(t.target.files)}}))}},{key:"handleTemplateChanged",value:function(e){var t=e[0];if(t){var n=t.content.translations[0],a=0===this.state.templateVariables.length||this.state.template.value&&this.state.template.value.id!==t.id?Z(0,n.variable_count).map(function(){return{value:""}}):this.state.templateVariables;this.setState({template:{value:t},templateTranslation:n,templateVariables:a})}else this.setState({template:{value:null},templateTranslation:null,templateVariables:[]})}},{key:"handleTemplateFieldFailures",value:function(e,t){var n=Yt()(this.state.templateVariables,Object(_.a)({},t,{$merge:{persistantFailures:e}}));this.setState({templateVariables:n,valid:this.state.valid&&!De(n[t])})}},{key:"handleTemplateVariableChanged",value:function(e,t){var n=an("Variable ".concat(t+1),e,[on]),a=Yt()(this.state.templateVariables,{$merge:Object(_.a)({},t,n)});this.setState({templateVariables:a})}},{key:"handleShouldExcludeTemplate",value:function(e){return!e.content.translations.find(function(e){return"pending"===e.status||"approved"===e.status})}},{key:"renderTemplateConfig",value:function(){var e=this;return b.createElement(b.Fragment,null,b.createElement("p",null,At.t("forms.send_msg.whatsapp_warning","Sending messages over a WhatsApp channel requires that a template be used if you have not received a message from a contact in the last 24 hours. Setting a template to use over WhatsApp is especially important for the first message in your flow.")),b.createElement(zt,{name:"Template",noOptionsMessage:"No templates found",assets:this.props.assetStore.templates,entry:this.state.template,onChange:this.handleTemplateChanged,shouldExclude:this.handleShouldExcludeTemplate,searchable:!0,formClearable:!0}),this.state.templateTranslation?b.createElement(b.Fragment,null,b.createElement("div",{className:Dr.a.template_text},this.state.templateTranslation.content),Z(0,this.state.templateTranslation.variable_count).map(function(t){return b.createElement("div",{className:Dr.a.variable,key:"tr_arg_"+t},b.createElement(na,{name:"Variable ".concat(t+1),showLabel:!1,placeholder:"Variable ".concat(t+1),onChange:function(n){e.handleTemplateVariableChanged(n,t)},entry:e.state.templateVariables[t],autocomplete:!0,onFieldFailures:function(n){e.handleTemplateFieldFailures(n,t)}}))})):null)}},{key:"handleAddQuickReply",value:function(e){var t=Object(Nn.a)(this.state.quickReplies.value);return!(t.length>=10)&&(!t.find(function(t){return t.toLowerCase()===e.toLowerCase()})&&(t.push(e),this.setState({quickReplies:{value:t}}),!0))}},{key:"handleRemoveQuickReply",value:function(e){this.setState({quickReplies:{value:this.state.quickReplies.value.filter(function(t){return t!==e})}})}},{key:"handleQuickReplyEntry",value:function(e){this.setState({quickReplyEntry:e})}},{key:"render",value:function(){var e=this.props.typeConfig,t=[{name:"Quick Replies",body:b.createElement(b.Fragment,null,b.createElement("p",null,At.t("forms.send_msg.quick_replies",'Quick Replies are made into buttons for supported channels. For example, when asking a question, you might add a Quick Reply for "Yes" and one for "No".')),b.createElement(Va,{name:"Quick Reply",helpText:b.createElement(Dt.a,{i18nKey:"forms.send_msg.add_quick_reply"},"Add a new Quick Reply and press enter."),items:this.state.quickReplies,entry:this.state.quickReplyEntry,onRemoved:this.handleRemoveQuickReply,onItemAdded:this.handleAddQuickReply,onEntryChanged:this.handleQuickReplyEntry,onFieldErrors:this.handleQuickReplyFieldFailures})),checked:this.state.quickReplies.value.length>0,hasErrors:De(this.state.quickReplyEntry)},{name:"Attachments",body:this.renderAttachments(),checked:this.state.attachments.length>0},{name:"Advanced",body:b.createElement(ba,{name:"All Destinations",title:"All Destinations",labelClassName:Dr.a.checkbox,checked:this.state.sendAll,description:At.t("forms.send_msg.all_destinations","Send a message to all destinations known for this contact. If you aren't sure what this means, leave it unchecked."),onChange:this.handleSendAllUpdate}),checked:this.state.sendAll}];if(jl(this.context.config,ge.HAS_WHATSAPP)){var n={name:"WhatsApp",body:this.renderTemplateConfig(),checked:null!=this.state.template.value,hasErrors:!!this.state.templateVariables.find(function(e){return De(e)})};t.splice(0,0,n)}return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons(),tabs:t},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement(na,{name:"Message",showLabel:!1,count:Zn.SMS,onChange:this.handleMessageUpdate,entry:this.state.message,autocomplete:!0,focus:!0,textarea:!0,onFieldFailures:this.handleFieldFailures}))}}]),t}(b.Component);Fr.contextTypes={config:Ve};var Ir=function(e){return b.createElement("span",{className:"emph"},e)},Mr=function(e){var t=e.value,n=e.name;return t?function(e,t){return b.createElement("div",null,"Save ",e," as ",t)}(t,Ir(n)):function(e){return b.createElement("div",null,"Clear value for ",e)}(Ir(n))},Lr=function(e){if(e.originalAction&&e.originalAction.type===fe.set_run_result){var t=e.originalAction;return{name:{value:{id:U(t.name),name:t.name,type:pe.Result}},value:{value:t.value},category:{value:t.category},valid:!0}}return{name:{value:null},value:{value:""},category:{value:""},valid:!1}},zr=n(96),Br=n.n(zr);function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var qr=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Lr(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^on/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleNameUpdate",value:function(e){this.handleUpdate({name:e[0]})}},{key:"handleValueUpdate",value:function(e){return this.handleUpdate({value:e})}},{key:"handleCategoryUpdate",value:function(e){return this.handleUpdate({category:e})}},{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("name")&&(n.name=an("Name",e.name,[cn(t),fn,pn])),e.hasOwnProperty("value")&&(n.value=an("Value",e.value,[])),e.hasOwnProperty("category")&&(n.category=an("Category",e.category,[]));var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleSave",value:function(){var e,t;this.handleUpdate({name:this.state.name.value},!0)&&(this.props.updateAction((e=this.props.nodeSettings,t=this.state,{type:fe.set_run_result,name:t.name.value.name,value:t.value.value,category:t.category.value,uuid:Se(e,fe.set_run_result)})),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleCreateAssetFromInput",value:function(e){return{id:U(e),name:e,type:pe.Result}}},{key:"render",value:function(){var e=this,t=this.props.typeConfig,n=!De(this.state.name)&&this.state.name.value?"."+U(this.state.name.value.name):"";return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement("div",{className:Br.a.form},b.createElement(zt,{name:"Result",assets:this.props.assetStore.results,entry:this.state.name,searchable:!0,createPrefix:At.t("forms.set_run_result.create_prefix","New: "),onChange:this.handleNameUpdate,createAssetFromInput:this.handleCreateAssetFromInput,formClearable:!0,showLabel:!0,helpText:b.createElement(Dt.a,{i18nKey:"forms.result_name_help",values:{resultFormat:"@results".concat(n)}},"By naming the result, you can reference it later using [[resultFormat]]")}),b.createElement(na,{__className:Br.a.value,name:"Value",showLabel:!0,onChange:this.handleValueUpdate,entry:this.state.value,onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.value,{persistantFailures:t});e.setState({value:n,valid:e.state.valid&&!De(n)})},autocomplete:!0,helpText:"The value to save for this result or empty to clears it. You can use expressions, for example: @(title(input))"}),b.createElement(na,{__className:Br.a.category,name:"Category",placeholder:"Optional",showLabel:!0,onChange:this.handleCategoryUpdate,entry:this.state.category,autocomplete:!1,helpText:"An optional category for your result. For age, the value might be 17, but the category might be 'Young Adult'"})))}}]),t}(b.PureComponent),Hr=function(e,t){var n=e.flow,a=n.name,r=n.uuid;return b.createElement(b.Fragment,null,Ne([{name:a,id:r,type:pe.Flow}],3,t.config.endpoints))};Hr.contextTypes={config:Ve};var Kr=Hr,Gr=n(97),Wr=n.n(Gr),Yr=function(e,t){var n=je(e);return b.createElement("div",{className:Wr.a.node},b.createElement("div",{className:Wr.a.to},e.create_contact?"Create a new contact":e.contact_query?e.contact_query:Ne(n,3,t.config.endpoints)),b.createElement("div",{className:Wr.a.flow},Ne([{name:e.flow.name,id:e.flow.uuid,type:pe.Flow}],3,t.config.endpoints)))};Yr.contextTypes={config:Ve};var Qr=Yr,Xr=function(e){if(e.originalAction&&e.originalAction.type===fe.start_session){var t=e.originalAction;return{recipients:{value:je(t)},flow:{value:{id:t.flow.uuid,name:t.flow.name,type:pe.Flow}},startType:{value:t.create_contact?ei:t.contact_query?ti:Jr},contactQuery:{value:t.contact_query||""},valid:!0}}return{recipients:{value:[]},flow:{value:null},startType:{value:Jr},contactQuery:{value:""},valid:!1}};function Zr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var $r,Jr={label:"Select recipients manually",value:"assets"},ei={label:"Create a new contact",value:"create_contact"},ti={label:"Select recipients from a query",value:"contact_query"},ni=[Jr,ti,ei],ai=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Xr(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleRecipientsChanged",value:function(e){return this.handleUpdate({recipients:e})}},{key:"handleFlowChanged",value:function(e){var t=null;return e&&e.length>0&&(t=e[0]),this.handleUpdate({flow:t})}},{key:"handleStartTypeChanged",value:function(e){return this.handleUpdate({startType:e})}},{key:"handleContactQueryChanged",value:function(e){return this.handleUpdate({contactQuery:e})}},{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("startType")&&(n.startType={value:e.startType},e.startType!==Jr&&(n.recipients={value:[]}),e.startType!==ti&&(n.contactQuery={value:""})),e.hasOwnProperty("contactQuery")&&(n.contactQuery=an("Contact query",e.contactQuery,[cn(t&&this.state.startType.value===ti)])),e.hasOwnProperty("recipients")&&(n.recipients=an("Recipients",e.recipients,[cn(t&&this.state.startType.value===Jr)])),e.hasOwnProperty("flow")&&(n.flow=an("Flow",e.flow,[cn(t)]));var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleSave",value:function(){this.handleUpdate({recipients:this.state.recipients.value,flow:this.state.flow.value,contactQuery:this.state.contactQuery.value},!0)&&(this.props.updateAction(function(e,t){var n=t.flow.value,a={legacy_vars:Re(t.recipients.value),contacts:Te(t.recipients.value,pe.Contact),groups:Te(t.recipients.value,pe.Group),create_contact:t.startType.value===ei,flow:{name:n.name,uuid:n.id},type:fe.start_session,uuid:Se(e,fe.start_session)};return t.contactQuery.value&&(a.contact_query=t.contactQuery.value),a}(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this,t=this.props.typeConfig;return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement("div",null,b.createElement(jn,{name:"Start Type",styles:Ot,entry:this.state.startType,onChange:this.handleStartTypeChanged,options:ni})),b.createElement("p",null),b.createElement("div",null,V(this.state.startType.value===Jr)(b.createElement("div",{"data-testid":"recipients"},b.createElement(zt,{name:"Recipients",placeholder:"Choose who should be started in the flow",assets:this.props.assetStore.recipients,completion:{assetStore:this.props.assetStore,schema:this.props.completionSchema},entry:this.state.recipients,searchable:!0,multi:!0,onChange:this.handleRecipientsChanged}),b.createElement("p",null))),V(this.state.startType.value===ti)(b.createElement("div",{"data-testid":"contact_query"},b.createElement(na,{name:"Contact Query",placeholder:"household_id = @fields.household_id",onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zr(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.contactQuery,{persistantFailures:t});e.setState({contactQuery:n,valid:e.state.valid})},onChange:this.handleContactQueryChanged,entry:this.state.contactQuery,autocomplete:!0,focus:!0}),b.createElement("p",null))),b.createElement(zt,{name:"Flow",placeholder:"Choose which flow to start",assets:this.props.assetStore.flows,entry:this.state.flow,searchable:!0,onChange:this.handleFlowChanged})))}}]),t}(b.Component),ri=n(116),ii=n.n(ri),oi=function(e){var t=Object.keys(e.amounts).map(function(t){return b.createElement("div",{key:"transfer_"+t},b.createElement("div",{className:ii.a.amount},e.amounts[t]),b.createElement("div",{className:ii.a.code},t))});return b.createElement("div",null,t)},si=function(e,t){return t?B(e):e},li=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?b.createElement("div",null,"Set ",si(e,n)," to ",B(t),"."):b.createElement("div",null,"Clear ",si(e,n),".")},ci=function(e){switch(e.type){case fe.set_contact_field:return li(e.field.name,e.value,!0);case fe.set_contact_channel:return li("channel",e.channel.name);case fe.set_contact_language:return li("language",Il(e.language,e.languages));case fe.set_contact_name:return li("name",e.name)}},ui=function(e){if(e.ghost){var t=Object.keys(e.inboundConnections);if(t.length>0){var n=t[0];return{exitUUID:n,nodeUUID:e.inboundConnections[n]}}}},di=[Ae,Fe,Ue],pi=[Ae,Fe],hi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!e||function(e){return!!Be.find(function(t){return t===e})}(e)?di:pi},mi=At.t("forms.message_label","If the message response..."),fi=(At.t("forms.expression_label","If the expression..."),At.t("forms.split_by_group.label","Select the groups you'd like to split by below"));At.t("forms.split.localize_rules","Sometimes languages need special rules to route things properly. If a translation is not provided, the original rule will be used.");function vi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function gi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vi(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vi(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}!function(e){e.All_Responses="All Responses",e.No_Response="No Response",e.Any_Value="Any Value",e.Other="Other"}($r||($r={}));var _i=function(e,t,n,a){return{node:{uuid:e,actions:arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],router:t,exits:n},ui:{type:a,position:null,config:arguments.length>5&&void 0!==arguments[5]?arguments[5]:{}},inboundConnections:{}}},yi=function(e){return!!(e.router&&e.router.cases&&e.router.cases.length)},bi=function(e,t){var n=function(e){return e.node.router?e.node.router.categories:[]}(t);return e.map(function(e){var a=n.find(function(t){return t.uuid===e.category_uuid});if(Oi(e.type)&&t.ui.config&&t.ui.config.cases){var r=t.ui.config.cases[e.uuid];r&&r.arguments&&(e.arguments=r.arguments)}return{uuid:e.uuid,kase:e,categoryName:a?a.name:null,valid:!0}})},Oi=function(e){return!![ve.has_date_eq,ve.has_date_gt,ve.has_date_lt].find(function(t){return e===t})},ki=function(e,t){return e.name.toLowerCase().trim()===t.categoryName.trim().toLowerCase()},Ei=function(e){return e&&e.router&&e.router.type===a.switch?e.router:null},Ci=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=function(e,t){var n=[],a=[],r=[],i={},o=t&&t.router,s=o&&o.categories||[],l=!0,c=!1,u=void 0;try{for(var d,p=function(){var e=d.value;if(!e.categoryName||0===e.categoryName.trim().length)return"continue";Oi(e.kase.type)&&(i[e.uuid]={arguments:e.kase.arguments},e.kase.arguments=["@(datetime_add(today(), ".concat(e.kase.arguments[0],', "D"))')]);var o=n.find(function(t){return ki(t,e)});if(!o){if(!(o=s.find(function(t){return ki(t,e)}))){var l=Ei(t);if(l){var c=l.cases.find(function(t){return t.uuid===e.uuid});if(c){var u=s.find(function(e){return e.uuid===c.category_uuid});u&&(o=gi({},u,{name:e.categoryName}))}}}if(o){n.push(o);var p=t.exits.find(function(e){return o.exit_uuid===e.uuid});r.push(p)}}if(!o){var h={uuid:X()};r.push(h),o={uuid:X(),name:e.categoryName,exit_uuid:h.uuid},n.push(o)}a.push(gi({},e.kase,{category_uuid:o.uuid}))},h=e[Symbol.iterator]();!(l=(d=h.next()).done);l=!0)p()}catch(m){c=!0,u=m}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}return{cases:a,categories:n,exits:r,caseConfig:i}}(e,n),i=a;i||(i=r.categories.length>0?$r.Other:$r.All_Responses);var o=function(e,t){var n=Ei(t);if(n){var a=n.categories.find(function(e){return e.uuid===n.default_category_uuid}),r=t.exits.find(function(e){return e.uuid===a.exit_uuid});return a.name=e,{defaultCategory:a,defaultExit:r}}var i={uuid:X()};return{defaultCategory:{uuid:X(),name:e,exit_uuid:i.uuid},defaultExit:i}}(i,n),s=o.defaultCategory,l=o.defaultExit;r.categories.push(s),r.exits.push(l);var c=gi({},r,{defaultCategory:s.uuid});if(t){var u=function(e){var t=null,n=null,a=Ei(e);if(a&&a.wait&&a.wait.timeout){var r=a.wait.timeout.category_uuid;t=a.categories.find(function(e){return e.uuid===r}),n=e.exits.find(function(e){return e.uuid===t.exit_uuid})}return t||(n={uuid:X()},t={uuid:X(),name:$r.No_Response,exit_uuid:n.uuid}),{timeoutCategory:t,timeoutExit:n}}(n),d=u.timeoutCategory,p=u.timeoutExit;r.categories.push(d),r.exits.push(p),c.timeoutCategory=d.uuid}return c},wi=function(e,t,n){var r=[],i=[],o=[];if(t&&1===t.node.actions.length&&t.node.actions[0].type===e.type){var s=Ei(t.node);t.node.exits.forEach(function(e){return r.push(e)}),s.cases.forEach(function(e){return i.push(e)}),t.node.router.categories.forEach(function(e){return o.push(e)})}else r.push({uuid:X(),destination_uuid:null},{uuid:X(),destination_uuid:null}),o=[{uuid:X(),name:u.Success,exit_uuid:r[0].uuid},{uuid:X(),name:u.Failure,exit_uuid:r[1].uuid}],i=[{uuid:X(),type:n?ve.has_category:ve.has_only_text,arguments:[u.Success],category_uuid:o[0].uuid}];var l="@results."+U(e.result_name);n||(l+=".category");var c={type:a.switch,operand:l,cases:i,categories:o,default_category_uuid:o[o.length-1].uuid},d=fe.split_by_webhook;return e.type===fe.call_resthook?d=fe.split_by_resthook:e.type===fe.transfer_airtime&&(d=fe.split_by_airtime),_i(t.node.uuid,c,r,d,[e])},Si=function(e,t){return e.node.router?e.node.router.categories.filter(function(e){return e.exit_uuid===t.uuid}):[]},ji=function(e){var t=Ei(e);if(t&&t.result_name)return t.result_name;if(e.router&&e.router.type===a.random)return e.router.result_name;if(1===e.actions.length){var n=e.actions[0];if(n.type===fe.call_webhook||n.type===fe.call_resthook||n.type===fe.transfer_airtime)return n.result_name}},Ni=n(14),xi=function(e){return Ni(e,G({uuid:X()}))},Pi=function(e,t,n){if(e&&t.results){var a=function(e,t,n){var a=U(e);if(a in t){var r=t[a].references.filter(function(e){return e.nodeUUID!==n.nodeUUID||e.actionUUID!==n.actionUUID});return 0===r.length?Ni(t,{$unset:[a]}):Ni(t,Object(_.a)({},a,{references:{$set:r}}))}return t}(e,t.results.items,n);return Ni(t,{results:{items:{$set:a}}})}return t},Di=function(e,t,n){var a=U(e),r=a in t?t[a]:{name:e,id:a,type:pe.Result,references:[]};return r.references.find(function(e){return e.nodeUUID===n.nodeUUID&&e.actionUUID===n.actionUUID})||r.references.push(n),Ni(t,{$merge:Object(_.a)({},a,r)})},Ri=function(e,t,n,a){var r=e,i=bc(e,t);a&&bc(e,a);var o=Oc(i.node,n),s=i.node.exits[o].destination_uuid;return r=Ni(r,Object(_.a)({},t,{node:{exits:Object(_.a)({},o,{destination_uuid:K(a)})}})),a&&(r=Ni(r,Object(_.a)({},a,{inboundConnections:G(Object(_.a)({},n,t))}))),null!=s&&(r=Ni(r,Object(_.a)({},s,{inboundConnections:W([[n]])}))),r},Ti=function(e,t){var n=e;n[t.node.uuid]&&(n=Ui(e,t.node.uuid)),n=Ni(e,G(Object(_.a)({},t.node.uuid,t)));for(var a=0,r=Object.keys(t.inboundConnections);a<r.length;a++){var i=r[a],o=t.inboundConnections[i],s=bc(e,o),l=Oc(s.node,i);n=Ni(n,Object(_.a)({},o,{node:{exits:Object(_.a)({},l,G({destination_uuid:t.node.uuid}))}}))}return n},Ai=function(e,t,n){var r=e[t],i=function(e){if(e.router.type===a.switch){var t=e.router;return e.exits.find(function(e){return e.uuid===t.default_category_uuid})}}(r.node),o=i?i.destination_uuid:null,s=Ui(e,r.node.uuid,!1),l={node:{uuid:X(),actions:[n],exits:[{uuid:X(),destination_uuid:o}]},ui:{position:r.ui.position,type:fe.execute_actions},inboundConnections:r.inboundConnections};return s=Ti(s,l)},Ui=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=bc(e,t),r=e,i=!0,o=!1,s=void 0;try{for(var l,c=a.node.exits[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;u.destination_uuid&&(r=Ni(r,Object(_.a)({},u.destination_uuid,{inboundConnections:W([u.uuid])})))}}catch(y){o=!0,s=y}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}for(var d=0,p=Object.keys(a.inboundConnections);d<p.length;d++){var h=p[d],m=null;n&&1===a.node.exits.length&&(m=a.node.exits[0].destination_uuid);var f=a.inboundConnections[h],v=bc(e,f);if(m)try{Cc(r,f,m)}catch(b){m=null}var g=Oc(v.node,h);r=Ni(r,Object(_.a)({},f,{node:{exits:Object(_.a)({},g,{destination_uuid:K(m)})}})),m&&(bc(e,m),r=Ni(r,Object(_.a)({},m,{inboundConnections:G(Object(_.a)({},h,f))})))}return Ni(r,W([t]))},Fi=function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=n.left,i=n.top,o={left:r,top:i};return a&&(o=T(r,i)),Ni(e,Object(_.a)({},t,{ui:{position:K({left:o.left,top:o.top})}}))},Ii=function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e._ui.stickies||(e._ui.stickies={});var r=e._ui.stickies[t].position,i=r.right-r.left,o=r.bottom-r.top,s=n.left,l=n.top,c={left:s,top:l};return a&&(c=T(s,l)),Ni(e,{_ui:{stickies:Object(_.a)({},t,{position:K({left:c.left,top:c.top,right:c.left+i,bottom:c.top+o})})}})},Mi=function(e,t,n){return e._ui.stickies||(e._ui.stickies={}),Ni(e,n?{_ui:{stickies:G(Object(_.a)({},t,n))}}:{_ui:{stickies:W([t])}})},Li=n(166),zi=n.n(Li);function Bi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Vi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bi(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bi(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var qi=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Nl(n.props.nodeSettings,n.props.assetStore),Object(y.react)(Object(v.a)(n),{include:[/^get/,/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("type")&&(n.type=e.type),e.hasOwnProperty("name")&&(n.name={value:e.name}),e.hasOwnProperty("channel")&&(n.channel=an("Channel",e.channel,[cn(t)])),e.hasOwnProperty("language")&&(n.language=an("Language",e.language,[cn(t)])),e.hasOwnProperty("field")&&(n.field={value:e.field}),e.hasOwnProperty("fieldValue")&&(n.fieldValue={value:e.fieldValue,validationFailures:[]});var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handlePropertyChange",value:function(e){var t=e[0];if(t.type===pe.ContactProperty)switch(t.id){case o.Name:return this.handleUpdate({field:t,type:fe.set_contact_name,name:""});case o.Language:return this.handleUpdate({field:t,type:fe.set_contact_language});case o.Channel:return this.handleUpdate({field:t,type:fe.set_contact_channel})}return this.handleUpdate({type:fe.set_contact_field,field:t,fieldValue:""})}},{key:"handleChannelUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.handleUpdate({channel:e[0]},t)}},{key:"handleLanguageUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.handleUpdate({language:e[0]},t)}},{key:"handleFieldValueUpdate",value:function(e){return this.handleUpdate({fieldValue:e,name:""})}},{key:"handleNameUpdate",value:function(e){return this.handleUpdate({name:e,fieldValue:""})}},{key:"onUpdated",value:function(e,t){var n=t().flowContext.assetStore;this.state.field.value.type===pe.Field&&e(Ee(function(e,t,n){var a=Pc(n);return Ni(t,Object(_.a)({},e,{items:{$merge:a}}))}("fields",n,[this.state.field.value])))}},{key:"handleFieldAdded",value:function(e){this.props.addAsset("fields",e),this.handlePropertyChange([e])}},{key:"handleSave",value:function(){var e=this.state.valid;this.state.type===fe.set_contact_language&&(e=this.handleLanguageUpdate([this.state.language.value],!0)&&e),this.state.type===fe.set_contact_channel&&(e=this.handleChannelUpdate([this.state.channel.value],!0)&&e),e&&(this.props.updateAction(xl(this.props.nodeSettings,this.state),this.onUpdated),this.props.onClose(!0))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"getValueWidget",value:function(){var e=this;return this.state.type===fe.set_contact_channel?b.createElement(zt,{key:"select_channel",name:"Channel",placeholder:"Select the channel to use for this contact",assets:this.props.assetStore.channels,entry:this.state.channel,searchable:!0,valueClearable:!0,onChange:this.handleChannelUpdate}):this.state.type===fe.set_contact_language?b.createElement(zt,{key:"select_language",name:"Language",placeholder:"Select the language to use for this contact",assets:this.props.assetStore.languages,entry:this.state.language,searchable:!0,valueClearable:!0,onChange:this.handleLanguageUpdate,shouldExclude:function(e){return"base"===e.id}}):this.state.type===fe.set_contact_name?b.createElement(na,{name:"Name",placeholder:"Enter a new name for the contact",onFieldFailures:function(t){var n=Vi({},e.state.name,{persistantFailures:t});e.setState({name:n,valid:e.state.valid&&!De(n)})},onChange:this.handleNameUpdate,entry:this.state.name,autocomplete:!0,focus:!0}):b.createElement(na,{name:"Field Value",placeholder:"Enter a new value for ".concat(this.state.field.value.name),onFieldFailures:function(t){var n=Vi({},e.state.fieldValue,{persistantFailures:t});e.setState({fieldValue:n,valid:e.state.valid&&!De(n)})},onChange:this.handleFieldValueUpdate,entry:this.state.fieldValue,autocomplete:!0,focus:!0})}},{key:"handleCreateAssetFromInput",value:function(e){return{label:e,value_type:"text"}}},{key:"render",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("p",null,"Select what to update"),b.createElement(zt,{name:"Contact Field",assets:this.props.assetStore.fields,additionalOptions:hi(this.context.config.flowType),entry:this.state.field,searchable:!0,sortFunction:Pl,onChange:this.handlePropertyChange,createPrefix:"Create Contact Field: ",createAssetFromInput:this.handleCreateAssetFromInput,onAssetCreated:this.handleFieldAdded}),b.createElement("div",{className:zi.a.value},this.getValueWidget()))}}]),t}(b.Component);qi.contextTypes={config:Ve};var Hi=n(76),Ki=n.n(Hi),Gi=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleCurrencyChanged",value:function(e){this.props.onChange(this.props.index,{value:{amount:this.props.transfer.value.amount,code:e[0].id},validationFailures:this.props.transfer.validationFailures})}},{key:"handleAmountChanged",value:function(e){var t=[];isNaN(Number(e))&&t.push({message:"Invalid amount, please enter a number"}),this.props.onChange(this.props.index,{value:{amount:e,code:this.props.transfer.value.code},validationFailures:t})}},{key:"render",value:function(){var e=this,t="Transfer Amount",n="",a=null;if(this.props.transfer.value){var r=this.props.transfer.value;r.code&&(t="".concat(r.code," ").concat(t),a={id:r.code}),n=""+r.amount}var i=this.props.index>-1?b.createElement("div",{className:Ki.a.amount},b.createElement(na,{placeholder:t,name:"value",onChange:this.handleAmountChanged,entry:{value:n}})):null,o=this.props.index>-1?b.createElement("div",{className:Ki.a.remove,onClick:function(){e.props.onRemove(e.props.index)}},b.createElement("span",{className:"fe-x"})):null;return b.createElement(et,{name:"Currency",entry:this.props.transfer,__className:Ki.a.form_element},b.createElement("div",{className:Ki.a.transfer},b.createElement("div",{className:Ki.a.currency},b.createElement(zt,{styles:Ct,name:"Currency",shouldExclude:function(t){return e.props.exclude.filter(function(e){return e.value.code===t.id}).length>1},assets:this.props.currencies,entry:{value:a},searchable:!0,onChange:this.handleCurrencyChanged,placeholder:"Select a currency"})),i," ",o))}}]),t}(b.Component),Wi=n(117),Yi=n.n(Wi),Qi=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n.state={editing:n.props.value.value.trim().length>0,valid:!0},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleTextChanged",value:function(e){this.props.onChange(e)}},{key:"handleEditingChanged",value:function(){this.setState({editing:!0})}},{key:"render",value:function(){var e;return e=this.state.editing?b.createElement(na,{"data-spec":"optional-field",name:this.props.name,showLabel:!0,entry:this.props.value,onChange:this.handleTextChanged,helpText:this.props.helpText,maxLength:this.props.maxLength}):b.createElement("span",{"data-spec":"toggle-link",className:Yi.a.toggle_link,onClick:this.handleEditingChanged},this.props.toggleText),b.createElement("div",{className:Yi.a.optional_text_input},e)}}]),t}(b.Component),Xi=function(e,t){var n=!De(e)&&e.value?"."+U(e.value):"";return b.createElement(Qi,{name:At.t("forms.save_result_name","Result Name"),maxLength:64,value:e,onChange:t,toggleText:At.t("forms.save_as_title","Save as.."),helpText:b.createElement(Dt.a,{i18nKey:"forms.result_name_help",values:{resultFormat:"@results".concat(n)}},"By naming the result, you can reference it later using [[resultFormat]]")})},Zi=n(118),$i=n.n(Zi),Ji=function(e){var t=e.validationFailures.map(function(e,t){return b.createElement("div",{key:"validation_"+t,className:$i.a.error},e.message)});return b.createElement("div",{className:$i.a.errors},t)},eo=n(167),to=n.n(eo),no=function(e){var t=ao(e),n={value:"Result"},a=!1,r=[];return t&&t.type===fe.transfer_airtime&&(Object.keys(t.amounts).forEach(function(e){r.push({value:{code:e,amount:""+t.amounts[e]}})}),n={value:t.result_name},a=!0),{valid:a,amounts:r,resultName:n}},ao=function(e){var t=e.originalAction||e.originalNode.node.actions.length>0&&e.originalNode.node.actions[0];if(t.type===fe.transfer_airtime)return t},ro=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=no(e.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleSave",value:function(){var e=[];this.state.amounts.forEach(function(t,n){0===t.value.amount.trim().length&&e.push(n)});var t=!this.state.amounts.find(function(e){return(e.validationFailures||[]).length>0});t&&((t=void 0!==this.state.amounts.find(function(e){return e.value.amount.trim().length>0}))||this.setState({valid:!1,validationFailures:[{message:"At least one amount to transfer is required"}]})),t&&(this.props.updateRouter(function(e,t){var n=X(),a=ao(e);a&&(n=a.uuid);var r={};t.amounts.forEach(function(e){e.value.amount.trim().length>0&&(r[e.value.code]=Number(e.value.amount))});var i={uuid:n,type:fe.transfer_airtime,amounts:r,result_name:t.resultName.value};return wi(i,e.originalNode,!0)}(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[on,fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"getButtons",value:function(){var e=this;return{primary:{name:"Ok",onClick:this.handleSave},secondary:{name:"Cancel",onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleRemoved",value:function(e){var t=Yt()(this.state.amounts,{$splice:[[e,1]]});this.setState({amounts:t})}},{key:"handleTransferChanged",value:function(e,t){var n=this.state.amounts;n=e>-1?Yt()(this.state.amounts,{$merge:Object(_.a)({},e,t)}):Yt()(this.state.amounts,{$push:[t]}),this.setState({amounts:n,validationFailures:[]})}},{key:"renderAmount",value:function(e,t){return b.createElement(Gi,{key:"currency_"+e,exclude:this.state.amounts,currencies:this.props.assetStore.currencies,transfer:t,index:e,onChange:this.handleTransferChanged,onRemove:this.handleRemoved})}},{key:"renderAmounts",value:function(){var e=this,t=this.state.amounts.map(function(t,n){return e.renderAmount(n,t)});return b.createElement("div",null,t,this.renderAmount(-1,{value:{code:null,amount:""}}))}},{key:"render",value:function(){var e=this.props.typeConfig,t=this.state.validationFailures?b.createElement(Ji,{validationFailures:this.state.validationFailures}):null;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),this.renderAmounts(),t,b.createElement("div",{className:to.a.result_name},Xi(this.state.resultName,this.handleUpdateResultName)))}}]),t}(b.PureComponent),io=n(168),oo=n.n(io),so=[{type:ve.has_top_intent,verboseName:At.t("operators.has_top_intent","has top intent"),operands:2,visibility:Be},{type:ve.has_intent,verboseName:At.t("operators.has_intent","has intent"),operands:2,visibility:Be}],lo=[{type:ve.has_any_word,verboseName:At.t("operators.has_any_word","has any of the words"),operands:1,visibility:ze},{type:ve.has_all_words,verboseName:At.t("operators.has_all_words","has all of the words"),operands:1,visibility:ze},{type:ve.has_phrase,verboseName:At.t("operators.has_phrase","has the phrase"),operands:1,visibility:ze},{type:ve.has_only_phrase,verboseName:At.t("operators.has_only_phrase","has only the phrase"),operands:1,visibility:ze},{type:ve.has_beginning,verboseName:At.t("operators.has_beginning","starts with"),operands:1},{type:ve.has_text,verboseName:At.t("operators.has_text","has some text"),operands:0,categoryName:"Has Text",visibility:ze},{type:ve.has_number,verboseName:At.t("operators.has_number","has a number"),operands:0,categoryName:"Has Number"},{type:ve.has_number_between,verboseName:At.t("operators.has_number_between","has a number between"),operands:2},{type:ve.has_number_lt,verboseName:At.t("operators.has_number_lt","has a number below"),operands:1},{type:ve.has_number_lte,verboseName:At.t("operators.has_number_lte","has a number at or below"),operands:1},{type:ve.has_number_eq,verboseName:At.t("operators.has_number_eq","has a number equal to"),operands:1},{type:ve.has_number_gte,verboseName:At.t("operators.has_number_gte","has a number at or above"),operands:1},{type:ve.has_number_gt,verboseName:At.t("operators.has_number_gt","has a number above"),operands:1},{type:ve.has_date,verboseName:At.t("operators.has_date","has a date"),operands:0,categoryName:At.t("operators.has_date_category","Has Date"),visibility:ze},{type:ve.has_date_lt,verboseName:At.t("operators.has_date_lt","has a date before"),operands:1,visibility:ze},{type:ve.has_date_eq,verboseName:At.t("operators.has_date_eq","has a date equal to"),operands:1,visibility:ze},{type:ve.has_date_gt,verboseName:At.t("operators.has_date_gt","has a date after"),operands:1,visibility:ze},{type:ve.has_time,verboseName:At.t("operators.has_time","has a time"),operands:0,categoryName:"Has Time",visibility:ze},{type:ve.has_group,verboseName:At.t("operators.has_group","is in the group"),operands:1,visibility:Ie},{type:ve.has_category,verboseName:At.t("operators.has_category","has the category"),operands:0,visibility:Ie},{type:ve.has_phone,verboseName:At.t("operators.has_phone","has a phone number"),operands:0,categoryName:At.t("operators.has_phone_category","Has Phone")},{type:ve.has_email,verboseName:At.t("operators.has_email","has an email"),operands:0,categoryName:At.t("operators.has_email_category","Has Email"),visibility:ze},{type:ve.has_state,verboseName:At.t("operators.has_state","has state"),operands:0,categoryName:At.t("operators.has_state_category","Has State")},{type:ve.has_district,verboseName:At.t("operators.has_district","has district"),operands:1,categoryName:At.t("operators.has_district_category","Has District")},{type:ve.has_ward,verboseName:At.t("operators.has_ward","has ward"),operands:2,categoryName:At.t("operators.has_ward_category","Has Ward")},{type:ve.has_error,verboseName:At.t("operators.has_error","has an error"),operands:0,categoryName:At.t("operators.has_error_category","Has Error"),visibility:Ie},{type:ve.has_value,verboseName:At.t("operators.has_value","is not empty"),operands:0,categoryName:At.t("operators.has_value_category","Not Empty")},{type:ve.has_pattern,verboseName:At.t("operator.has_pattern","matches regex"),operands:1}],co=[].concat(lo,so).reduce(function(e,t){return e[t.type]=t,e},{}),uo=function(e){return co[e]},po=n(35),ho=n.n(po),mo=function(e){var t=e.kase.arguments&&e.kase.arguments.length>=1?e.kase.arguments[0]:"",n=e.kase.arguments&&2===e.kase.arguments.length?e.kase.arguments[1]:"";return{errors:[],operatorConfig:uo(e.kase.type),argument:{value:t},min:{value:t},max:{value:n},state:{value:t},district:{value:n},intent:{value:t?{label:t,value:t}:null},confidence:{value:n},categoryName:{value:e.categoryName||""},categoryNameEdited:!!e.categoryName,valid:!0}},fo=function(e){var t="";return e.indexOf("_lt")>-1?t=e.indexOf("date")>-1?"Before ":e.indexOf("lte")>-1?"<= ":"< ":e.indexOf("_gt")>-1&&(t=e.indexOf("date")>-1?"After ":e.indexOf("gte")>-1?">= ":">"),t},vo=function(e){var t,n,a,r=e.exitEdited&&e.exitName?[on]:[],i={operatorConfig:e.operatorConfig,district:{value:"",validationFailures:[]},state:{value:"",validationFailures:[]},min:{value:"",validationFailures:[]},max:{value:"",validationFailures:[]},argument:{value:"",validationFailures:[]},intent:{value:null,validationFailures:[]},confidence:{value:"",validationFailures:[]}};if(e.operatorConfig.operands>0){switch(e.operatorConfig.type){case ve.has_number_eq:case ve.has_number_gt:case ve.has_number_gte:case ve.has_number_lt:case ve.has_number_lte:r.push(vn);break;case ve.has_date_eq:case ve.has_date_lt:case ve.has_date_gt:r.push(mn);break;case ve.has_pattern:r.push(sn)}if(e.operatorConfig.type===ve.has_number_between)i.min=an("Minimum value",e.min||"",r.concat([mn,(n=parseFloat(e.max),a="the maximum",function(e,t){return"string"===typeof t&&parseFloat(t)>=n?{value:t,failures:[{message:"".concat(e," must be a less than ").concat(a)}]}:{failures:[],value:t}})])),i.max=an("Maximum value",e.max||"",r.concat([mn,ln(parseFloat(e.min),"the minimum")]));else if(e.operatorConfig.type===ve.has_district)i.argument=an("State",e.argument||"",r.concat([]));else if(e.operatorConfig.type===ve.has_ward)i.state=an("State",e.state||"",r.concat([])),i.district=an("District",e.district||"",r.concat([]));else if(e.operatorConfig.type===ve.has_top_intent||e.operatorConfig.type===ve.has_intent){var o=[(t=e.classifier,function(e,n){if("object"===typeof n){var a=n;return a&&t&&t.content&&!t.content.intents.find(function(e){return e===a.value})?{value:n,failures:[{message:"".concat(a.value," is not a valid intent for ").concat(t.name)}]}:{failures:[],value:n}}return{failures:[],value:n}})];e.confidence&&o.push(on),i.intent=an("Intent",e.intent,o),i.confidence=an("Confidence",e.confidence||"",r.concat(e.intent?[mn,on]:[mn]))}else i.argument=an("Value",e.argument||"",r)}return i.categoryNameEdited=!!e.exitEdited,i.categoryName=an("Category",i.categoryNameEdited?e.exitName:go(i),i.argument.value||i.min.value&&i.max.value||i.state.value&&i.district.value?[on]:[]),i.valid=0===i.state.validationFailures.length&&0===i.district.validationFailures.length&&0===i.min.validationFailures.length&&0===i.max.validationFailures.length&&0===i.argument.validationFailures.length&&0===i.intent.validationFailures.length&&0===i.confidence.validationFailures.length&&0===i.categoryName.validationFailures.length,i},go=function(e){if(e.categoryNameEdited)return e.categoryName.value;if(0===e.operatorConfig.operands)return e.operatorConfig.categoryName;if((e.operatorConfig.type===ve.has_intent||e.operatorConfig.type===ve.has_top_intent)&&e.intent.value)return F(e.intent.value.label.replace("_"," "));if(e.operatorConfig.type===ve.has_number_between&&e.min.value&&e.max.value)return"".concat(e.min.value," - ").concat(e.max.value);if(Oi(e.operatorConfig.type)){var t=parseInt(e.argument.value,10);if(!isNaN(t)){var n=e.operatorConfig.type===ve.has_date_eq?"Today":"today",a=t<0?" - ":" + ",r=1===Math.abs(t)?" day":" days";return fo(e.operatorConfig.type)+n+a+Math.abs(t)+r}}if(e.argument&&e.argument.value){var i=fo(e.operatorConfig.type),o=e.argument.value.match(/\w+/g);if(o&&o.length>0){var s=Object(k.a)(o,1)[0];return i+F(s)}return i+F(e.argument.value)}return""};function _o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var yo=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).operators=void 0,Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^get/]}),n.state=mo(e),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=vo({operatorConfig:this.state.operatorConfig,argument:this.state.argument.value,min:this.state.min.value,max:this.state.max.value,intent:this.state.intent.value,confidence:this.state.confidence.value,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited,classifier:this.props.classifier});this.setState(e,this.handleChange)}},{key:"componentDidUpdate",value:function(e){if(this.props.classifier&&this.props.classifier!==e.classifier&&this.state.intent.value){var t=vo({operatorConfig:this.state.operatorConfig,argument:this.state.argument.value,min:this.state.min.value,max:this.state.max.value,intent:this.state.intent.value,confidence:this.state.confidence.value,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited,classifier:this.props.classifier});this.setState(t,this.handleChange)}}},{key:"getOperators",value:function(){var e=this.props.operators||lo;return void 0===this.operators&&(this.operators=function(e,t){return Bt(e,t)}(e,this.context.config)),this.operators}},{key:"getArgumentArray",value:function(){return 0===this.state.operatorConfig.operands?[]:this.state.operatorConfig.type===ve.has_intent||this.state.operatorConfig.type===ve.has_top_intent?this.state.intent.value?[this.state.intent.value.value,this.state.confidence.value]:["",this.state.confidence.value]:this.state.operatorConfig.type===ve.has_number_between?[this.state.min.value,this.state.max.value]:this.state.operatorConfig.type===ve.has_ward?[this.state.state.value,this.state.district.value]:[this.state.argument.value]}},{key:"handleOperatorChanged",value:function(e){var t=this,n=vo({operatorConfig:e,argument:this.state.argument.value,min:this.state.min.value,max:this.state.max.value,intent:this.state.intent.value,confidence:this.state.confidence.value,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited,classifier:this.props.classifier});this.setState(n,function(){return t.handleChange()})}},{key:"handleArgumentChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,argument:e,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited});this.setState(n,function(){return t.handleChange()})}},{key:"handleDistrictChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,argument:this.state.argument.value,state:this.state.state.value,district:e,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited});this.setState(n,function(){return t.handleChange()})}},{key:"handleStateChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,argument:this.state.argument.value,district:this.state.district.value,state:e,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited});this.setState(n,function(){return t.handleChange()})}},{key:"handleIntentChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,intent:e,confidence:this.state.confidence.value||".9",exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited,classifier:this.props.classifier});this.setState(n,function(){return t.handleChange()})}},{key:"handleConfidenceChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,intent:this.state.intent.value,confidence:e,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited,classifier:this.props.classifier});this.setState(n,function(){return t.handleChange()})}},{key:"handleMinChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,min:e,max:this.state.max.value,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited});this.setState(n,function(){return t.handleChange()})}},{key:"handleMaxChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,min:this.state.min.value,max:e,exitName:this.state.categoryName.value,exitEdited:this.state.categoryNameEdited});this.setState(n,function(){return t.handleChange()})}},{key:"handleExitChanged",value:function(e){var t=this,n=vo({operatorConfig:this.state.operatorConfig,state:this.state.state.value,district:this.state.district.value,argument:this.state.argument.value,min:this.state.min.value,max:this.state.max.value,intent:this.state.intent.value,confidence:this.state.confidence.value,classifier:this.props.classifier,exitName:e,exitEdited:!0});this.setState(n,function(){return t.handleChange()})}},{key:"handleRemoveClicked",value:function(){this.props.onRemove(this.props.kase.uuid)}},{key:"getCaseProps",value:function(){return{uuid:this.props.kase.uuid,categoryName:this.state.categoryName.value,kase:{arguments:this.getArgumentArray(),type:this.state.operatorConfig.type,uuid:this.props.kase.uuid,category_uuid:this.state.categoryNameEdited?null:this.props.kase.category_uuid},valid:this.state.valid}}},{key:"handleChange",value:function(){this.state.categoryName.value||(this.state.operatorConfig.type===ve.has_number_between?!this.state.min.value&&this.state.max.value:this.state.argument.value),this.props.onChange(this.getCaseProps())}},{key:"handleIntentMenuOpened",value:function(){this.setState({intent:{value:this.state.intent.value}})}},{key:"handleIntentMenuClosed",value:function(){var e=this;window.setTimeout(function(){e.handleIntentChanged(e.state.intent.value)},0)}},{key:"renderArguments",value:function(){var e=this;if(this.state.operatorConfig.operands>0){if(this.state.operatorConfig.operands>1){if(this.state.operatorConfig.type===ve.has_number_between)return b.createElement(b.Fragment,null,b.createElement(na,{name:"arguments",onChange:this.handleMinChanged,entry:this.state.min}),b.createElement("span",{className:ho.a.divider,"data-draggable":!0},"and"),b.createElement(na,{name:"arguments",onChange:this.handleMaxChanged,entry:this.state.max}));if(this.state.operatorConfig.type===ve.has_intent||this.state.operatorConfig.type===ve.has_top_intent){var t=[];return this.props.classifier&&this.props.classifier.content&&(t=this.props.classifier.content.intents.map(function(e){return{label:e,value:e}})),b.createElement(b.Fragment,null,b.createElement("div",{style:{width:"114px"}},b.createElement(jn,{styles:Ct,name:"Intent",entry:this.state.intent,onChange:this.handleIntentChanged,options:t,onMenuOpen:this.handleIntentMenuOpened,onMenuClose:this.handleIntentMenuClosed,placeholder:""})),b.createElement("span",{className:ho.a.divider,"data-draggable":!0},"above"),b.createElement("div",{style:{width:"34px"}},b.createElement(na,{name:"confidence",onChange:this.handleConfidenceChanged,entry:this.state.confidence,placeholder:".9"})))}return b.createElement(b.Fragment,null,b.createElement(na,{name:"State",placeholder:"State",onChange:this.handleStateChanged,entry:this.state.state}),b.createElement("span",{className:ho.a.divider,"data-draggable":!0},"and"),b.createElement(na,{name:"District",placeholder:"District",onChange:this.handleDistrictChanged,entry:this.state.district}))}return Oi(this.state.operatorConfig.type)?b.createElement(b.Fragment,null,b.createElement("span",{className:ho.a.divider,"data-draggable":!0},"today +"," "),b.createElement(na,{__className:ho.a.relative_date,name:"arguments",onChange:this.handleArgumentChanged,entry:this.state.argument,autocomplete:!1}),b.createElement("span",{className:ho.a.divider},"days")):b.createElement(na,{name:"arguments",onChange:this.handleArgumentChanged,entry:this.state.argument,placeholder:this.state.operatorConfig.type===ve.has_district?"State":"",onFieldFailures:function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_o(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_o(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.state.argument,{persistantFailures:t});e.setState({argument:n,valid:e.state.valid&&!De(n)})},autocomplete:!0})}return null}},{key:"render",value:function(){return b.createElement(et,{"data-spec":"case-form",name:this.props.name,__className:ho.a.group,kaseError:this.state.errors.length>0},b.createElement("div",{className:"".concat(ho.a.kase," ").concat(ho.a[this.state.operatorConfig.type]),"data-draggable":!0},b.createElement("span",{className:"fe-chevrons-expand ".concat(ho.a.dnd_icon),"data-draggable":!0}),b.createElement("div",{className:ho.a.choice+" select-medium"},b.createElement(Vt.a,{className:I(0),styles:Ct,"data-spec":"operator-list",isClearable:!1,menuPlacement:"auto",options:this.getOperators(),getOptionLabel:function(e){return e.verboseName},getOptionValue:function(e){return e.type},isSearchable:!1,name:"operator",onChange:this.handleOperatorChanged,value:this.state.operatorConfig})),b.createElement("div",{className:this.state.operatorConfig.operands>1?ho.a.multi_operand:ho.a.single_operand},this.renderArguments()),b.createElement("div",{className:ho.a.categorize_as,"data-draggable":!0},"categorize as"),b.createElement("div",{className:ho.a.category},b.createElement(na,{name:"exitName",onChange:this.handleExitChanged,entry:this.state.categoryName,maxLength:36,showInvalid:M(this.state.errors,[/category/])})),b.createElement("span",{"data-testid":"remove-case-"+this.props.kase.uuid,className:"fe-x ".concat(ho.a.remove_icon),onClick:this.handleRemoveClicked})))}}]),t}(b.Component);yo.contextTypes={config:Ve};var bo,Oo=n(119),ko=n(120),Eo=n.n(ko);!function(e){e.move="move",e.pointer="pointer"}(bo||(bo={}));var Co=function(e){function t(e){var n,a=this;Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).sortableItem=Object(Oo.SortableElement)(function(e){var t=e.value;return b.createElement("div",{className:Eo.a.kase},b.createElement(yo,Object.assign({key:t.uuid},t,{onRemove:n.handleRemoveCase,onChange:n.handleUpdateCase,operators:n.props.operators,classifier:n.props.classifier})))}),n.sortableList=Object(Oo.SortableContainer)(function(e){var t=e.items;return b.createElement("div",{className:Eo.a.case_list},t.map(function(e,t){return b.createElement(a.sortableItem,{key:"item-".concat(t),index:t,value:e,disabled:t===n.state.currentCases.length-1,shouldCancelStart:function(e){return console.log(e),!0}})}))}),Object(y.react)(Object(v.a)(n),{include:[/^handle/]});var r=n.props.cases;return n.hasEmptyCase(r)||r.push(n.createEmptyCase()),n.state={currentCases:r,valid:!0},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"createEmptyCase",value:function(){return this.props.createEmptyCase?this.props.createEmptyCase():function(){var e=X();return{uuid:e,kase:{uuid:e,type:ve.has_any_word,arguments:[""],category_uuid:null},categoryName:"",valid:!0}}()}},{key:"handleUpdate",value:function(e){var t=this,n={},a=!1;e.hasOwnProperty("caseProps")&&(n.currentCases=[e.caseProps],a=!0,e.caseProps.valid||(n.valid=!1));var r=[];e.hasOwnProperty("removeCase")&&(r=[{currentCases:[e.removeCase]}],a=!0),this.setState(function(e){var a=Qt(e,n,r);return t.props.onCasesUpdated(a.currentCases),a},function(){a&&(t.hasEmptyCase(t.state.currentCases)||t.handleUpdate({caseProps:t.createEmptyCase()}))})}},{key:"hasEmptyCase",value:function(e){return null!=e.find(function(e){return 0===e.categoryName.trim().length})}},{key:"handleRemoveCase",value:function(e){return this.handleUpdate({removeCase:{uuid:e}})}},{key:"handleUpdateCase",value:function(e){this.handleUpdate({caseProps:e})}},{key:"handleSortEnd",value:function(e){var t=this,n=e.oldIndex,a=e.newIndex;this.setState(function(e){var r=e.currentCases;return{currentCases:oo()(r,n,a===t.state.currentCases.length-1?a-1:a)}},function(){t.props.onCasesUpdated(t.state.currentCases)})}},{key:"render",value:function(){return b.createElement(b.Fragment,null,b.createElement(this.sortableList,{items:this.state.currentCases,onSortEnd:this.handleSortEnd,shouldCancelStart:function(e){return!(e.target instanceof HTMLElement)||!e.target.dataset.draggable}}))}}]),t}(b.Component);Co.contextTypes={config:Ve};var wo=n(169),So=n.n(wo),jo='@(json(object(\n  "contact", object(\n    "uuid", contact.uuid, \n    "name", contact.name, \n    "urn", contact.urn\n  ),\n  "flow", object(\n    "uuid", run.flow.uuid, \n    "name", run.flow.name\n  ),\n  "results", foreach_value(results, extract_object, "value", "category")\n)))';function No(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var xo=function(e){var t=[],n={value:""};if(Sl(e.originalNode)===fe.wait_for_digits){var a=e.originalNode.node.router;a&&(yi(e.originalNode.node)&&(t=bi(a.cases,e.originalNode)),n={value:a.result_name||""})}return{cases:t,resultName:n,valid:!0}},Po=function(e,t){var n=Ci(t.cases,!1,e.originalNode.node),o=n.cases,s=n.exits,l=n.categories,c=n.defaultCategory,u=n.caseConfig,d={};t.resultName.value&&(d.result_name=t.resultName.value);var p=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?No(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):No(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.switch,default_category_uuid:c,categories:l,cases:o,operand:"@input.text",wait:{type:r.msg,hint:{type:i.digits}}},d);return _i(e.originalNode.node.uuid,p,s,fe.wait_for_response,[],{cases:u})},Do=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=xo(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleCasesUpdated",value:function(e){this.setState({cases:e})}},{key:"handleSave",value:function(){this.state.valid&&(this.props.updateRouter(Po(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderEdit",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("p",{className:So.a.lead_in},"If the keypad entry before the # symbol.."),b.createElement(Co,{"data-spec":"cases",cases:this.state.cases,onCasesUpdated:this.handleCasesUpdated}),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component);function Ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var To,Ao=function(e){var t=[],n={value:""},a="@input.text";if(e.originalNode&&Sl(e.originalNode)===fe.split_by_expression){var r=e.originalNode.node.router;r&&(yi(e.originalNode.node)&&(t=bi(r.cases,e.originalNode)),n={value:r.result_name||""}),a=r.operand}return{cases:t,resultName:n,operand:{value:a},valid:!0}},Uo=function(e,t){var n=Ci(t.cases,!1,e.originalNode.node),r=n.cases,i=n.exits,o=n.defaultCategory,s=n.caseConfig,l=n.categories,c={};t.resultName.value&&(c.result_name=t.resultName.value);var u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ro(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ro(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.switch,default_category_uuid:o,categories:l,cases:r,operand:t.operand.value},c);return _i(e.originalNode.node.uuid,u,i,fe.split_by_expression,[],{cases:s})};!function(e){e.args="args",e.min="min",e.max="max",e.exit="exit"}(To||(To={}));var Fo=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Ao(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleOperandUpdated",value:function(e){this.setState({operand:an("Operand",e,[on])})}},{key:"handleCasesUpdated",value:function(e){this.setState({cases:e})}},{key:"handleSave",value:function(){this.state.valid&&(this.props.updateRouter(Uo(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderEdit",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("p",null,"If the expression..."),b.createElement(na,{name:"Operand",showLabel:!1,autocomplete:!0,onChange:this.handleOperandUpdated,entry:this.state.operand}),b.createElement(Co,{"data-spec":"cases",cases:this.state.cases,onCasesUpdated:this.handleCasesUpdated}),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component),Io=n(121),Mo=n.n(Io);function Lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var zo,Bo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return[].concat(Object(Nn.a)(hi(e)),Object(Nn.a)(Ol.map(function(e){return{name:e.name,id:e.scheme,type:pe.Scheme}})))},Vo=function(e,t){var n=[],a={value:""},r=null,i=Sl(e.originalNode);if(e.originalNode&&i===fe.split_by_contact_field){var o=e.originalNode.node.router;o&&(yi(e.originalNode.node)&&(n=bi(o.cases,e.originalNode)),a={value:o.result_name||""});var s=e.originalNode.ui.config.operand;if(t.fields&&s.id in t.fields.items){var l=t.fields.items[s.id].name;r={id:s.id,type:s.type,name:l}}r||(r=Bo().find(function(e){return e.id===s.id}))}return r||(r=Ae),{cases:n,resultName:a,field:{value:r},valid:!0}},qo=function(e,t){var n=Ci(t.cases,!1,e.originalNode.node),r=n.cases,i=n.exits,o=n.defaultCategory,s=n.caseConfig,l=n.categories,c={};t.resultName.value&&(c.result_name=t.resultName.value);var u="@input.text",d=t.field.value;u=d.type===pe.Scheme?"@(urn_parts(urns.".concat(d.id,").path)"):d.type===pe.Field?"@contact.fields.".concat(d.id):"@contact.".concat(d.id);var p=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lo(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lo(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.switch,default_category_uuid:o,cases:r,categories:l,operand:u},c);return _i(e.originalNode.node.uuid,p,i,fe.split_by_contact_field,[],{operand:{id:d.id,type:d.type,name:d.name},cases:s})};!function(e){e.args="args",e.min="min",e.max="max",e.exit="exit"}(zo||(zo={}));var Ho=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Vo(n.props.nodeSettings,n.props.assetStore),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleFieldChanged",value:function(e){this.setState({field:{value:e[0]}})}},{key:"handleCasesUpdated",value:function(e){this.setState({cases:e})}},{key:"handleSave",value:function(){this.state.valid&&(this.props.updateRouter(qo(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderEdit",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("div",{className:Mo.a.lead_in},"If the contact's",b.createElement("div",{className:"".concat(Mo.a.field_select," select-small")},b.createElement(zt,{name:"Contact Field",styles:Ct,assets:this.props.assetStore.fields,additionalOptions:Bo(this.context.config.flowType),entry:this.state.field,searchable:!0,sortFunction:Pl,onChange:this.handleFieldChanged}))),b.createElement(Co,{"data-spec":"cases",cases:this.state.cases,onCasesUpdated:this.handleCasesUpdated}),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component);Ho.contextTypes={assetService:Ve,config:Ve};var Ko,Go=function(e){var t={groups:{value:[]},resultName:{value:""},valid:!1};return Sl(e.originalNode)===fe.split_by_groups&&(t.groups.value=Wo(e.originalNode.node),t.resultName={value:e.originalNode.node.router.result_name||""},t.valid=!0),t},Wo=function(e){var t=[],n=Ei(e);return n&&(t=n.cases.map(function(e){return{name:n.categories.find(function(t){return t.uuid===e.category_uuid}).name,id:e.arguments[0],type:pe.Group}})),t},Yo=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){var t=e.name,n=e.id;return{uuid:n,kase:{uuid:X(),type:ve.has_group,arguments:[n,t],category_uuid:""},categoryName:t,valid:!0}})},Qo=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Go(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleGroupsChanged",value:function(e){this.handleUpdate({groups:e})}},{key:"handleUpdateResultName",value:function(e){this.handleUpdate({resultName:e})}},{key:"handleUpdate",value:function(e){var t={};e.hasOwnProperty("groups")&&(t.groups=an("Groups",e.groups,[on])),e.hasOwnProperty("resultName")&&(t.resultName={value:e.resultName});var n=Qt(this.state,t);return this.setState(n),n.valid}},{key:"handleSave",value:function(){this.state.valid&&(this.props.updateRouter(function(e,t){var n=Yo(t.groups.value),r=Ci(n,!1,e.originalNode.node),i=r.cases,o=r.exits,s=r.defaultCategory,l=r.caseConfig,c=r.categories,u={type:a.switch,cases:i,categories:c,default_category_uuid:s,operand:"@contact.groups",result_name:t.resultName.value};return _i(e.originalNode.node.uuid,u,o,fe.split_by_groups,[],{cases:l})}(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("p",null,fi),b.createElement(zt,{name:"Groups",assets:this.props.assetStore.groups,entry:this.state.groups,searchable:!0,onChange:this.handleGroupsChanged,multi:!0}),Xi(this.state.resultName,this.handleUpdateResultName))}}]),t}(b.Component);Qo.contextTypes={endpoints:Ve,assetService:Ve},function(e){e[e.Category=0]="Category",e[e.Case=1]="Case"}(Ko||(Ko={}));var Xo=function(e,t){var n=[],a=e.originalNode.node.router.categories;t===Ko.Case&&(a=function(e){var t=Sl(e);return t===fe.wait_for_response||t===fe.split_by_expression}(e.originalNode)?e.originalNode.node.router.cases:[]);var r=!0,i=!1,o=void 0;try{for(var s,l=function(){var t=s.value,a=e.localizations.filter(function(e){return e.getObject().uuid===t.uuid}),r=Object(k.a)(a,1)[0];r.isLocalized()?n.push(r.getObject()):n.push({uuid:t.uuid})},c=a[Symbol.iterator]();!(r=(s=c.next()).done);r=!0)l()}catch(u){i=!0,o=u}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n},Zo=n(63),$o=n.n(Zo),Jo=function(e){function t(e){var n;Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e));var a=Xo(e.nodeSettings,Ko.Category),r=Xo(e.nodeSettings,Ko.Case);return n.state={categories:a,cases:r,valid:!0},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdate",value:function(e){var t={};e.hasOwnProperty("category")&&(t.categories=[e.category]),e.hasOwnProperty("kase")&&(t.cases=[e.kase]);var n=Qt(this.state,t);return this.setState(n),n.valid}},{key:"handleUpdateCategoryName",value:function(e,t){return e.name=t,this.handleUpdate({category:e})}},{key:"handleUpdateCaseArgument",value:function(e,t){return e.arguments=[t],this.handleUpdate({kase:e})}},{key:"handleSave",value:function(){var e=this.state.categories.map(function(e){return e.name?{uuid:e.uuid,translations:{name:e.name}}:{uuid:e.uuid}});e.push.apply(e,Object(Nn.a)(this.state.cases.map(function(e){return e.arguments?{uuid:e.uuid,translations:{arguments:e.arguments}}:{uuid:e.uuid}}))),this.props.updateLocalizations(this.props.language.id,e),this.props.onClose(!1)}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderCases",value:function(){var e=this;return this.state.cases.map(function(t){var n,a,r=(n=e.props.nodeSettings,a=t.uuid,n.originalNode.node.router.cases.find(function(e){return e.uuid===a})),i=uo(r.type).verboseName,o=Object(k.a)(r.arguments,1)[0],s="";return t.arguments&&t.arguments.length>0&&(s=t.arguments[0]),b.createElement("div",{key:"translate_".concat(t.uuid),"data-spec":"operator-field",className:$o.a.translating_operator_container},b.createElement("div",{"data-spec":"verbose-name",className:$o.a.translating_operator},i),b.createElement("div",{"data-spec":"argument-to-translate",className:$o.a.translating_from},o),b.createElement("div",{className:$o.a.translating_to},b.createElement(na,{"data-spec":"localize-case",name:t.uuid,placeholder:"".concat(e.props.language.name," Translation"),showLabel:!1,onChange:function(n){return e.handleUpdateCaseArgument(t,n)},entry:{value:s}})))})}},{key:"renderCategories",value:function(){var e=this;return this.state.categories.map(function(t){var n,a,r=(n=e.props.nodeSettings,a=t.uuid,n.originalNode.node.router.categories.find(function(e){return e.uuid===a})),i="".concat(e.props.language.name," Translation");return t.name||(t.name=""),b.createElement("div",{key:t.uuid,className:$o.a.translating_category},b.createElement("div",{"data-spec":"category-name",className:$o.a.translating_from},r.name),b.createElement("div",{className:$o.a.translating_to},b.createElement(na,{"data-spec":"localize-category",name:t.name,placeholder:i,showLabel:!1,entry:{value:t.name},onChange:function(n){return e.handleUpdateCategoryName(t,n)}})))})}},{key:"render",value:function(){var e=Ra(this.props.nodeSettings),t=[];return this.state.cases.length>0&&t.push({name:"Rule Translations",body:b.createElement(b.Fragment,null,b.createElement("p",{"data-spec":"instructions"},"Sometimes languages need special rules to route things properly. If a translation is not provided, the original rule will be used."),this.renderCases())}),b.createElement(ce,{title:"".concat(this.props.language.name," Category Names"),headerClass:e.type,buttons:this.getButtons(),tabs:t},b.createElement("p",{"data-spec":"instructions"},"When category names are referenced later in the flow, the appropriate language for the category will be used. If no translation is provided, the original text will be used."),this.renderCategories())}}]),t}(b.Component);function es(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var ts=function(e){for(var t={value:""},n=[],a=0;a<10;a++)n.push("");if(Sl(e.originalNode)===fe.wait_for_menu){var r=e.originalNode.node.router,i=!0,o=!1,s=void 0;try{for(var l,c=function(){var t=l.value,a=parseInt(t.arguments[0],10)-1;-1===a&&(a=n.length-1),n[a]=e.originalNode.node.router.categories.find(function(e){return e.uuid===t.category_uuid}).name},u=r.cases[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)c()}catch(d){o=!0,s=d}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}t={value:r.result_name||""}}return{resultName:t,menu:n,valid:!0}},ns=function(e,t){var n={};t.resultName.value&&(n.result_name=t.resultName.value);var o=[];Sl(e.originalNode)===fe.wait_for_menu&&(o=e.originalNode.node.router.cases);var s=as(t.menu,o),l=Ci(s,!1,e.originalNode.node),c=l.cases,u=l.exits,d=l.defaultCategory,p=l.caseConfig,h=l.categories,m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?es(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):es(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.switch,operand:"@input.text",default_category_uuid:d,cases:c,categories:h,wait:{type:r.msg,hint:{type:i.digits,count:1}}},n);return _i(e.originalNode.node.uuid,m,u,fe.wait_for_response,[],{cases:p})},as=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.map(function(e,n){var a=9===n?0:n+1,r=t.find(function(e){return e.arguments[0]===""+a})||{uuid:X(),arguments:[""+a],type:ve.has_number_eq,category_uuid:""};return{uuid:r.uuid,kase:r,categoryName:e,valid:!0}}).filter(function(e){return e.categoryName.trim().length>0})},rs=n(84),is=n.n(rs),os=n(14),ss=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=ts(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleSave",value:function(){this.props.updateRouter(ns(this.props.nodeSettings,this.state)),this.props.onClose(!1)}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleMenuChanged",value:function(e,t){var n=os(this.state.menu,Object(_.a)({},e,{$set:t}));this.setState({menu:n})}},{key:"renderOption",value:function(e){var t=this;return b.createElement("div",{key:"menuoption-"+e,className:is.a.menu_option},b.createElement("div",{className:is.a.digit},9===e?0:e+1),b.createElement("div",{className:is.a.category},b.createElement(na,{name:"Menu "+e,entry:{value:this.state.menu[e]},onChange:function(n){t.handleMenuChanged(e,n)}})))}},{key:"renderMenu",value:function(){for(var e=[],t=0;t<10;t++)e.push(this.renderOption(t));return e}},{key:"renderEdit",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("div",{className:is.a.menu},this.renderMenu()),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component);function ls(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}ss.contextTypes={assetService:Ve};var cs,us=Z(2,11).map(function(e){return{value:e+"",label:e+" buckets"}}),ds=function(e){var t=us.find(function(t){return t.value===e+""});return t||(t={label:"".concat(e," Buckets"),value:e+""}),t},ps=function(e){var t={value:""},n=2,a=[];e.originalNode&&Sl(e.originalNode)===fe.split_by_random&&(t={value:e.originalNode.node.router.result_name||""},n=e.originalNode.node.exits.length,a=e.originalNode.node.router.categories);return{categories:a=ms(a,n),resultName:t,bucketChoice:{value:ds(n)},valid:!0}},hs=function(e,t){var n={};t.resultName.value&&(n.result_name=t.resultName.value);var r=Sl(e.originalNode)===fe.split_by_random?e.originalNode.node.exits:[],i=parseInt(t.bucketChoice.value.value,10);r.splice(i,r.length-i),t.categories.forEach(function(e,t){if(t<r.length)e.exit_uuid=r[t].uuid;else{var n={uuid:X(),destination_uuid:null};e.exit_uuid=n.uuid,r.push(n)}});var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ls(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ls(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.random,categories:t.categories},n);return _i(e.originalNode.node.uuid,o,r,fe.split_by_random,[],null)},ms=function(e,t){return e.concat(Z(e.length,t).map(function(e){return{uuid:X(),name:"Bucket ".concat(e+1),exit_uuid:null}}))},fs=n(85),vs=n.n(fs);function gs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}!function(e){e.args="args",e.min="min",e.max="max",e.exit="exit"}(cs||(cs={}));var _s=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=ps(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleBucketsChanged",value:function(e){var t=parseInt(e.value,10),n=this.state.categories.concat([]);n=n.slice(0,t),n=ms(n,t);var a={bucketChoice:{value:e}},r=Qt(this.state,a);return this.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gs(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gs(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{categories:n})),r.valid}},{key:"handleSave",value:function(){this.props.updateRouter(hs(this.props.nodeSettings,this.state)),this.props.onClose(!1)}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleBucketNameChanged",value:function(e,t){var n=this.state.categories;n.find(function(t){return t.uuid===e.uuid}).name=t,this.setState({categories:n})}},{key:"renderBucketNames",value:function(){var e=this;return this.state.categories.map(function(t){return b.createElement(na,{key:t.uuid,__className:vs.a.bucket_name,name:t.uuid,entry:{value:t.name},onChange:function(n){e.handleBucketNameChanged(t,n)}})})}},{key:"renderEdit",value:function(){var e=this.props.typeConfig,t=us.concat([]);return-1===us.indexOf(this.state.bucketChoice.value)&&t.push(this.state.bucketChoice.value),b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("div",{className:vs.a.lead_in},"Split them randomly into one of"),b.createElement("div",{className:vs.a.bucket_select},b.createElement(jn,{styles:Ct,name:"Buckets",entry:this.state.bucketChoice,onChange:this.handleBucketsChanged,options:t})),b.createElement("div",{className:vs.a.bucket_list},this.renderBucketNames()),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component);function ys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}_s.contextTypes={assetService:Ve};var bs,Os=function(e){var t=[],n={value:"Result"},a=0;if(e.originalNode&&Sl(e.originalNode)===fe.wait_for_response){var r=e.originalNode.node.router;r&&(yi(e.originalNode.node)&&(t=bi(r.cases,e.originalNode)),n={value:r.result_name||""}),e.originalNode.node.router.wait&&e.originalNode.node.router.wait.timeout&&(a=e.originalNode.node.router.wait.timeout.seconds||0)}return{cases:t,resultName:n,timeout:a,valid:!0}},ks=function(e,t){var n=Ci(t.cases,t.timeout>0,e.originalNode.node),i=n.cases,o=n.exits,s=n.defaultCategory,l=n.timeoutCategory,c=n.caseConfig,u=n.categories,d={};t.resultName.value&&(d.result_name=t.resultName.value);var p={type:r.msg};t.timeout>0&&(p.timeout={seconds:t.timeout,category_uuid:l});var h=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ys(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ys(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.switch,default_category_uuid:s,cases:i,categories:u,operand:"@input.text",wait:p},d);return _i(e.originalNode.node.uuid,h,o,fe.wait_for_response,[],{cases:c})},Es=n(86),Cs=n.n(Es),ws=[{value:60,label:"1 minute"},{value:120,label:"2 minutes"},{value:180,label:"3 minutes"},{value:240,label:"4 minutes"},{value:300,label:"5 minutes"},{value:600,label:"10 minutes"},{value:900,label:"15 minutes"},{value:3600,label:"1 hours"},{value:7200,label:"2 hours"},{value:10800,label:"3 hours"},{value:21600,label:"6 hours"},{value:43200,label:"12 hours"},{value:64800,label:"18 hours"},{value:86400,label:"1 day"},{value:172800,label:"2 days"},{value:259200,label:"3 days"},{value:604800,label:"1 week"}],Ss=ws[4],js=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getSelected",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=ws.entries()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,s=Object(k.a)(o,2),l=s[0];if(s[1].value===e)return ws[l]}}catch(c){n=!0,a=c}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}return null}},{key:"isChecked",value:function(){return this.props.timeout>0}},{key:"getInstructions",value:function(){var e="Continue when there is no response";return this.isChecked()?"".concat(e," for"):"".concat(e,"...")}},{key:"handleChecked",value:function(){this.props.timeout>0?this.props.onChanged(0):this.props.onChanged(Ss.value)}},{key:"handleTimeoutChanged",value:function(e){this.props.onChanged(e.value)}},{key:"render",value:function(){return b.createElement("div",{className:Cs.a.timeout_control_container},b.createElement("div",{className:Cs.a.left_section},b.createElement(ba,{name:"Timeout",checked:this.isChecked(),description:this.getInstructions(),checkboxClassName:Cs.a.checkbox,onChange:this.handleChecked})),V(this.isChecked())(b.createElement("div",{className:Cs.a.drop_down},b.createElement(Vt.a,{name:"timeout",menuPlacement:"auto",styles:Ct,isClearable:!1,isSearchable:!1,value:this.getSelected(this.props.timeout),onChange:this.handleTimeoutChanged,options:ws}))))}}]),t}(b.Component);!function(e){e.args="args",e.min="min",e.max="max",e.exit="exit"}(bs||(bs={}));var Ns=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Os(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleUpdateTimeout",value:function(e){this.setState({timeout:e})}},{key:"handleCasesUpdated",value:function(e){var t=e.find(function(e){return!e.valid});this.setState({cases:e,valid:!t})}},{key:"handleSave",value:function(){this.state.valid&&(this.props.updateRouter(ks(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderEdit",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons(),gutter:b.createElement(js,{timeout:this.state.timeout,onChanged:this.handleUpdateTimeout})},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("div",null,mi),b.createElement(Co,{"data-spec":"cases",cases:this.state.cases,onCasesUpdated:this.handleCasesUpdated}),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component),xs=function(e){var t={value:null},n={value:"Result"},a=!1,r=Ps(e);if(r&&r.type===fe.call_resthook){var i=r.resthook;t={value:{id:i,name:i,type:pe.Resthook}},n={value:r.result_name},a=!0}return{resthook:t,resultName:n,valid:a}},Ps=function(e){var t=e.originalAction||e.originalNode.node.actions.length>0&&e.originalNode.node.actions[0];if(t.type===fe.call_resthook)return t},Ds=n(170),Rs=n.n(Ds),Ts=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=xs(e.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[on,fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleResthookChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={resthook:an("Resthook",e[0],[cn(t)])},a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleSave",value:function(){this.handleResthookChanged([this.state.resthook.value],!0)&&(this.props.updateRouter(function(e,t){var n=X(),a=Ps(e);a&&(n=a.uuid);var r={uuid:n,resthook:t.resthook.value.id,type:fe.call_resthook,result_name:t.resultName.value};return wi(r,e.originalNode,!1)}(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:"Ok",onClick:this.handleSave},secondary:{name:"Cancel",onClick:function(){return e.props.onClose(!0)}}}}},{key:"render",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement(zt,{name:"Resthook",placeholder:"Select the resthook to call",assets:this.props.assetStore.resthooks,entry:this.state.resthook,searchable:!0,onChange:this.handleResthookChanged}),b.createElement("div",{className:Rs.a.result_name},Xi(this.state.resultName,this.handleUpdateResultName)))}}]),t}(b.PureComponent);function As(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Us=[{value:"0",label:"first"},{value:"1",label:"second"},{value:"2",label:"third"},{value:"3",label:"fourth"},{value:"4",label:"fifth"},{value:"5",label:"sixth"},{value:"6",label:"seventh"},{value:"7",label:"eighth"},{value:"8",label:"ninth"},{value:"9",label:"tenth"},{value:"10",label:"11th"},{value:"11",label:"12th"},{value:"12",label:"13th"},{value:"13",label:"14th"},{value:"14",label:"15th"},{value:"15",label:"16th"},{value:"16",label:"17th"},{value:"17",label:"18th"},{value:"18",label:"19th"},{value:"19",label:"20th"}],Fs=[{value:" ",label:"spaces"},{value:".",label:"periods"},{value:"+",label:"plusses"}],Is=function(e){return Fs.find(function(t){return t.value===e})},Ms=function(e,t){var n=[],a={value:""},r=null,i=1,o=" ",s=!1,l=Sl(e.originalNode);if(e.originalNode&&l===fe.split_by_run_result||l===fe.split_by_run_result_delimited){var c=e.originalNode.node.router;c&&(yi(e.originalNode.node)&&(n=bi(c.cases,e.originalNode)),a={value:c.result_name||""});var u=e.originalNode.ui.config;u&&u.operand&&(r=u.operand.id in t.results.items?t.results.items[u.operand.id]:null),l===fe.split_by_run_result_delimited&&(i=u.index,o=u.delimiter,s=!0)}return{cases:n,resultName:a,result:{value:r},shouldDelimit:s,fieldNumber:i,delimiter:o,valid:!0}},Ls=function(e,t){var n=Ci(t.cases,!1,e.originalNode.node),r=n.cases,i=n.exits,o=n.defaultCategory,s=n.caseConfig,l=n.categories,c={};t.resultName.value&&(c.result_name=t.resultName.value);var u=fe.split_by_run_result,d=t.result.value,p="@results.".concat(d.id),h={operand:{id:d.id,type:d.type,name:d.name},cases:s};t.shouldDelimit&&(h.index=t.fieldNumber,h.delimiter=t.delimiter,p="@(field(results.".concat(d.id,", ").concat(t.fieldNumber,', "').concat(t.delimiter,'"))'),u=fe.split_by_run_result_delimited);var m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?As(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):As(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.switch,default_category_uuid:o,categories:l,cases:r,operand:p},c);return _i(e.originalNode.node.uuid,m,i,u,[],h)},zs=n(47),Bs=n.n(zs),Vs=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Ms(n.props.nodeSettings,n.props.assetStore),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleResultChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={result:an("Result to split on",e[0],[cn(t)])},a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleCasesUpdated",value:function(e){this.setState({cases:e})}},{key:"handleSave",value:function(){this.handleResultChanged([this.state.result.value],!0)&&(this.props.updateRouter(Ls(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleShouldDelimitChanged",value:function(e){this.setState({shouldDelimit:e})}},{key:"handleFieldNumberChanged",value:function(e){this.setState({fieldNumber:parseInt(e.value,10)})}},{key:"handleDelimiterChanged",value:function(e){this.setState({delimiter:e.value})}},{key:"renderField",value:function(){return b.createElement("div",{className:Bs.a.non_delimited},b.createElement("div",{className:Bs.a.lead_in},"If the flow result"),b.createElement("div",{className:Bs.a.result_select},b.createElement(zt,{entry:this.state.result,styles:Ct,name:"Flow Result",placeholder:"Select Result",searchable:!1,assets:this.props.assetStore.results,onChange:this.handleResultChanged})))}},{key:"renderFieldDelimited",value:function(){return b.createElement("div",{className:Bs.a.delimited},b.createElement("div",{className:Bs.a.lead_in},"If the"),b.createElement("div",{className:Bs.a.field_number},b.createElement(jn,{styles:Ct,name:"Field Number",entry:{value:(e=this.state.fieldNumber,Us.find(function(t){return t.value===""+e}))},onChange:this.handleFieldNumberChanged,options:Us})),b.createElement("div",{className:Bs.a.lead_in_sub},"field of"),b.createElement("div",{className:Bs.a.result_select_delimited},b.createElement(zt,{entry:this.state.result,styles:Ct,name:"Flow Result",placeholder:"Select Result",searchable:!1,assets:this.props.assetStore.results,onChange:this.handleResultChanged})),b.createElement("div",{className:Bs.a.lead_in_sub},"delimited by"),b.createElement("div",{className:Bs.a.delimiter},b.createElement(jn,{styles:Ct,name:"Delimiter",entry:{value:Is(this.state.delimiter)},onChange:this.handleDelimiterChanged,options:Fs})));var e}},{key:"render",value:function(){var e=this.props.typeConfig,t={name:"Advanced",body:b.createElement("div",{className:Bs.a.should_delimit},b.createElement(ba,{name:"Delimit",title:"Delimit Result",checked:this.state.shouldDelimit,description:"Evaluate your rules against a delimited part of your result",onChange:this.handleShouldDelimitChanged})),checked:this.state.shouldDelimit};return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons(),tabs:[t]},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),this.state.shouldDelimit?this.renderFieldDelimited():this.renderField(),b.createElement(Co,{"data-spec":"cases",cases:this.state.cases,onCasesUpdated:this.handleCasesUpdated}),Xi(this.state.resultName,this.handleUpdateResultName))}}]),t}(b.Component),qs=function(e){if(Sl(e.originalNode)===fe.split_by_subflow||e.originalAction&&e.originalAction.type===fe.enter_flow){var t=e.originalAction||e.originalNode.node.actions.length>0&&e.originalNode.node.actions[0];return{flow:{value:Hs(t.flow)},valid:!0}}return{flow:{value:null},valid:!1}},Hs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{uuid:"",name:""};return{id:e.uuid,name:e.name,type:pe.Flow}},Ks=function(e){return{uuid:e.id,name:e.name}},Gs=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=qs(e.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleFlowChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={flow:an("Flow",e[0],[cn(t)])},a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleSave",value:function(){this.handleFlowChanged([this.state.flow.value],!0),this.state.valid&&(this.props.updateRouter(function(e,t){var n,r,i,o={uuid:(e.originalAction||e.originalNode.node.actions.length>0&&e.originalNode.node.actions[0]).uuid||X(),type:fe.enter_flow,flow:Ks(t.flow.value)};if(Sl(e.originalNode)===fe.split_by_subflow){n=e.originalNode.node.exits;var s=e.originalNode.node.router;r=s.cases,i=s.categories}else n=[{uuid:X(),destination_uuid:null},{uuid:X(),destination_uuid:null}],i=[{uuid:X(),name:c.Complete,exit_uuid:n[0].uuid},{uuid:X(),name:c.Expired,exit_uuid:n[1].uuid}],r=[{uuid:X(),type:ve.has_only_text,arguments:["completed"],category_uuid:i[0].uuid},{uuid:X(),arguments:["expired"],type:ve.has_only_text,category_uuid:i[1].uuid}];var l={type:a.switch,operand:"@child.run.status",cases:r,categories:i,default_category_uuid:i[i.length-1].uuid};return _i(e.originalNode.node.uuid,l,n,fe.split_by_subflow,[o])}(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"handleFilter",value:function(e){return e.content.type===this.context.config.flowType}},{key:"render",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement(zt,{name:"Flow",placeholder:"Select the flow to start",assets:this.props.assetStore.flows,entry:this.state.flow,searchable:!0,onFilter:this.handleFilter,onChange:this.handleFlowChanged}))}}]),t}(b.PureComponent);function Ws(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}Gs.contextTypes={config:Ve};var Ys,Qs=function(e){var t={value:"Result"};if(e.originalNode&&e.originalNode.ui.type===fe.wait_for_response){var n=e.originalNode.node.router;n&&(t={value:n.result_name||""})}return{resultName:t,valid:!0}},Xs=function(e,t,n){var o=Ci([],!1,e.originalNode.node),s=o.exits,l=o.defaultCategory,c=o.caseConfig,u=o.categories,d={};t.resultName.value&&(d.result_name=t.resultName.value);var p="@input.text",h={type:r.msg};switch(n.type){case fe.wait_for_audio:h.hint={type:i.audio},p="@input";break;case fe.wait_for_image:h.hint={type:i.image},p="@input";break;case fe.wait_for_location:h.hint={type:i.location},p="@input";break;case fe.wait_for_video:h.hint={type:i.video},p="@input"}var m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ws(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ws(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:a.switch,default_category_uuid:l,cases:[],categories:u,wait:h,operand:p},d);return _i(e.originalNode.node.uuid,m,s,fe.wait_for_response,[],{cases:c})},Zs=n(171),$s=n.n(Zs),Js=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=Qs(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleSave",value:function(){this.state.valid&&(this.props.updateRouter(Xs(this.props.nodeSettings,this.state,this.props.typeConfig)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderEdit",value:function(){var e=this.props.typeConfig;return b.createElement(ce,{title:e.name,headerClass:e.type,buttons:this.getButtons()},b.createElement(Kt,{__className:"",initialType:e,onChange:this.props.onTypeChange}),b.createElement("div",{className:$s.a.result_name},Xi(this.state.resultName,this.handleUpdateResultName)))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component),el=n(40),tl=n.n(el),nl=(At.t("errors.http_header_missing_name","HTTP headers must have a name"),At.t("forms.call_webhook.header_name","Header Name")),al=At.t("forms.call_webhook.header_value","Value"),rl=function(e){function t(e){var n;Object(p.a)(this,t);var a=(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).props.entry.value,r=a.name||"",i=a.value||"";return n.state={name:{value:r},value:{value:i}},Object(y.react)(Object(v.a)(n),{include:[/^on/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getHeader",value:function(){return{name:this.state.name.value,value:this.state.value.value,uuid:this.props.entry.value.uuid}}},{key:"handleChangeName",value:function(e){var t=this,n=an("Header name",e,[un]);this.setState({name:{value:n.value}},function(){return t.props.onChange(t.getHeader(),Pe(t.state.value).concat(Pe(n)))})}},{key:"handleChangeValue",value:function(e){var t=this;this.setState({value:{value:e}},function(){var e=an("Header name",t.state.name.value,[un]);t.props.onChange(t.getHeader(),Pe(t.state.value).concat(Pe(e)))})}},{key:"handleRemove",value:function(){this.props.onRemove(this.getHeader())}},{key:"getRemoveIco",value:function(){return b.createElement("div",{className:tl.a.remove_ico,onClick:this.handleRemove,"data-spec":"remove-icon"},b.createElement("span",{className:"fe-x"}))}},{key:"render",value:function(){var e=this,t=this.getRemoveIco();return b.createElement(et,{name:At.t("forms.call_webhook.header","Header"),entry:this.props.entry},b.createElement("div",{className:tl.a.header,"data-spec":"header-container"},b.createElement("div",{className:tl.a.header_name,"data-spec":"name-container"},b.createElement(na,{placeholder:nl,name:nl,onChange:this.handleChangeName,entry:this.state.name})),b.createElement("div",{className:tl.a.header_value,"data-spec":"value-container"},b.createElement(na,{placeholder:al,name:al,onChange:this.handleChangeValue,entry:this.state.value,onFieldFailures:function(t){var n=an(nl,e.state.name.value,[un]);e.props.onChange(e.getHeader(),t.concat(Pe(n)))},autocomplete:!0})),t))}}]),t}(b.Component);!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT"}(Ys||(Ys={}));var il={value:Ys.GET,label:Ys.GET},ol=[il,{value:Ys.POST,label:Ys.POST},{value:Ys.PUT,label:Ys.PUT}],sl=function(e){var t=e.originalAction||e.originalNode.node.actions.length>0&&e.originalNode.node.actions[0];if(t.type===fe.call_webhook)return t},ll=function(e){var t={headers:[],resultName:{value:"Result"},method:{value:il},url:{value:""},postBody:{value:jo},valid:!1};if(Sl(e.originalNode)===fe.split_by_webhook){var n=sl(e),a=!0,r=!1,i=void 0;try{for(var o,s=Object.keys(n.headers||[]).sort()[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;t.headers.push({value:{uuid:X(),value:n.headers[l],name:l}})}}catch(c){r=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}t.resultName={value:n.result_name},t.url={value:n.url},t.method={value:{label:n.method,value:n.method}},t.postBody={value:n.body},t.valid=!0}else t.headers.push({value:{uuid:X(),name:"Content-Type",value:"application/json"}});return t.headers.push({value:{uuid:X(),name:"",value:""}}),t};function cl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ul(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cl(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cl(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var dl=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state=ll(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={},r=!1;e.hasOwnProperty("method")&&(a.method={value:e.method},e.method.value!==il.value?this.state.postBody.value||(a.postBody={value:jo}):a.postBody={value:null}),e.hasOwnProperty("url")&&(a.url=an("URL",e.url,[cn(n),hn])),e.hasOwnProperty("resultName")&&(a.resultName=an("Result Name",e.resultName,[cn(n)])),e.hasOwnProperty("postBody")&&(a.postBody={value:e.postBody}),e.hasOwnProperty("header")&&(a.headers=[{value:e.header,validationFailures:e.validationFailures}],r=!0);var i=[];e.hasOwnProperty("removeHeader")&&(i=[{headers:[{value:e.removeHeader}]}],r=!0);var o=Qt(this.state,a,i);return this.setState(o,function(){if(r){var e=!0,n=!0,a=!1,i=void 0;try{for(var o,s=t.state.headers[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){if(""===o.value.value.name.trim()){e=!1;break}}}catch(l){a=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}e&&t.handleCreateHeader()}}),o.valid}},{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[on,fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleMethodUpdate",value:function(e){return this.handleUpdate({method:e})}},{key:"handleUrlUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.handleUpdate({url:e},n)}},{key:"handleHeaderRemoved",value:function(e){return this.handleUpdate({removeHeader:e})}},{key:"handleHeaderUpdated",value:function(e,t){return this.handleUpdate({header:e,validationFailures:t})}},{key:"handleCreateHeader",value:function(){return this.handleUpdate({header:{uuid:X(),name:"",value:""}})}},{key:"handlePostBodyUpdate",value:function(e){return this.handleUpdate({postBody:e})}},{key:"handleSave",value:function(){this.handleUpdate({url:this.state.url.value,resultName:this.state.resultName.value},!0)&&(this.props.updateRouter(function(e,t){var n={},a=!0,r=!1,i=void 0;try{for(var o,s=t.headers[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;0!==l.value.name.trim().length&&(n[l.value.name]=l.value.value)}}catch(p){r=!0,i=p}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}var c=X(),u=sl(e);u&&(c=u.uuid);var d={uuid:c,headers:n,type:fe.call_webhook,url:t.url.value,method:t.method.value.value,result_name:t.resultName.value};return d.method!==Ys.GET&&(d.body=t.postBody.value),wi(d,e.originalNode,!1)}(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderEdit",value:function(){var e=this,t=this.props.typeConfig,n=this.state.headers.map(function(t,n,a){return b.createElement("div",{key:"header_".concat(t.value.uuid)},b.createElement(rl,{entry:t,onRemove:e.handleHeaderRemoved,onChange:e.handleHeaderUpdated,index:n}))}),a=[];a.push({name:"HTTP Headers",hasErrors:!!this.state.headers.find(function(e){return De(e)}),body:b.createElement(b.Fragment,null,b.createElement("p",{className:tl.a.info},b.createElement(Dt.a,{i18nKey:"forms.call_webhook.header_summary"},"Add any additional headers below that you would like to send along with your request.")),n),checked:this.state.headers.length>1});var r=this.state.method.value.value,i=this.state.method.value.label+" "+At.t("body","Body");return r!==Ys.POST&&r!==Ys.PUT||a.push({name:i,body:b.createElement("div",{key:"post_body",className:tl.a.body_form},b.createElement("h4",null,i),b.createElement("p",null,b.createElement(Dt.a,{i18nKey:"forms.call_webhook.body_summary",values:{method:this.state.method.value.label}},"Modify the body of the [[method]] request that will be sent to your webhook.")),b.createElement(na,{__className:tl.a.req_body,name:i,showLabel:!1,entry:this.state.postBody,onChange:this.handlePostBodyUpdate,helpText:b.createElement(Dt.a,{i18nKey:"forms.call_webhook.body_summary",values:{method:this.state.method.value.label}},"Modify the body of the [[method]] request that will be sent to your webhook."),onFieldFailures:function(t){var n=ul({},e.state.postBody,{persistantFailures:t});e.setState({postBody:n,valid:e.state.valid&&!De(n)})},autocomplete:!0,textarea:!0})),checked:this.state.postBody.value!==jo}),b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons(),tabs:a},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement("div",{className:tl.a.method},b.createElement(jn,{styles:Ot,name:"MethodMap",entry:this.state.method,onChange:this.handleMethodUpdate,options:ol})),b.createElement("div",{className:tl.a.url},b.createElement(na,{name:"URL",placeholder:At.t("forms.call_webhook.url_placeholder","Enter a URL"),entry:this.state.url,onChange:this.handleUrlUpdate,onFieldFailures:function(t){var n=ul({},e.state.url,{persistantFailures:t});e.setState({url:n,valid:e.state.valid&&!De(n)})},autocomplete:!0})),b.createElement("div",{className:tl.a.instructions},b.createElement("p",null,b.createElement(Dt.a,{i18nKey:"forms.call_webhook.help"},"If your server responds with JSON, each property will be added to the Flow.")),b.createElement("pre",{className:tl.a.code},'{ "product": "Solar Charging Kit", "stock level": 32 }'),b.createElement("p",null,b.createElement(Dt.a,{i18nKey:"forms.call_webhook.example"},"This response would add ",b.createElement("span",{className:tl.a.example},"@webhook.product")," and"," ",b.createElement("span",{className:tl.a.example},'@webhook["stock level"]')," for use in the flow."))),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component),pl=function(e){e.result_name;var t=e.classifier;return b.createElement("div",null,"Call ",t.name," classifier")},hl=Ke,ml=function(e){var t=e.originalAction||e.originalNode.node.actions.length>0&&e.originalNode.node.actions[0];if(t.type===fe.call_classifier)return t},fl=function(e){var t=[],n="@input.text",a={value:null},r=[];if(Sl(e.originalNode)===fe.split_by_intent){var i=e.originalNode.node.router;yi(e.originalNode.node)&&(r=(t=bi(i.cases,e.originalNode)).filter(function(e){return uo(e.kase.type).visibility===Ie}),t=t.filter(function(e){return uo(e.kase.type).visibility!==Ie}));var o=ml(e),s=o.classifier;a={value:{id:s.uuid,name:s.name,type:pe.Classifier}},n=o.input}return{hiddenCases:r,resultName:{value:"Result"},classifier:a,operand:{value:n},cases:t,valid:!0}},vl=function(e,t){var n=X(),r=Ci([].concat(Object(Nn.a)(t.cases),Object(Nn.a)(t.hiddenCases)),!1,e.originalNode.node,"Failure");!function(e,t){var n=e.cases.findIndex(function(e){return e.type===t.type&&(n=e.arguments,a=t.arguments,n.every(function(e,t){return e===a[t]}));var n,a});if(n>=0){if(n===e.cases.length-1)return;var a=e.cases.splice(n,1),r=Object(k.a)(a,1)[0];e.cases.push(r)}else{var i={uuid:X()},o={uuid:X(),name:t.name,exit_uuid:i.uuid},s={uuid:X(),type:t.type,arguments:t.arguments,category_uuid:o.uuid};e.categories.push(o),e.cases.push(s),e.exits.splice(e.exits.length-1,0,i)}}(r,{type:ve.has_category,arguments:["Success","Skipped"],name:"Other"});var i=ml(e);i&&(n=i.uuid);var o=t.resultName.value,s="_"+o+" Classification",l={uuid:n,type:fe.call_classifier,result_name:s,input:t.operand.value,classifier:{uuid:t.classifier.value.id,name:t.classifier.value.name}},c={cases:r.cases,operand:"@results.".concat(U(s)),categories:r.categories,type:a.switch,default_category_uuid:r.defaultCategory,result_name:o};return _i(e.originalNode.node.uuid,c,r.exits,fe.split_by_intent,[l])},gl=function(){var e=X();return{uuid:e,kase:{uuid:e,type:ve.has_top_intent,arguments:["",""],category_uuid:null},categoryName:"",valid:!0}},_l=n(172),yl=n.n(_l),bl=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).dialog=void 0,n.state=fl(n.props.nodeSettings),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n.state.classifier.value&&lt(n.props.assetStore.classifiers,n.state.classifier.value.id).then(function(e){n.handleUpdate({classifier:e})}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};e.hasOwnProperty("resultName")&&(n.resultName=an("Result Name",e.resultName,[cn(t)])),e.hasOwnProperty("classifier")&&(n.classifier=an("Classifier",e.classifier,[cn(t)]));var a=Qt(this.state,n);return this.setState(a),a.valid}},{key:"handleCasesUpdated",value:function(e){var t=e.find(function(e){return!e.valid});this.setState({cases:e,valid:!t})}},{key:"handleUpdateResultName",value:function(e){var t=an("Result Name",e,[on,fn,pn]);this.setState({resultName:t,valid:this.state.valid&&!De(t)})}},{key:"handleSave",value:function(){this.state.cases.find(function(e){return!e.valid})||this.handleUpdate({resultName:this.state.resultName.value,classifier:this.state.classifier.value},!0)&&(this.props.updateRouter(vl(this.props.nodeSettings,this.state)),this.props.onClose(!1))}},{key:"handleClassifierUpdated",value:function(e){this.handleUpdate({classifier:e[0]})}},{key:"handleOperandUpdated",value:function(e){this.setState({operand:an("Operand",e,[on])})}},{key:"getButtons",value:function(){var e=this;return{primary:{name:At.t("buttons.ok","Ok"),onClick:this.handleSave},secondary:{name:At.t("buttons.cancel","Cancel"),onClick:function(){return e.props.onClose(!0)}}}}},{key:"renderEdit",value:function(){var e=this,t=this.props.typeConfig,n=[{name:"Classifier Input",checked:"@input.text"!==this.state.operand.value,body:b.createElement(b.Fragment,null,b.createElement("p",null,"Enter an expression to use as the input to your classifier. To classify the last response from the contact use ",b.createElement("code",null,"@input.text"),"."),b.createElement(na,{name:"Operand",showLabel:!1,autocomplete:!0,onChange:this.handleOperandUpdated,entry:this.state.operand}))}];return b.createElement(ce,{title:t.name,headerClass:t.type,buttons:this.getButtons(),tabs:n,ref:function(t){e.dialog=t}},b.createElement(Kt,{__className:"",initialType:t,onChange:this.props.onTypeChange}),b.createElement("p",null,b.createElement("span",null,"Run "),b.createElement("span",{className:yl.a.link,onClick:function(){e.dialog.showTab(0)}},"@input.text"===this.state.operand.value?"the last response":this.state.operand.value),b.createElement("span",null," through the classifier...")),b.createElement(zt,{key:"select_classifier",name:"Classifier",placeholder:"Select the classifier to use",assets:this.props.assetStore.classifiers,onChange:this.handleClassifierUpdated,entry:this.state.classifier}),V(!!this.state.classifier.value)(b.createElement(Co,{"data-spec":"cases",cases:this.state.cases,onCasesUpdated:this.handleCasesUpdated,operators:so,createEmptyCase:gl,classifier:this.state.classifier.value})),Xi(this.state.resultName,this.handleUpdateResultName))}},{key:"render",value:function(){return this.renderEdit()}}]),t}(b.Component),Ol=[{scheme:"ext",name:At.t("schemes.external","External ID")},{scheme:"facebook",name:At.t("schemes.facebook","Facebook ID")},{scheme:"fcm",name:At.t("schemes.firebase","Firebase ID")},{scheme:"jiochat",name:At.t("schemes.jiochat","Jiochat ID")},{scheme:"line",name:At.t("schemes.line","Line ID")},{scheme:"mailto",name:At.t("schemes.email","Email Address")},{scheme:"tel",name:At.t("schemes.phone","Phone Number")},{scheme:"telegram",name:At.t("schemes.telegram","Telegram ID")},{scheme:"twitterid",name:At.t("schemes.twitterid","Twitter ID")},{scheme:"twitter",name:At.t("schemes.twitter","Twitter Handle")},{scheme:"wechat",name:At.t("schemes.wechat","Wechat ID")},{scheme:"whatsapp",name:At.t("schemes.whatsapp","Whatsapp Number")},{scheme:"viber",name:At.t("schemes.viber","Viber ID")}],kl=[{type:fe.missing,name:"Missing",description:" ** Unsupported ** ",component:Wa,visibility:Ie},{type:fe.say_msg,name:At.t("actions.play_message.name","Play Message"),description:At.t("actions.play_message.description","Play a message"),form:sr,localization:Ga,localizeableKeys:["text","audio_url"],component:rr,visibility:Me},{type:fe.wait_for_menu,name:At.t("actions.wait_for_menu.name","Wait for Menu Selection"),description:At.t("actions.wait_for_menu.description","Wait for menu selection"),form:ss,localization:Jo,localizeableKeys:["exits"],visibility:Me},{type:fe.wait_for_digits,name:At.t("actions.wait_for_digits.name","Wait for Digits"),description:At.t("actions.wait_for_digits.description","Wait for multiple digits"),form:Do,localization:Jo,localizeableKeys:["exits","cases"],visibility:Me},{type:fe.wait_for_audio,name:At.t("actions.wait_for_audio.name","Wait for Audio"),description:At.t("actions.wait_for_audio.description","Wait for an audio recording"),form:Js,localization:Jo,localizeableKeys:["exits"],visibility:[me.SURVEY,me.VOICE]},{type:fe.send_msg,name:At.t("actions.send_msg.name","Send Message"),description:At.t("actions.send_msg.description","Send the contact a message"),form:Fr,localization:Ga,localizeableKeys:["text","quick_replies"],component:Nr},{type:fe.wait_for_response,name:At.t("actions.wait_for_response.name","Wait for Response"),description:At.t("actions.wait_for_response.description","Wait for the contact to respond"),form:Ns,localization:Jo,localizeableKeys:["exits","cases"],aliases:[a.switch],visibility:ze},{type:fe.send_broadcast,name:At.t("actions.send_broadcast.name","Send Broadcast"),description:At.t("actions.send_broadcast.description","Send somebody else a message"),form:fr,localization:Ua,localizeableKeys:["text"],component:pr},{type:fe.add_input_labels,name:At.t("actions.add_input.name","Add Labels"),description:At.t("actions.add_input.description","Label the incoming message"),form:yn,component:We},{type:fe.add_contact_urn,name:At.t("actions.add_contact_urn.name","Add URN"),description:At.t("actions.add_contact_urn.description","Add a URN for the contact"),form:oa,component:Cn},{type:fe.add_contact_groups,name:At.t("actions.add_contact_groups.name","Add to Group"),description:At.t("actions.add_contact_groups.description","Add the contact to a group"),form:ha,component:va},{type:fe.remove_contact_groups,name:At.t("actions.remove_contact_groups.name","Remove from Group"),description:At.t("actions.remove_contact_groups.description","Remove the contact from a group"),form:ja,component:va},{type:fe.set_contact_field,aliases:[fe.set_contact_name,fe.set_contact_language,fe.set_contact_channel],name:At.t("actions.set_contact_field.name","Update Contact"),description:At.t("actions.set_contact_field.description","Update the contact"),form:qi,component:ci},{type:fe.send_email,name:At.t("actions.send_email.name","Send Email"),description:At.t("actions.send_email.description","Send an email"),form:Cr,localization:Ua,localizeableKeys:["subject","body"],component:vr,visibility:Be},{type:fe.set_run_result,name:At.t("actions.set_run_result.name","Save Flow Result"),description:At.t("actions.set_run_result.description","Save a result for this flow"),form:qr,component:Mr},{type:fe.play_audio,name:At.t("actions.play_audio.name","Play Recording"),description:At.t("actions.play_audio.description","Play a contact recording"),form:Za,component:Ya,visibility:Me},{type:fe.call_webhook,name:At.t("actions.call_webhook.name","Call Webhook"),description:At.t("actions.call_webhook.description","Call a webhook"),form:dl,localization:Jo,localizeableKeys:["exits"],component:la,aliases:[fe.split_by_webhook],visibility:Be},{type:fe.call_resthook,name:At.t("actions.call_resthook.name","Call Zapier"),description:At.t("actions.call_resthook.description","Call Zapier"),form:Ts,localization:Jo,localizeableKeys:["exits"],component:sa,aliases:[fe.split_by_resthook],filter:ge.HAS_RESTHOOK,visibility:Be},{type:fe.enter_flow,name:At.t("actions.enter_flow.name","Enter a Flow"),description:At.t("actions.enter_flow.description","Enter another flow"),form:Gs,localization:Jo,localizeableKeys:["exits"],component:Kr,aliases:[fe.split_by_subflow]},{type:fe.start_session,name:At.t("actions.start_session.name","Start Somebody Else"),description:At.t("actions.start_session.description","Start somebody else in a flow"),localization:Jo,localizeableKeys:["exits"],form:ai,component:Qr,visibility:Be},{type:fe.transfer_airtime,name:At.t("actions.transfer_airtime.name","Send Airtime"),description:At.t("actions.transfer_airtime.description","Send the contact airtime"),form:ro,localization:Jo,localizeableKeys:["exits"],component:oi,aliases:[fe.split_by_airtime],visibility:Be,filter:ge.HAS_AIRTIME},{type:fe.wait_for_image,name:At.t("actions.wait_for_image.name","Wait for Image"),description:At.t("actions.wait_for_image.description","Wait for an image"),form:Js,localization:Jo,localizeableKeys:["exits"],visibility:Le},{type:fe.wait_for_video,name:At.t("actions.wait_for_video.name","Wait for Video"),description:At.t("actions.wait_for_video.description","Wait for a video"),form:Js,localization:Jo,localizeableKeys:["exits"],visibility:Le},{type:fe.wait_for_location,name:At.t("actions.wait_for_location.name","Wait for Location"),description:At.t("actions.wait_for_location.description","Wait for location GPS coordinates"),form:Js,localization:Jo,localizeableKeys:["exits"],visibility:Le},{type:fe.split_by_intent,name:At.t("actions.split_by_intent.name","Split by Intent"),description:At.t("actions.split_by_intent.description","Split by intent"),form:bl,localization:Jo,localizeableKeys:["exits"],component:pl,aliases:[fe.call_classifier],visibility:Be,filter:ge.HAS_CLASSIFIER},{type:fe.split_by_expression,name:At.t("actions.split_by_expression.name","Split by Expression"),description:At.t("actions.split_by_expression.description","Split by a custom expression"),localization:Jo,localizeableKeys:["exits","cases"],form:Fo},{type:fe.split_by_contact_field,name:At.t("actions.split_by_contact_field.name","Split by Contact Field"),description:At.t("actions.split_by_contact_field.description","Split by a contact field"),localization:Jo,localizeableKeys:["exits","cases"],form:Ho},{type:fe.split_by_run_result,aliases:[fe.split_by_run_result_delimited],name:At.t("actions.split_by_run_result.name","Split by Flow Result"),description:At.t("actions.split_by_run_result.description","Split by a result in the flow"),localization:Jo,localizeableKeys:["exits","cases"],form:Vs},{type:fe.split_by_random,name:At.t("actions.split_by_random.name","Split Randomly"),description:At.t("actions.split_by_random.description","Split by random chance"),localization:Jo,localizeableKeys:["exits"],form:_s},{type:fe.split_by_groups,name:At.t("actions.split_by_groups.name","Split by Group Membership"),description:At.t("actions.split_by_groups.description","Split by group membership"),localization:Jo,localizeableKeys:["exits"],form:Qo}],El=function(e){var t={};return e.filter(function(e){if("missing"===e.type)return!1;var n=e.name;return!t[n]&&(t[n]=!0)})}(kl),Cl=kl.reduce(function(e,t){return e[t.type]=t,t.aliases&&t.aliases.forEach(function(n){return e[n]=t}),e},{}),wl=function(e){var t=Cl[e];return t||(t=Cl.missing),t},Sl=function(e){var t=e.node.router&&e.node.router.wait;if(t&&t.hint)switch(t.hint.type){case i.digits:return 1===t.hint.count?fe.wait_for_menu:fe.wait_for_digits;case i.audio:return fe.wait_for_audio;case i.image:return fe.wait_for_image;case i.location:return fe.wait_for_location;case i.video:return fe.wait_for_video}return e.ui.type!==fe.split_by_contact_field||e.ui.config.operand.name?e.ui.type:fe.split_by_expression},jl=function(e,t){return!!(e.filters||[]).find(function(e){return e===t})},Nl=function(e,t){var n={type:fe.set_contact_name,valid:!1,name:{value:""},channel:{value:null},language:{value:null},field:{value:Ae},fieldValue:{value:""}};if(e.originalAction){var a=e.originalAction.type;if(wl(a)===wl(fe.set_contact_field))switch(n.type=a,a){case fe.set_contact_field:var r=e.originalAction;return n.field={value:Dl(r.field)},n.fieldValue={value:r.value},n.valid=!0,n;case fe.set_contact_channel:var i=e.originalAction;return n.field={value:Ue},n.channel={value:Fl(i.channel)},n.valid=!0,n;case fe.set_contact_language:var o=e.originalAction;return n.field={value:Fe},n.valid=!0,n.language={value:Ul({iso:o.language,name:Il(o.language,t.languages.items)})},n;case fe.set_contact_name:var s=e.originalAction;return n.valid=!0,n.name={value:s.name},n}}return n},xl=function(e,t){return t.type===fe.set_contact_field?{uuid:Se(e,fe.set_contact_field),type:t.type,field:Rl(t.field.value),value:t.fieldValue.value}:t.type===fe.set_contact_channel?{uuid:Se(e,fe.set_contact_channel),type:t.type,channel:Tl(t.channel.value)}:t.type===fe.set_contact_language?{uuid:Se(e,fe.set_contact_language),type:t.type,language:Al(t.language.value)}:t.type===fe.set_contact_name?{uuid:Se(e,fe.set_contact_name),type:t.type,name:t.name.value}:void 0},Pl=function(e,t){if(e===Ae&&t!==Ae)return-1;if(t===Ae&&e!==Ae)return 1;if(e.type===t.type)return e.name.localeCompare(t.name);if(e.type===pe.Scheme)return 1;if(e.type!==t.type){if(e.type===pe.ContactProperty)return-1;if(t.type===pe.ContactProperty)return 1}return e.name.localeCompare(t.name)},Dl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{key:"",name:""};return{id:e.key,name:e.name,type:pe.Field}},Rl=function(e){return{key:e.id,name:e.name}},Tl=function(e){return e.id===_e.id?{}:{uuid:e.id,name:e.name}},Al=function(e){return e.id===_e.id?"":e.id},Ul=function(e){var t=e.iso,n=e.name;return t&&0!==t.length?{id:t,name:n,type:pe.Language}:_e},Fl=function(e){var t=e.uuid,n=e.name;return t?{id:t,name:n,type:pe.Language}:_e},Il=function(e,t){var n=e;return t&&n in t&&(n=t[n].name),n},Ml=n(122),Ll=n.n(Ml),zl={dragStartTime:0,dragDownPosition:null,dragActive:!1,dragNodeUUID:null,dragGroup:!1,dragSelection:null},Bl={completionSchema:{types:[],root:[]},functions:[],containerOffset:{top:0,left:0},currentRevision:null,simulating:!1,translating:!1,language:null,fetchingFlow:!1,dragStartTime:0,dragDownPosition:null,dragActive:!1,dragNodeUUID:null,dragGroup:!1,dragSelection:null,ghostNode:null,debug:null,activity:{segments:{},nodes:{}},liveActivity:{segments:{},nodes:{}},activityInterval:5e3,visible:!0},Vl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bl,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.UPDATE_EDITOR_STATE:return t.payload.editorState;default:return e}};function ql(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Hl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ql(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ql(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Kl=function(){},Gl=null,Wl=!1,Yl=function(e,t,n){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;Gl&&window.clearTimeout(Gl);var r=n(),i=r.flowContext,o=i.definition,s=i.nodes,l=i.assetStore,c=r.editorState.currentRevision;t(Ql({saving:!0}));var u=Sc(o,s,!0);u.revision=c,Gl=Wl?window.setTimeout(function(){Kl()},2e3):window.setTimeout(function(){Wl=!0,function(e,t){var n=st("csrftoken"),a=n?{"X-CSRFToken":n}:{};return new Promise(function(n,r){it.a.post(e,t,{headers:a}).then(function(e){200===e.status?n(e.data.revision):r(e)}).catch(function(e){return r(e)})})}(e,u).then(function(e){o.revision=e.revision,t(Oe(o));var n=function(e,t){return Ni(e,{revisions:{items:{$merge:Object(_.a)({},t.id,t)}}})}(l,e);t(Ee(n)),t(Ql({currentRevision:e.revision,saving:!1})),Wl=!1},function(e){var n=e.response.data,a=n&&n.description||"Hmm, we ran into a problem trying to save your changes. It could just be that your internet connection is not working well at the moment. Perhaps wait a minute or so and try again. It may also be that we encountered a problem we didn't anticipate. If your connection is good and you still can't save your changes, please contact support so we can help you out.";t(Ql({modalMessage:{title:"Uh oh, we couldn't save your changes",body:a},saving:!1})),Wl=!1})},a)}},Ql=function(e){return function(t,n){var a=n().editorState,r=Yt()(a,{$merge:e});return t(function(e){return{type:he.UPDATE_EDITOR_STATE,payload:{editorState:e}}}(r)),r}},Xl=function(){return function(e,t){Kl(0)}},Zl=function(e,t,n){return function(a,r){r().editorState.fetchingFlow||a(Ql({fetchingFlow:!0})),e.localization=e.localization||{},e._ui=e._ui||{nodes:{},languages:[],stickies:{}};var i=0,o=!0,s=!1,l=void 0;try{for(var c,u=e.nodes[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d=c.value;e._ui.nodes[d.uuid]||(e._ui.nodes[d.uuid]={position:{left:0,top:i},type:xc(d)},i+=150)}}catch(f){s=!0,l=f}finally{try{o||null==u.return||u.return()}finally{if(s)throw l}}var p,h,m=Dc(e);Rc(t.fields.items,m.fields),Rc(t.groups.items,m.groups),Rc(t.labels.items,m.labels),Rc(t.results.items,m.results),e.language&&(p=t.languages.items[e.language]),p||(p=ye,a(Ql({language:ye})),Rc(t.languages.items,{base:ye})),a((h=p,{type:he.UPDATE_BASE_LANGUAGE,payload:{baseLanguage:h}})),a(Oe(function(e){return Ni(e,{nodes:[],_ui:{$merge:{nodes:{}}}})}(e))),a(ke(m.renderNodeMap)),a(Ee(t)),a(Ql({language:p,fetchingFlow:!1})),n&&n()}},$l=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(){var r=Object(at.a)(nt.a.mark(function r(i,o){var s,l,c,u;return nt.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i(Ql({fetchingFlow:!0})),s=o(),l=s.flowContext.assetStore,Object.keys(l).length){r.next=6;break}return r.next=5,mt(e);case 5:l=r.sent;case 6:return Tc(e.activity,i,o,t),window.triggerActivityUpdate=function(){Tc(e.activity,i,o,t)},r.next=10,vt(e.completion);case 10:return c=r.sent,r.next=13,ft(e.functions);case 13:u=r.sent,gt(l.revisions).then(function(e){i(Zl(e,l,n)),i(Ql({currentRevision:e.revision,completionSchema:c,functions:u})),Kl=Yl(l.revisions.endpoint,i,o),a&&Kl(0)}).catch(function(e){console.error(e)});case 15:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}()},Jl=function(e,t){return function(n,a){var r=a().flowContext.assetStore,i=Yt()(r,Object(_.a)({},e,{items:{$merge:Object(_.a)({},t.id,t)}}));n(Ee(i))}},ec=function(e){return function(t,n){var a=n(),r=a.flowContext.baseLanguage,i=a.editorState,o=i.translating,s=i.language;Ll()(e,r)?t(Ql({translating:!1})):o||t(Ql({translating:!0})),Ll()(e,s)||t(Ql({language:e}))}},tc=function(e,t){return function(n,a){var r=function(e,t,n){var a=e;return a.localization[t]||(a=Ni(a,{localization:Object(_.a)({},t,K({}))})),n.forEach(function(e){var n=e.translations,r=e.uuid;if(n){for(var i={},o=0,s=Object.keys(n);o<s.length;o++){var l=s[o],c=n[l];Array.isArray(c)?i[l]=c:i[l]=[c]}a=Ni(a,{localization:Object(_.a)({},t,Object(_.a)({},r,K(i)))})}else a=Ni(a,{localization:Object(_.a)({},t,W([r]))})}),a}(a().flowContext.definition,e,t);return n(Oe(r)),Kl(),r}},nc=function(e,t,n){return function(a,r){var i=r().flowContext.nodes,o=Ri(i,e,t,n);return a(ke(o)),Kl(),o}},ac=function(e,t){return function(n,a){return n(nc(e,t,null))}},rc=function(e,t){return function(n,a){var r=e.split(":"),i=Object(k.a)(r,2),o=i[0],s=i[1];return n(nc(o,s,t))}},ic=function(e){return function(t,n){var a=n().flowContext,r=a.nodes,i=a.assetStore;if(e.router&&e.router.result_name){var o=Pi(e.router.result_name,i,{nodeUUID:e.uuid});t(Ee(o))}var s=Ui(r,e.uuid);return t(ke(s)),Kl(),s}},oc=function(e,t){return function(n,a){var r=a().flowContext,i=r.nodes,o=r.assetStore,s=i[e];if(t.type===fe.set_run_result){var l=Pi(t.name,o,{nodeUUID:e,actionUUID:t.uuid});n(Ee(l))}if(1===s.node.actions.length){var c=n(ic(s.node));return Kl(),c}var u=function(e,t,n){var a=bc(e,t),r=kc(a.node,n);return Ni(e,Object(_.a)({},t,{node:{actions:Q([[r,1]])}}))}(i,e,t.uuid);return n(ke(u)),Kl(),u}},sc=function(e,t){return function(n,a){var r=function(e,t,n){var a=bc(e,t),r=a.node.actions,i=kc(a.node,n);if(0===i)throw new Error("Cannot move an action at the top upwards");var o=r[i],s=r[i-1];return Ni(e,Object(_.a)({},t,{node:{actions:Q([[i-1,2,o,s]])}}))}(a().flowContext.nodes,e,t.uuid);return n(ke(r)),Kl(),r}},lc=function(e){return function(t){t(function(e){return{type:he.UPDATE_TYPE_CONFIG,payload:{typeConfig:e}}}(e))}},cc=function(){return function(e,t){e(Ql({ghostNode:null})),e(Zt(null))}},uc=function(e,t){return function(n,a){H("onUpdateAction");var r=a(),i=r.nodeEditor,o=i.userAddingAction,s=i.settings,l=r.flowContext,c=l.nodes,u=l.contactFields,d=l.assetStore;if(null==s||null==s.originalNode)throw new Error("Need originalNode in settings to update an action");var p=s.originalNode,h=s.originalAction,m=d;if(h&&h.type===fe.set_run_result){var f=h.name;m=Pi(f,m,{nodeUUID:p.node.uuid,actionUUID:e.uuid})}var v=c,g=null;if(!(null===p||!p.ghost)){var y={node:{uuid:X(),actions:[e],exits:[{uuid:X(),destination_uuid:null}]},ui:{position:p.ui.position,type:fe.execute_actions},inboundConnections:p.inboundConnections};v=Ti(c,y),g=y.node.uuid}else g=p.node.uuid,v=o?function(e,t,n){return bc(e,t),Ni(e,Object(_.a)({},t,{node:{actions:Y([n])}}))}(c,p.node.uuid,e):p.node.hasOwnProperty("router")?Ai(c,p.node.uuid,e):function(e,t,n,a){var r=bc(e,t),i=a?kc(r.node,a.uuid):0;return Ni(e,Object(_.a)({},t,{node:{actions:Object(_.a)({},i,K(n))}}))}(c,p.node.uuid,e,h);(n(ke(v)),n($t(!1)),e.type===fe.set_run_result)&&(m=function(e,t,n){if(e){var a=Di(e,t.results.items,n);return Ni(t,{results:{items:{$set:a}}})}}(e.name,m,{nodeUUID:g,actionUUID:e.uuid}),n(Ee(m)));if(e.type===fe.set_contact_field){var b=e.field;n(function(e){return{type:he.UPDATE_CONTACT_FIELDS,payload:{contactFields:e}}}(Hl({},u,Object(_.a)({},b.key,b.name))))}return Kl(),t&&t(n,a),v}},dc=function(e){return function(t,n){var a=n().flowContext.nodes,r={uuid:X(),type:fe.send_msg,text:""};t(Zt({originalNode:bc(a,e.uuid),originalAction:r,showAdvanced:!1})),Kl(),t($t(!0)),t(lc(wl(fe.send_msg))),t(Ql(zl))}},pc=function(e){return function(t,n){var a=n().flowContext,r=a.nodes,i=a.definition,o=r,s=i,l=!1,c=!1;return e.forEach(function(e){e in o?(o=Ui(o,e,!0),l=!0):e in s._ui.stickies&&(s=Mi(s,e,null),c=!0)}),l&&t(ke(o)),c&&t(Oe(s)),(c||l)&&Kl(),r}},hc=function(e){return function(t,n){var a=n().flowContext,r=a.nodes,i=a.definition,o=r,s=!1,l=!1;for(var c in e)o[c]?(o=Fi(o,c,e[c]),s=!0):i._ui.stickies[c]&&(i=Ii(i,c,e[c]),l=!0);var u=!1;return s&&(u=!0,t(ke(o))),l&&(u=!0,t(Oe(i))),u&&Kl(),o}},mc=function(e,t){return function(n,a){for(var r=a().flowContext,i=r.nodes,o=r.assetStore,s=e.sourceId.split(":"),l=Object(k.a)(s,2),c=l[0],u=l[1],d=i[c],p=Object.keys(o.results?o.results.items:{}),h=p.length+1,m="result_".concat(h);J(p,m);)m="result_".concat(++h);var f=Nc(d,u,h,t);f.inboundConnections=Object(_.a)({},u,c),n(Ql({ghostNode:f}))}},fc=function(e,t){return function(n,a){var r=a().flowContext.definition,i=Mi(r,e,t);n(Oe(i)),Kl()}},vc=function(e){return function(t,n){var a,r,i=n(),o=i.flowContext,s=o.nodes,l=o.assetStore,c=i.nodeEditor.settings,u=c.originalNode,d=c.originalAction,p=s;if(u){var h=u.ui.position;e.ui.position=h,e.inboundConnections=u.inboundConnections}if(u.ghost){e.inboundConnections=u.inboundConnections;var m=u.ui.position,f=m.left,v=m.top;e.ui.position={left:f,top:v},e.node=xi(e.node)}if(ji(e.node)){var g=l,y=ji(u.node);y&&(g=Pi(y,g,{nodeUUID:u.node.uuid})),g=function(e,t){var n=e;n||(n={results:{items:{},type:pe.Result}}),n.results||(n.results={items:{},type:pe.Result});var a=ji(t);if(a){var r=Di(a,e.results.items,{nodeUUID:t.uuid});return Ni(e,{results:{items:{$set:r}}})}return e}(g,e.node),t(Ee(g))}if(u&&d&&!u.ghost&&!Ei(u.node)){var b=u.node.actions.find(function(e){return e.uuid===d.uuid});if(b)return e.ui.position.top=u.ui.position.top,t((a=e,r={nodeUUID:u.node.uuid,actionUUID:b.uuid},function(e,t){var n=t().flowContext.nodes,i=n[r.nodeUUID],o=n;o=Ui(o,i.node.uuid,!1),a.node=xi(a.node);var s,l,c=kc(i.node,r.actionUUID),u=c>0?Object(Nn.a)(i.node.actions.slice(0,c)):[],d=i.node.actions.slice(c+1,i.node.actions.length),p=i.ui.position,h=p.left,m=p.top;return u.length>0?(s={node:{uuid:X(),actions:u,exits:[{uuid:X(),destination_uuid:null}]},ui:{position:{left:h,top:m}},inboundConnections:Hl({},i.inboundConnections)},o=Ti(o,s),m+=D,a.inboundConnections=Object(_.a)({},s.node.exits[0].uuid,s.node.uuid),a.ui.position.top+=D):a.inboundConnections=Hl({},i.inboundConnections),o=Ti(o,a),d.length>0?(l={node:{uuid:X(),actions:d,exits:[{uuid:X(),destination_uuid:i.node.exits[0].destination_uuid}]},ui:{position:{left:h,top:m}},inboundConnections:Object(_.a)({},a.node.exits[0].uuid,a.node.uuid)},o=Ti(o,l)):o=Ri(o,a.node.uuid,a.node.exits[0].uuid,i.node.exits[0].destination_uuid),e(ke(o)),Kl(),o}));var O=Ei(e.node);if(O){var k=O.categories.find(function(e){return e.uuid===O.default_category_uuid});e.node.exits.find(function(e){return e.uuid===k.exit_uuid}).destination_uuid=u.node.exits[0].destination_uuid}e.inboundConnections=Object(_.a)({},u.node.exits[0].uuid,u.node.uuid),e.node=xi(e.node),e.ui.position.top+=D,p=Ti(p,e)}else p=Ti(p,e);return t(ke(p)),Kl(),p}},gc=function(e){return function(t,n){var a=n(),r=a.flowContext.definition.localization,i=a.editorState,o=i.language,s=i.translating,l=e.originalNode,c=e.originalAction,u=l.node;if(e.localizations=[],s){var d,p=c;if(!p&&u.actions.length>0&&(p=u.actions[u.actions.length-1]).type!==fe.send_msg&&p.type!==fe.send_broadcast)return;var h=r[o.id];(d=e.localizations).push.apply(d,Object(Nn.a)(wc(u,p,o,h)))}!c&&u.actions.length>0&&(c=u.actions[u.actions.length-1]);var m=Ra(e);t(lc(m)),t(Zt(e)),t(Ql(zl))}};function _c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var yc=null,bc=function(e,t){var n=e[t];if(!n)throw new Error("Cannot find node "+t);return n},Oc=function(e,t){var n=!0,a=!1,r=void 0;try{for(var i,o=e.exits.entries()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,l=Object(k.a)(s,2),c=l[0];if(l[1].uuid===t)return c}}catch(u){a=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}throw new Error("Cannot find exit "+t)},kc=function(e,t){var n=!0,a=!1,r=void 0;try{for(var i,o=e.actions.entries()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,l=Object(k.a)(s,2),c=l[0];if(l[1].uuid===t)return c}}catch(u){a=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}throw new Error("Cannot find action "+t)},Ec=function(e){var t=Sl(e);return function(e){return!(!e.node.router||!e.node.router.wait)}(e)||t===fe.split_by_expression||t===fe.split_by_subflow},Cc=function e(t,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=t[n],o=t[a];if(n===a)throw new Error("Flow loop detected, can't point to self");if(!Ec(o)&&!Ec(i))if(0!==r.length){if(a===r[0])throw new Error("Flow loop detected, route through a wait first");r.push(a);var s=!0,l=!1,c=void 0;try{for(var u,d=o.node.exits[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var p=u.value;p.destination_uuid&&e(t,a,p.destination_uuid,r)}}catch(y){l=!0,c=y}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}}else{r.push(n);var h=!0,m=!1,f=void 0;try{for(var v,g=o.node.exits[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var _=v.value;_.destination_uuid&&e(t,o.node.uuid,_.destination_uuid,r)}}catch(y){m=!0,f=y}finally{try{h||null==g.return||g.return()}finally{if(m)throw f}}}},wc=function(e,t,n,r){var i=[];e.router&&e.router.type===a.switch&&e.router.cases.forEach(function(e){return i.push(C.translate(e,n,r))});return t&&i.push(C.translate(t,n,r)),e.router&&e.router.categories.forEach(function(e){e.name&&i.push(C.translate(e,n,r))}),i},Sc=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=jc(t),r=[];a.forEach(function(e){return r.push(e.node)});for(var i={},o=0,s=Object.keys(t);o<s.length;o++){var l=s[o];i[l]=t[l].ui}var c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_c(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_c(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{nodes:r});return n&&(c._ui={nodes:i,stickies:e._ui.stickies,languages:e._ui.languages}),c},jc=function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(e[n])}),t.sort(function(e,t){var n=e.ui.position.top-t.ui.position.top;return 0===n&&(n=e.ui.position.left-t.ui.position.left),n})},Nc=function(e,t,n,o){var s,l,c={uuid:X(),actions:[],exits:[{uuid:X(),destination_uuid:null}]},u=fe.execute_actions;if(!e||(l=e)&&l.node.router){var d=o===me.VOICE?fe.say_msg:fe.send_msg,p={uuid:X(),text:"",type:d};c.actions.push(p)}else{var h=[{uuid:X(),name:$r.All_Responses,exit_uuid:c.exits[0].uuid}],m={type:r.msg};u=fe.wait_for_response,o===me.VOICE&&(m.hint={type:i.digits,count:1}),c.router={type:a.switch,result_name:(s=n,"Result ".concat(s)),default_category_uuid:h[0].uuid,categories:h,wait:m,cases:[]}}var f={};return e&&(f=Object(_.a)({},t,e.node.uuid)),{node:c,ui:{position:{left:0,top:0},type:u},inboundConnections:f,ghost:!0}},xc=function(e){if(e.router){if(1===e.actions.length){if(e.actions[0].type===fe.call_webhook)return fe.split_by_webhook;if(e.actions[0].type===fe.transfer_airtime)return fe.split_by_airtime;if(e.actions[0].type===fe.call_resthook)return fe.split_by_resthook;if(e.actions[0].type===fe.enter_flow)return fe.split_by_subflow}if(e.router.wait)return fe.wait_for_response;if(e.router.type===a.random)return fe.split_by_random;var t=Ei(e);return t&&"@contact.groups"===t.operand?fe.split_by_groups:fe.split_by_expression}return fe.execute_actions},Pc=function(e){var t={},n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;t[s.id]=s}}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return t},Dc=function(e){var t,n=e.nodes,a=e._ui,r={},i={},o={},s={},l={},c={},u=!0,d=!1,p=void 0;try{for(var h,m=n[Symbol.iterator]();!(u=(h=m.next()).done);u=!0){var f=h.value;f.actions||(f.actions=[]);var v={node:f,ui:a.nodes[f.uuid],inboundConnections:{}};r[f.uuid]=v;var g=ji(f);if(g&&(c=Di(g,c,{nodeUUID:f.uuid})),Sl(v)===fe.split_by_groups){var _=Ei(f),y=!0,b=!1,O=void 0;try{for(var k,E=function(){var e=k.value,t=e.arguments[0],n=_.categories.find(function(t){return t.uuid===e.category_uuid});n&&(o[t]={name:n.name,id:t,type:pe.Group})},C=_.cases[Symbol.iterator]();!(y=(k=C.next()).done);y=!0)E()}catch(re){b=!0,O=re}finally{try{y||null==C.return||C.return()}finally{if(b)throw O}}}var w=!0,S=!1,j=void 0;try{for(var N,x=f.actions[Symbol.iterator]();!(w=(N=x.next()).done);w=!0){var P=N.value;if((t=P.type)===fe.add_contact_groups||t===fe.remove_contact_groups||t===fe.send_broadcast){var D=P.groups;if(D){var R=!0,T=!1,A=void 0;try{for(var F,I=D[Symbol.iterator]();!(R=(F=I.next()).done);R=!0){var M=F.value;o[M.uuid]={name:M.name,id:M.uuid,type:pe.Group}}}catch(re){T=!0,A=re}finally{try{R||null==I.return||I.return()}finally{if(T)throw A}}}}else if(P.type===fe.set_contact_field){var L=P;s[L.field.key]={name:L.field.name,id:L.field.key,type:pe.Field}}else if(P.type===fe.add_input_labels){var z=!0,B=!1,V=void 0;try{for(var q,H=P.labels[Symbol.iterator]();!(z=(q=H.next()).done);z=!0){var K=q.value;l[K.uuid]={name:K.name,id:K.uuid,type:pe.Label}}}catch(re){B=!0,V=re}finally{try{z||null==H.return||H.return()}finally{if(B)throw V}}}else if(P.type===fe.set_run_result){var G=P,W=U(G.name);W in c?c[W].references.push({nodeUUID:f.uuid,actionUUID:P.uuid}):c[W]={name:G.name,id:W,type:pe.Result,references:[{nodeUUID:f.uuid,actionUUID:P.uuid}]}}}}catch(re){S=!0,j=re}finally{try{w||null==x.return||x.return()}finally{if(S)throw j}}var Y=!0,Q=!1,X=void 0;try{for(var Z,$=f.exits[Symbol.iterator]();!(Y=(Z=$.next()).done);Y=!0){var J=Z.value;if(J.destination_uuid){var ee=i[J.destination_uuid];ee||(ee={}),ee[J.uuid]=f.uuid,i[J.destination_uuid]=ee}}}catch(re){Q=!0,X=re}finally{try{Y||null==$.return||$.return()}finally{if(Q)throw X}}}}catch(re){d=!0,p=re}finally{try{u||null==m.return||m.return()}finally{if(d)throw p}}for(var te=0,ne=Object.keys(i);te<ne.length;te++){var ae=ne[te];r[ae].inboundConnections=i[ae]}return{renderNodeMap:r,groups:o,fields:s,labels:l,results:c}},Rc=function(e,t){Object.keys(t).forEach(function(n){e[n]=e[n]||t[n]})},Tc=function e(t,n,a,r){var i=a().editorState,o=i.simulating,s=i.activityInterval;i.visible?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(a,r){return it.a.get("".concat(e,"?flow=").concat(t),{headers:n}).then(function(e){return a(e.data)}).catch(function(e){return r(e)})})}(t,r).then(function(i){if(i){var l={liveActivity:i,activityInterval:Math.min(3e5,s+200)};o||(l.activity=i),n(Ql(l)),yc&&window.clearTimeout(yc),yc=window.setTimeout(function(){e(t,n,a,r)},s)}}):(yc&&window.clearTimeout(yc),yc=window.setTimeout(function(){e(t,n,a,r)},1e3))},Ac=n(123),Uc=n.n(Ac),Fc=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).ele=void 0,Object(y.react)(Object(v.a)(n),{include:[/^handle/,"ref"]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"ref",value:function(e){return this.ele=e}},{key:"componentDidMount",value:function(){this.ele&&this.props.updateDimensions&&this.props.updateDimensions(this.props.uuid,{width:this.ele.clientWidth||this.props.position.right-this.props.position.left,height:this.ele.clientHeight||this.props.position.bottom-this.props.position.top})}},{key:"componentDidUpdate",value:function(e){this.ele&&this.ele.clientWidth&&this.ele.clientHeight&&this.props.updateDimensions&&this.props.updateDimensions(this.props.uuid,{width:this.ele.clientWidth,height:this.ele.clientHeight})}},{key:"render",value:function(){var e=this,t=[Uc.a.draggable];this.props.selected&&t.push(Uc.a.selected);return b.createElement("div",{"data-testid":"draggable_"+this.props.uuid,onTransitionEnd:function(){e.props.onAnimated&&e.props.onAnimated(e.props.uuid)},ref:this.ref,className:t.join(" "),style:{left:this.props.position.left,top:this.props.position.top},onMouseDown:function(t){var n,a;(e.props.selected||"TEXTAREA"!==t.target.tagName.toUpperCase())&&(3!==t.nativeEvent.which&&e.props.onDragStart&&e.props.onDragStart(e.props.uuid,(n=t.pageX-e.props.position.left,a=t.pageY-e.props.position.top,{left:n,top:a})))},onMouseUp:function(t){3!==t.nativeEvent.which&&e.props.onDragStop&&e.props.onDragStop()}},this.props.ele(this.props.selected))}}]),t}(b.PureComponent);function Ic(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Mc=n(14),Lc=function(e,t,n){return!(!e.bottom||!t.bottom)&&(e.bottom+=n,!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top))},zc=function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ic(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ic(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e[n],{uuid:n}))}),t.sort(function(e,t){var n=e.top-t.top;return 0===n&&(n=e.left-t.left),n})},Bc=function(e,t,n){for(var a=zc(e),r=function(e){var r=a[e];if(e+1<a.length)for(var i=function(e){var i=a[e];if(Lc(r,i,n)){if(e+1<a.length){var o=a[e+1];if(Lc(i,o,n))return{v:{v:[r,i,o]}}}return t.find(function(e){return i.uuid===e})&&!t.find(function(e){return r.uuid===e})?{v:{v:[i,r]}}:{v:{v:[r,i]}}}},o=e+1;o<a.length;o++){var s=i(o);if("object"===typeof s)return s.v}},i=0;i<a.length;i++){var o=r(i);if("object"===typeof o)return o.v}return[]},Vc=function(e,t){return A({top:t,left:e.left,bottom:t+(e.bottom-e.top),right:e.right})},qc=n(98),Hc=n.n(qc);function Kc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Gc=300,Wc=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).ele=void 0,n.parentOffset=void 0,n.isScrolling=void 0,n.reflowTimeout=void 0,n.lastX=void 0,n.lastY=void 0,n.justSelected=!1;var a=document.documentElement.clientHeight,r={};return n.props.draggables.forEach(function(e){r[e.uuid]=e.position,e.position.bottom&&(a=Math.max(a,e.position.bottom+Gc))}),n.state={height:a,dragDownPosition:null,dragUUID:null,dragGroup:!1,dragSelection:null,uuid:n.props.uuid,selected:{},positions:r},Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^render/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleWindowResize",value:function(){var e=document.documentElement.clientHeight;this.setState({height:Math.max(e,this.state.height)})}},{key:"componentDidMount",value:function(){var e={left:0,top:0};this.ele&&(e=this.ele.getBoundingClientRect()),this.parentOffset={left:e.left,top:e.top+window.scrollY},window.addEventListener("resize",this.handleWindowResize),document.addEventListener("keydown",this.handleKeyDown)}},{key:"handleKeyDown",value:function(e){this.state.selected&&"Backspace"===e.key&&(Object.keys(this.state.selected).length>0&&this.props.onRemoveNodes(Object.keys(this.state.selected)))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e){var t=this,n=!1,a=this.state.positions;this.props.draggables.forEach(function(e){t.state.positions[e.uuid]||(a=Yt()(a,{$merge:Object(_.a)({},e.uuid,e.position)}),n=!0)}),Object.keys(a).forEach(function(e){t.props.draggables.find(function(t){return t.uuid===e})||(a=Yt()(a,{$unset:[[e]]}),n=!0)}),n&&this.setState({positions:a})}},{key:"renderSelectionBox",value:function(){var e=this.state.dragSelection;if(e&&e.startX&&e.startY&&e.currentX&&e.currentY){var t=Math.min(e.startX,e.currentX),n=Math.min(e.startY,e.currentY),a=Math.max(e.startX,e.currentX)-t,r=Math.max(e.startY,e.currentY)-n;if(this.state.dragSelection&&this.state.dragSelection.startX)return O.a.createElement("div",{className:Hc.a.drag_selection,style:{left:t,top:n,width:a,height:r}})}return null}},{key:"isClickOnCanvas",value:function(e){return 3!==e.nativeEvent.which&&e.target.id===this.state.uuid}},{key:"handleMouseDown",value:function(e){3!==e.nativeEvent.which&&this.props.mutable&&(this.justSelected=!1,this.isClickOnCanvas(e)&&this.setState({dragSelection:{startX:e.pageX-this.parentOffset.left,startY:e.pageY-this.parentOffset.top,currentX:e.pageX-this.parentOffset.left,currentY:e.pageY-this.parentOffset.top}}))}},{key:"handleMouseMove",value:function(e){if(this.props.mutable){if(this.props.draggingNew)return this.lastX=e.pageX,this.lastY=e.pageY,void this.updateStateWithScroll(e.clientY,e.pageY);if(this.state.dragSelection&&this.state.dragSelection.startX){var t=this.state.dragSelection;if(t&&t.startX&&t.startY&&t.currentX&&t.currentY){var n=Math.min(t.startX,t.currentX),a=Math.min(t.startY,t.currentY),r=Math.max(t.startX,t.currentX),i=Math.max(t.startY,t.currentY),o=function(e,t){for(var n={},a=0,r=Object.keys(e);a<r.length;a++){var i=r[a],o=e[i];Lc(t,o,0)&&(n[i]=o)}return n}(this.state.positions,{left:n,top:a,right:r,bottom:i});this.setState({dragSelection:{startX:t.startX,startY:t.startY,currentX:e.pageX-this.parentOffset.left,currentY:e.pageY-this.parentOffset.top}}),this.setState({selected:o}),Object.keys(o).length>0&&(this.justSelected=!0)}}this.state.dragUUID&&this.updatePositions(e.pageX,e.pageY,e.clientY,!1)}}},{key:"scrollCanvas",value:function(e){var t=this;if(!this.isScrolling){this.isScrolling=!0;var n=e;window.scrollY+e<0&&(n=0),this.isScrolling=window.setInterval(function(){t.lastX&&t.lastY&&(t.updatePositions(t.lastX,t.lastY+n,0,!1),window.scrollBy(0,n))},30)}}},{key:"handleMouseUpCapture",value:function(e){this.props.mutable&&3!==e.nativeEvent.which&&(this.lastX=null,this.lastY=null,this.state.dragUUID&&this.setState({dragDownPosition:null,dragSelection:null,dragUUID:null}),this.justSelected||(this.props.mergeEditorState({dragActive:!1}),this.setState({selected:{}})),this.state.dragSelection&&this.state.dragSelection.startX&&this.setState({dragSelection:{startX:void 0,startY:void 0,currentX:void 0,currentY:void 0}}),this.justSelected=!1)}},{key:"handleUpdateDimensions",value:function(e,t){var n=this.state.positions[e];n||(n=this.props.draggables.find(function(t){return t.uuid===e}).position);var a={left:n.left,top:n.top,right:n.left+t.width,bottom:n.top+t.height};a.bottom===n.bottom&&a.right===n.right||a.right===n.right&&a.bottom===n.bottom||(this.setState(function(t){return{positions:Yt()(t.positions,{$merge:Object(_.a)({},e,a)}),height:Math.max(a.bottom+Gc,t.height)}}),this.markReflow())}},{key:"doReflow",value:function(){var e=function(e,t){var n=e,a=[],r=0;H("reflow");for(var i=Bc(e,a,t);i.length>0&&r<100;){if(r++,i.length){var o=i,s=Object(k.a)(o,3),l=s[0],c=s[1],u=s[2];if(n=Mc(n,Object(_.a)({},c.uuid,K(Vc(c,l.bottom+D)))),a.push(c.uuid),u){var d=l.bottom+D;d+=c.bottom-c.top,n=Mc(n,Object(_.a)({},u.uuid,K(Vc(u,d)))),a.push(u.uuid)}}i=Bc(n,a,t)}return{positions:n,changed:a}}(this.state.positions,5),t=e.positions,n=e.changed;n&&(this.setState({positions:t}),n&&this.props.onUpdatePositions(n.reduce(function(e,n){return e[n]=t[n],e},{}))),this.props.onDragging(n)}},{key:"markReflow",value:function(){var e=this;this.reflowTimeout&&clearTimeout(this.reflowTimeout),this.reflowTimeout=setTimeout(function(){e.state.dragUUID||e.doReflow()},200)}},{key:"updateStateWithScroll",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.documentElement.clientHeight;this.setState(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kc(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kc(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},a,{height:Math.max(t+Gc,e.height)})},function(){n.isScrolling||0===e?0!==e&&e>100&&e+100<r&&(window.clearInterval(n.isScrolling),n.isScrolling=null):e+100>r?n.scrollCanvas(15):e<100&&n.scrollCanvas(-15)})}},{key:"updatePositions",value:function(e,t,n,a){if(this.state.dragUUID){var r=this.state.dragUUID;this.lastX=e,this.lastY=t;var i=this.props.dragActive?this.state.selected[r]:this.state.positions[r];if(this.state.dragDownPosition){var o=e-this.parentOffset.left-this.state.dragDownPosition.left-i.left,s=t-this.parentOffset.top-this.state.dragDownPosition.top-i.top,l=0;if(this.props.dragActive){var c={left:o,top:s},u=this.state,d=Object.keys(u.selected),p=u.positions;d.forEach(function(e){var t=function(e,t){var n=e.right-e.left,a=e.bottom-e.top,r=e.top+t.top,i=e.left+t.left;return n&&a?{left:i,top:r,right:i+n,bottom:r+a}:{top:r,left:i}}(u.selected[e],c);a&&(t=A(t)),t&&t.bottom>l&&(l=t.bottom),p=Yt()(p,{$merge:Object(_.a)({},e,t)})}),this.props.onDragging(d),this.updateStateWithScroll(n,l,{positions:p})}else if(Math.abs(o)+Math.abs(s)>bd){var h=this.state.selected;this.state.dragUUID in h||(h=Object(_.a)({},r,this.state.positions[r])),this.props.mergeEditorState({dragActive:!0}),this.setState({selected:h})}}}}},{key:"handleDragStart",value:function(e,t){this.setState({dragUUID:e,dragDownPosition:{left:t.left-this.parentOffset.left,top:t.top-this.parentOffset.top}})}},{key:"getSelectedPositions",value:function(){var e=this;return Object.keys(this.state.selected).reduce(function(t,n){return t[n]=e.state.positions[n],t},{})}},{key:"handleDragStop",value:function(){this.state.dragUUID&&this.updatePositions(this.lastX,this.lastY,0,!0),this.props.onUpdatePositions(this.getSelectedPositions()),this.setState({dragUUID:null,dragDownPosition:null,dragSelection:null}),this.markReflow(),this.props.mergeEditorState({dragActive:!1})}},{key:"render",value:function(){var e=this;return O.a.createElement("div",{className:Hc.a.canvas_container},O.a.createElement("div",{"data-testid":"canvas",style:{height:this.state.height},id:this.state.uuid,ref:function(t){e.ele=t},className:Hc.a.canvas,onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUpCapture},this.props.draggables.map(function(t){var n=e.state.positions[t.uuid]||t.position;return O.a.createElement(Fc,{onAnimated:function(t){e.props.onDragging([t])},key:"draggable_"+t.uuid,uuid:t.uuid,updateDimensions:e.handleUpdateDimensions,position:n,selected:!!e.state.selected[t.uuid],ele:t.ele,onDragStart:e.handleDragStart,onDragStop:e.handleDragStop})}),this.props.children,this.renderSelectionBox()))}}]),t}(O.a.PureComponent),Yc=n(99),Qc=n.n(Yc),Xc=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).ele=void 0,Object(y.react)(Object(v.a)(n),{include:[/^handle/,/^get/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.handleScrollIntoView()}},{key:"componentDidUpdate",value:function(e){e.count!==this.props.count&&this.handleScrollIntoView()}},{key:"handleScrollIntoView",value:function(){var e=this;this.ele&&this.props.count>0&&this.props.keepVisible&&window.setTimeout(function(){window.scrollTo({top:e.ele.getBoundingClientRect().top-200+window.scrollY,behavior:"smooth"})},200)}},{key:"handleMouseEvent",value:function(e,t){e.preventDefault(),e.stopPropagation(),t&&t()}},{key:"handleMouseEnter",value:function(e){this.handleMouseEvent(e,this.props.onMouseEnter)}},{key:"handleMouseLeave",value:function(e){this.handleMouseEvent(e,this.props.onMouseLeave)}},{key:"handleClick",value:function(e){this.handleMouseEvent(e,this.props.onClick)}},{key:"render",value:function(){var e=this,t=this.props.count.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");return b.createElement("div",{ref:function(t){e.ele=t},className:Qc.a.counter+" "+this.props.containerStyle+" "+(this.props.onClick?Qc.a.clickable:"")+" "+(this.props.count>0?Qc.a.visible:""),onClick:this.handleClick,"data-spec":"counter-outter"},b.createElement("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,className:this.props.countStyle,"data-spec":"counter-inner"},t))}}]),t}(b.Component),Zc=n(49),$c=n.n(Zc),Jc=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).confirmationTimeout=void 0,n.state={confirmingRemoval:!1},n.handleConfirmRemoval=n.handleConfirmRemoval.bind(Object(v.a)(n)),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentWillUnmount",value:function(){this.confirmationTimeout&&window.clearTimeout(this.confirmationTimeout)}},{key:"handleMouseUpCapture",value:function(e){e&&(e.preventDefault(),e.stopPropagation())}},{key:"handleConfirmRemoval",value:function(e){var t=this;e&&(e.preventDefault(),e.stopPropagation()),this.setState({confirmingRemoval:!0}),this.confirmationTimeout=window.setTimeout(function(){return t.setState({confirmingRemoval:!1})},2e3)}},{key:"getMoveArrow",value:function(){return this.props.showMove&&this.context.config.mutable?b.createElement("div",Object.assign({className:$c.a.up_button},L(this.props.onMoveUp,this.props.shouldCancelClick,this.handleMouseUpCapture),{"data-testid":"move-icon"}),b.createElement("span",{className:"fe-arrow-up"})):b.createElement("div",{className:$c.a.up_button,"data-spec":"move"})}},{key:"getRemove",value:function(){var e=null;return this.props.showRemoval&&this.context.config.mutable&&(e=b.createElement("div",Object.assign({className:$c.a.remove_button},L(this.handleConfirmRemoval,this.props.shouldCancelClick,this.handleMouseUpCapture),{"data-testid":"remove-icon"}),b.createElement("span",{className:"fe-x"}))),e}},{key:"getConfirmationEl",value:function(){var e;return this.state.confirmingRemoval&&this.context.config.mutable&&(e=b.createElement("div",{className:$c.a.remove_confirm,"data-spec":"confirmation"},b.createElement("div",{className:$c.a.up_button,"data-spec":"move"}),b.createElement("div",{className:$c.a.titletext},At.t("removal_confirmation","Remove?")),b.createElement("div",Object.assign({className:$c.a.remove_button},L(this.props.onRemoval,this.props.shouldCancelClick,this.handleMouseUpCapture),{"data-testid":"confirm-removal"}),b.createElement("span",{className:"fe-x"})))),e}},{key:"render",value:function(){var e=this.getConfirmationEl(),t=this.getMoveArrow(),n=this.getRemove();return b.createElement("div",{className:$c.a.titlebar,"data-spec":"titlebar-container"},b.createElement("div",{className:"".concat(this.props.__className," ").concat($c.a.normal),"data-spec":"titlebar"},t,b.createElement("div",{className:$c.a.titletext},this.props.title),n),e)}}]),t}(b.Component);function eu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}Jc.contextTypes={config:Ve};var tu=Xe.a.bind(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eu(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eu(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},ie.a,{},xa.a)),nu=function(e){function t(e,n){var a;return Object(p.a)(this,t),a=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(a),{include:[/^on/,/^handle/]}),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleActionClicked",value:function(e){var t=e.target,n=t&&t.attributes&&"true"===t.getAttribute("data-advanced");this.props.onOpenNodeEditor({originalNode:this.props.renderNode,originalAction:this.props.action,showAdvanced:n})}},{key:"handleRemoval",value:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.props.removeAction(this.props.renderNode.node.uuid,this.props.action)}},{key:"handleMoveUp",value:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.props.moveActionUp(this.props.renderNode.node.uuid,this.props.action)}},{key:"getAction",value:function(){return this.props.translating?z(this.props.action,this.props.localization,this.props.language).getObject():this.props.action}},{key:"getClasses",value:function(){var e,t=[],n=!1;if(this.props.translating&&(this.props.action.type!==fe.send_msg&&this.props.action.type!==fe.send_broadcast&&this.props.action.type!==fe.say_msg||t.push("text"),this.props.action.type===fe.send_email&&t.push("subject"),0!==t.length)){var a=z(this.props.action,this.props.localization,this.props.language);if(a.isLocalized()){var r=!0,i=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){if(!(s.value in a.localizedKeys)){n=!0;break}}}catch(u){i=!0,o=u}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}else n=!0}var c=this.props.translating&&0===t.length;return tu((e={},Object(_.a)(e,xa.a.action,!0),Object(_.a)(e,xa.a.has_router,this.props.renderNode.node.hasOwnProperty("router")&&null!==this.props.renderNode.node.router),Object(_.a)(e,xa.a.translating,this.props.translating),Object(_.a)(e,xa.a.not_localizable,c),Object(_.a)(e,xa.a.missing_localization,n),Object(_.a)(e,xa.a.localized,!c&&!n),e))}},{key:"render",value:function(){var e=this,t=wl(this.props.action.type).name,n=this.getClasses(),a=this.getAction(),r=ie.a[this.props.action.type]||ie.a.missing,i=xa.a[this.props.action.type]||xa.a.missing,o=!this.props.translating,s=!this.props.first&&!this.props.translating,l=this.context.config.mutable?L(this.handleActionClicked,function(){return e.props.selected}):{};return b.createElement("div",{id:"action-".concat(this.props.action.uuid),className:n,"data-spec":"action-container"},b.createElement("div",{className:xa.a.overlay,"data-spec":"action-overlay"}),b.createElement("div",Object.assign({},l,{"data-spec":"interactive-div"}),b.createElement(Jc,{__className:r,title:t,onRemoval:this.handleRemoval,showRemoval:o,showMove:s,onMoveUp:this.handleMoveUp,shouldCancelClick:function(){return e.props.selected}}),b.createElement("div",{className:xa.a.body+" "+i,"data-spec":"action-body"},this.props.render(a,this.context.config.endpoints))))}}]),t}(b.Component);nu.contextTypes={config:Ve};var au=Object(Hn.b)(function(e){var t=e.flowContext.definition.localization,n=e.editorState;return{language:n.language,translating:n.translating,localization:t}},function(e){return Object(de.bindActionCreators)({onOpenNodeEditor:gc,removeAction:oc,moveActionUp:sc},e)},null,{forwardRef:!0})(nu),ru=n(64),iu=n.n(ru),ou=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={visible:!1},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.setTimeout(function(){e.state.visible||e.setState({visible:!0})},100)}},{key:"render",value:function(){return b.createElement("div",{className:iu.a.drag_helper+" "+(this.state.visible?iu.a.visible:"")},b.createElement("div",{className:iu.a.arrow},b.createElement("div",{className:iu.a.tail}),b.createElement("div",{className:iu.a.head})),b.createElement("div",{className:iu.a.help_text},b.createElement(Dt.a,{i18nKey:"drag_helper"},"To connect nodes, ",b.createElement("span",{className:iu.a.bold},"drag")," from the red circle.")))}}]),t}(b.Component),su=function(e){return e.uuid+":"+e.destination_uuid},lu=n(173),cu=n.n(lu),uu=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},du=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={color:uu(e.color)},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return b.createElement("div",{className:cu.a.loading,style:{width:this.props.size*this.props.units*2,height:this.props.size}},Z(0,this.props.units).map(function(t){return b.createElement("div",{key:"ball_".concat(t),style:{borderRadius:e.props.square?"0":"50%",width:e.props.size,height:e.props.size,margin:e.props.size/3,animationDelay:"-".concat(1-t*(1/e.props.units),"s"),background:"rgba(".concat(e.state.color.r,",").concat(e.state.color.g,",").concat(e.state.color.b,", ").concat(1-t*(1/e.props.units),")")}})}))}}]),t}(b.Component),pu=n(32),hu=n.n(pu),mu=Xe.a.bind(hu.a),fu=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).timeout=void 0,n.hideDragHelper=void 0,n.pendingMessageFetch={},n.ele=void 0,n.state={confirmDelete:!1,recentMessages:null,fetchingRecentMessages:!1,showDragHelper:e.showDragHelper},Object(y.react)(Object(v.a)(n),{include:[/^on/,/^get/,/^handle/,/^connect/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getSourceId",value:function(){return"".concat(this.props.node.uuid,":").concat(this.props.exit.uuid)}},{key:"handleDisconnect",value:function(){this.setState({showDragHelper:!1})}},{key:"componentDidMount",value:function(){this.props.plumberMakeSource(this.getSourceId()),this.ele&&this.ele.addEventListener("disconnect",this.handleDisconnect),this.props.exit.destination_uuid&&this.connect()}},{key:"componentDidUpdate",value:function(e){this.props.exit.destination_uuid&&this.props.exit.destination_uuid===e.exit.destination_uuid||(this.connect(),this.state.confirmDelete&&this.setState({confirmDelete:!1})),this.state.showDragHelper&&e.showDragHelper&&!this.props.showDragHelper&&this.setState({showDragHelper:!1}),this.props.plumberUpdateClass(this.props.node,this.props.exit,"confirm-delete",this.state.confirmDelete)}},{key:"componentWillUnmount",value:function(){this.props.exit.destination_uuid&&this.props.plumberRemove(this.getSourceId()),this.ele&&this.ele.removeEventListener("disconnect",this.handleDisconnect)}},{key:"handleMouseDown",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"handleClick",value:function(e){var t=this;this.props.translating||(this.props.exit.destination_uuid?(e.preventDefault(),e.stopPropagation(),this.setState({confirmDelete:!0},function(){t.timeout=window.setTimeout(function(){t.setState({confirmDelete:!1})},2e3)})):(e.preventDefault(),e.stopPropagation(),this.state.showDragHelper||this.setState({showDragHelper:!0},function(){t.hideDragHelper&&window.clearTimeout(t.hideDragHelper),t.hideDragHelper=window.setTimeout(function(){t.setState({showDragHelper:!1})},3e3)})))}},{key:"onDisconnect",value:function(e){this.timeout&&window.clearTimeout(this.timeout),this.hideDragHelper&&window.clearTimeout(this.hideDragHelper),this.props.disconnectExit(this.props.node.uuid,this.props.exit.uuid)}},{key:"connect",value:function(){this.props.plumberConnectExit(this.props.node,this.props.exit)}},{key:"handleShowRecentMessages",value:function(){var e=this;this.props.recentMessages?this.setState({recentMessages:this.props.recentMessages}):this.setState({fetchingRecentMessages:!0},function(){var t,n,a;(t=e.context.config.endpoints.recents,n=e.props.exit,a=e.pendingMessageFetch,new Promise(function(e,r){return a.reject=r,it.a.get("".concat(t,"?exits=").concat(n.uuid,"&to=").concat(n.destination_uuid)).then(function(t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=t.data[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;n.push({text:l.text,sent:new Date(l.sent)})}}catch(c){r=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}e(t.data)}).catch(function(e){return r(e)})})).then(function(t){e.setState({recentMessages:t,fetchingRecentMessages:!1})}).catch(function(){})})}},{key:"handleHideRecentMessages",value:function(){this.pendingMessageFetch.reject&&(this.pendingMessageFetch.reject(),this.pendingMessageFetch={}),this.setState({fetchingRecentMessages:!1,recentMessages:null})}},{key:"getSegmentCount",value:function(){if(this.props.exit.destination_uuid){var e="count:".concat(this.props.exit.uuid,":").concat(this.props.exit.destination_uuid);return b.createElement("div",{style:{position:"relative"}},b.createElement(Xc,{key:e,count:this.props.segmentCount,containerStyle:hu.a.activity,countStyle:hu.a.count,keepVisible:!1,onMouseEnter:this.handleShowRecentMessages,onMouseLeave:this.handleHideRecentMessages}),this.getRecentMessages())}return null}},{key:"getName",value:function(){var e=this;if(this.props.translating){var t="",n="",a=!1;return this.props.categories.forEach(function(r){var i=z(r,e.props.localization,e.props.language);a=a||"name"in i.localizedKeys;var o=i.getObject();t+=n+o.name,n=", "}),{name:t,localized:a}}return{name:this.props.categories.map(function(e){return e.name}).join(", ")}}},{key:"getRecentMessages",value:function(){if(this.state.fetchingRecentMessages||null!==this.state.recentMessages){var e=this.state.recentMessages||[],t=0!==e.length,n=[hu.a.recent_messages],a="Recent Messages";return t||this.state.fetchingRecentMessages||(a="No Recent Messages",n.push(hu.a.no_recents)),b.createElement("div",{className:n.join(" ")},b.createElement("div",{className:hu.a.title},a),e.map(function(e,t){return b.createElement("div",{key:"recent_"+t,className:hu.a.message},b.createElement("div",{className:hu.a.text},e.text),b.createElement("div",{className:hu.a.sent},e.sent.toLocaleString()))}),null===this.state.recentMessages?b.createElement("div",{className:hu.a.loading},b.createElement(du,{size:10,units:6,color:"#999999"})):null)}return null}},{key:"render",value:function(){var e,t=this,n=this.getName(),a=n.name,r=n.localized,i=a?hu.a.name:"",o=this.props.exit.destination_uuid?" jtk-connected":"",s=mu(hu.a.endpoint,o),l=this.state.confirmDelete&&this.props.exit.hasOwnProperty("destination_uuid"),c=l&&this.context.config.mutable?b.createElement("div",Object.assign({className:hu.a.confirm_x+" fe-x"},L(this.onDisconnect,function(){return t.props.dragging}))):null,u=mu((e={},Object(_.a)(e,hu.a.exit,!0),Object(_.a)(e,"plumb-exit",!0),Object(_.a)(e,hu.a.translating,this.props.translating),Object(_.a)(e,hu.a.unnamed_exit,null==a),Object(_.a)(e,hu.a.missing_localization,a&&this.props.translating&&!r),Object(_.a)(e,hu.a.confirm_delete,l),e)),d=this.getSegmentCount(),p=this.context.config.mutable?L(this.handleClick,function(){return t.props.dragging},this.handleMouseDown):{};return b.createElement("div",{className:u},a?b.createElement("div",{className:i},a):null,b.createElement("div",Object.assign({ref:function(e){return t.ele=e}},p,{id:"".concat(this.props.node.uuid,":").concat(this.props.exit.uuid),className:s}),c),d,V(this.state.showDragHelper)(b.createElement(ou,null)))}}]),t}(b.PureComponent);fu.contextTypes={config:Ve};var vu=Object(Hn.b)(function(e,t){var n=e.flowContext.definition.localization,a=e.editorState,r=a.translating,i=a.language,o=a.dragActive,s=a.activity,l=null,c=su(t.exit);return c in(s.recentMessages||{})&&(l=s.recentMessages[c]),{dragging:o,segmentCount:s.segments[su(t.exit)]||0,translating:r,language:i,localization:n,recentMessages:l}},function(e){return Object(de.bindActionCreators)({disconnectExit:ac},e)})(fu),gu=n(174),_u=n(34),yu=n.n(_u);function bu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Ou=Xe.a.bind(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bu(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bu(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},ie.a,{},yu.a)),ku=function(e){function t(e,n){var a;return Object(p.a)(this,t),(a=Object(m.a)(this,Object(f.a)(t).call(this,e))).ele=void 0,a.firstAction=void 0,a.clicking=void 0,a.events=void 0,Object(y.react)(Object(v.a)(a),{include:[/Ref$/,/^on/,/^get/,/^handle/]}),a.events=n.config.mutable?L(a.onClick,a.handleShouldCancelClick):{},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleShouldCancelClick",value:function(){return this.props.selected}},{key:"eleRef",value:function(e){return this.ele=e}},{key:"getGhostListener",value:function(){var e=this;return function(t){var n=e.ele.getBoundingClientRect().width,a=t.pageX-n/2-15,r=t.pageY+e.ele.scrollTop-(e.props.containerOffset.top+20),i=e.ele.style;i.left=a+"px",i.top=r+"px",i.visibility=document.querySelector(".plumb-drop-hover")?"hidden":"visible"}}},{key:"componentDidMount",value:function(){if(this.props.plumberMakeTarget(this.props.renderNode.node.uuid),this.props.ghost){var e=this.getGhostListener();window.ghostListener=e,document.addEventListener("mousemove",e)}}},{key:"componentDidUpdate",value:function(e){if(!this.props.ghost)try{this.props.plumberRecalculate(this.props.renderNode.node.uuid);var t=!0,n=!1,a=void 0;try{for(var r,i=this.props.renderNode.node.exits[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;this.props.plumberRecalculate(this.props.renderNode.node.uuid+":"+o.uuid)}}catch(s){n=!0,a=s}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}}catch(l){}}},{key:"componentWillUnmount",value:function(){this.props.plumberRemove(this.props.renderNode.node.uuid)}},{key:"handleUUIDClicked",value:function(e){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e.currentTarget),t.removeAllRanges(),t.addRange(n),document.execCommand("copy"),t.removeAllRanges(),console.log(e.currentTarget.textContent+" copied to clipboard.")}},{key:"handleAddToNode",value:function(){this.props.onAddToNode(this.props.renderNode.node)}},{key:"onClick",value:function(e){this.props.onOpenNodeEditor({originalNode:this.props.renderNode})}},{key:"handleRemoval",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.removeNode(this.props.renderNode.node)}},{key:"getExits",value:function(){var e=this;return this.props.renderNode.node.exits?this.props.renderNode.node.exits.map(function(t,n){return b.createElement(vu,{key:t.uuid,node:e.props.renderNode.node,categories:Si(e.props.renderNode,t),exit:t,showDragHelper:e.props.onlyNode&&0===n,plumberMakeSource:e.props.plumberMakeSource,plumberRemove:e.props.plumberRemove,plumberConnectExit:e.props.plumberConnectExit,plumberUpdateClass:e.props.plumberUpdateClass})}):[]}},{key:"isSelected",value:function(){return this.props.selected}},{key:"hasMissing",value:function(){var e=Sl(this.props.renderNode);if((e===fe.split_by_run_result||e===fe.split_by_run_result_delimited)&&!(this.props.renderNode.ui.config.operand.id in this.props.results))return!0;if(this.props.renderNode.node.router){var t=this.props.renderNode.node.router.cases||[],n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;if(!uo(s.type))return!0}}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}}return!1}},{key:"isStartNodeVisible",value:function(){return this.props.startingNode}},{key:"renderDebug",value:function(){if(this.props.debug&&this.props.debug.showUUIDs)return b.createElement("span",{id:"uuid-".concat(this.props.renderNode.node.uuid),onClick:this.handleUUIDClicked,className:yu.a.uuid},this.props.renderNode.node.uuid)}},{key:"render",value:function(){var e,t=this,n=[],a=null;if(this.props.renderNode.node.actions){var r={ref:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return t.firstAction=e})};this.props.renderNode.node.actions.forEach(function(e,a){var i=wl(e.type);if(i.hasOwnProperty("component")&&i.component){var o=i.component;n.push(b.createElement(au,Object.assign({},r,{key:e.uuid,renderNode:t.props.renderNode,selected:t.props.selected,action:e,first:0===a,render:function(e){return b.createElement(o,Object.assign({},e,{languages:t.props.languages}))}})))}r={}}),a=n.length>0?b.createElement(gu.a,{enterAnimation:"fade",leaveAnimation:"fade",duration:300,easing:"ease-out"},n):null}var i=null,o=null,s=null,l=Sl(this.props.renderNode);if(l!==fe.execute_actions){var c=wl(l),u=c.name;Ei(this.props.renderNode.node)&&l===fe.split_by_contact_field&&this.props.renderNode.ui.config.operand.name&&(u="Split by ".concat(this.props.renderNode.ui.config.operand.name));var d=ji(this.props.renderNode.node);d&&(s=b.createElement("div",Object.assign({},this.events,{className:yu.a.save_result}),b.createElement("div",{className:yu.a.save_as},"Save as "),b.createElement("div",{className:yu.a.result_name},d))),null!==u||l!==fe.split_by_run_result&&l!==fe.split_by_run_result_delimited||(u=this.props.renderNode.ui.config.operand.id in this.props.results?"Split by ".concat(this.props.results[this.props.renderNode.ui.config.operand.id].name):"Missing ".concat(this.props.renderNode.ui.config.operand.id)),null===u&&(u=c.name),this.props.renderNode.node.actions&&this.props.renderNode.node.actions.length||(i=b.createElement("div",{style:{position:"relative"}},b.createElement("div",this.events,b.createElement(Jc,{__className:ie.a[this.hasMissing()?"missing":c.type],showRemoval:!this.props.translating,onRemoval:this.handleRemoval,shouldCancelClick:this.handleShouldCancelClick,title:u}))))}else!this.props.translating&&this.context.config.mutable&&(o=b.createElement("div",Object.assign({className:yu.a.add},L(this.handleAddToNode,this.handleShouldCancelClick)),b.createElement("span",{className:"fe-add"})));var p=this.getExits(),h=Ou((e={"plumb-drag":!0},Object(_.a)(e,yu.a.ghost,this.props.ghost),Object(_.a)(e,yu.a.flow_start,this.isStartNodeVisible()),Object(_.a)(e,yu.a.selected,this.isSelected()),Object(_.a)(e,yu.a.immutable,!this.context.config.mutable),e)),m=this.renderDebug();return b.createElement("div",{id:this.props.renderNode.node.uuid,className:"".concat(yu.a.node_container," ").concat(h),ref:this.eleRef},b.createElement("div",{className:yu.a.node},this.isStartNodeVisible()?b.createElement("div",{className:yu.a.flow_start_message},"Flow Start"):null,m,b.createElement(Xc,{count:this.props.activeCount,containerStyle:yu.a.active,countStyle:"",keepVisible:this.props.simulating,onClick:function(){t.context.config.onActivityClicked&&t.context.config.onActivityClicked(t.props.nodeUUID,t.props.activeCount)}}),b.createElement("div",{className:yu.a.cropped},i,a,s),b.createElement("div",{className:"".concat(yu.a.exit_table)},b.createElement("div",Object.assign({className:yu.a.exits},this.events),p),o)))}}]),t}(b.Component);ku.contextTypes={config:Ve};var Eu=Object(Hn.b)(function(e,t){var n=e.flowContext,a=n.nodes,r=n.definition,i=n.assetStore,o=i.results.items,s=i.languages.items,l=e.editorState,c=l.translating,u=l.debug,d=l.ghostNode,p=l.simulating,h=l.containerOffset,m=l.activity,f=null;if(d&&d.node.uuid===t.nodeUUID?f=d:t.nodeUUID in a&&(f=a[t.nodeUUID]),!f)throw Error("Couldn't find node for "+t.nodeUUID);return{results:o,languages:s,activeCount:m.nodes[t.nodeUUID]||0,containerOffset:h,translating:c,debug:u,definition:r,renderNode:f,simulating:p}},function(e){return Object(de.bindActionCreators)({onAddToNode:dc,onOpenNodeEditor:gc,removeNode:ic,mergeEditorState:Ql},e)},null,{forwardRef:!0})(ku),Cu=n(175),wu=n.n(Cu),Su=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e={content:{marginLeft:"auto",marginRight:"auto",marginTop:"40px",bottom:"initial",padding:"none",borderRadius:"none",outline:"none",width:this.props.width?this.props.width:"700px",border:"none"}};return b.createElement(wu.a,{ariaHideApp:!1,isOpen:this.props.show,onAfterOpen:this.props.onModalOpen,onRequestClose:this.props.onClose,style:e,shouldCloseOnOverlayClick:!1,contentLabel:"Modal"},this.props.children)}}]),t}(b.Component);function ju(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Nu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ju(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ju(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var xu,Pu=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(n),{include:[/^close/,/^update/,/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"updateLocalizations",value:function(e,t){this.props.onUpdateLocalizations(e,t)}},{key:"close",value:function(e){if(e){var t=ui(this.props.settings.originalNode);if(t){var n=this.props.nodes[t.nodeUUID],a=!0,r=!1,i=void 0;try{for(var o,s=n.node.exits[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;if(l.uuid===t.exitUUID){this.props.plumberConnectExit(n.node,l);break}}}catch(c){r=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}}}this.props.resetNodeEditingState(),this.props.updateUserAddingAction(!1)}},{key:"updateAction",value:function(e,t){this.props.onUpdateAction(e,t)}},{key:"updateRouter",value:function(e){this.props.onUpdateRouter(e)}},{key:"handleAddAsset",value:function(e,t){this.props.addAsset(e,t)}},{key:"render",value:function(){if(this.props.settings){var e=this.props.typeConfig;if(this.props.translating){var t=e.localization;if(t){var n={updateLocalizations:this.updateLocalizations,nodeSettings:this.props.settings,typeConfig:this.props.typeConfig,onClose:this.close,language:this.props.language};return b.createElement(Su,{width:"600px",show:!0},b.createElement(t,Nu({},n)))}}var a=e.form,r={assetStore:this.props.assetStore,completionSchema:this.props.completionSchema,addAsset:this.handleAddAsset,updateAction:this.updateAction,updateRouter:this.updateRouter,nodeSettings:this.props.settings,typeConfig:this.props.typeConfig,onTypeChange:this.props.handleTypeConfigChange,onClose:this.close};return b.createElement(Su,{width:"600px",show:!0},b.createElement(a,Nu({},r)))}return null}}]),t}(b.Component),Du=Object(Hn.b)(function(e){var t=e.flowContext,n=t.definition,a=t.nodes,r=t.assetStore,i=e.editorState,o=i.language,s=i.translating,l=i.completionSchema,c=e.nodeEditor;return{language:o,definition:n,nodes:a,translating:s,typeConfig:c.typeConfig,settings:c.settings,assetStore:r,completionSchema:l}},function(e){return Object(de.bindActionCreators)({addAsset:Jl,resetNodeEditingState:cc,mergeEditorState:Ql,handleTypeConfigChange:lc,onUpdateLocalizations:tc,onUpdateAction:uc,onUpdateRouter:vc,updateUserAddingAction:$t},e)})(Pu),Ru=(X(),function(){var e=new Date,t=e.getMinutes(),n=""+t;return t<10&&(n="0"+t),Math.abs(12-e.getHours())+":"+n}),Tu=function(e){return!!["msg_created","msg_received","ivr_created"].find(function(t){return t===e.type})},Au=function(e){return!!["msg_created","ivr_created"].find(function(t){return t===e.type})},Uu=n(25),Fu=n.n(Uu),Iu=n(149);!function(e){e[e.MT=0]="MT",e[e.MO=1]="MO"}(xu||(xu={}));var Mu,Lu=function(e){return e===xu.MO?Fu.a.msg_received:Fu.a.send_msg},zu=function(e){return b.createElement("div",{className:Fu.a.error},b.createElement("span",null,"Error: ",e))},Bu=function(e){return b.createElement("div",{key:e,className:Fu.a.info},b.createElement("span",null,e))},Vu=function(e,t,n){var a=t||[];return b.createElement("div",{className:Lu(n)},a.map(function(t){return b.createElement("div",{key:e+t},function(e){var t=e.indexOf(":");if(t>-1){var n=e.substr(0,t),a=e.substr(t+1);if(n.startsWith("audio"))return b.createElement("div",{className:Fu.a.audio_attachment},b.createElement("div",{className:Fu.a.media_player},b.createElement(er,{url:a})),b.createElement("div",{className:Fu.a.audio_text},"Audio Recording"));if(n.startsWith("image"))return b.createElement("img",{src:a,alt:"Attachment"});if(n.startsWith("geo"))return b.createElement("img",{src:Iu,alt:"Attachment"});if(n.startsWith("video"))return b.createElement("div",{className:Fu.a.video_attachment},b.createElement("video",{controls:!0,src:a}))}return null}(t))}),e?e.split("\n").map(function(e,t){return b.createElement("div",{key:X(),className:Fu.a.msg_text},e)}):null)},qu=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).state={detailsVisible:!1},n.showDetails=n.showDetails.bind(Object(v.a)(n)),n.getButtons=n.getButtons.bind(Object(v.a)(n)),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getButtons",value:function(){var e=this;return{primary:{name:"Ok",onClick:function(){e.setState({detailsVisible:!1})}}}}},{key:"showDetails",value:function(){this.setState({detailsVisible:!0})}},{key:"renderGroupChange",value:function(){var e=this.props.groups_added||this.props.groups_removed,t=this.props.groups_added?At.t("simulator.added_to_group","Added to "):At.t("simulator.removed_from_group","Removed from "),n=" ";return e.forEach(function(e){t+="".concat(n,'"').concat(e.name,'"'),n=", "}),Bu(t)}},{key:"renderEmail",value:function(){var e=this.props.to||this.props.addresses;return this.renderClickable(b.createElement("div",{className:Fu.a.info+" "+Fu.a.email},b.createElement(Dt.a,{i18nKey:"simulator.sent_email",values:{recipients:e.join(", "),subject:this.props.subject}},'Sent email to "[[recipients]]" with subject "[[subject]]"')),b.createElement(ce,{title:At.t("simulator.sent_email_dialog","Email Details"),headerClass:fe.send_email,buttons:this.getButtons(),noPadding:!0},b.createElement("div",{className:Fu.a.email_details},b.createElement("div",{className:Fu.a.to},At.t("simulator.sent_email.to","To"),": ",e.join(", ")),b.createElement("div",{className:Fu.a.subject},At.t("simulator.sent_email.subject","Subject"),": ",this.props.subject),b.createElement("div",{className:Fu.a.body},this.props.body))))}},{key:"renderHTTPRequest",value:function(e,t){return this.renderClickable(b.createElement("div",{className:Fu.a.info+" "+Fu.a.webhook},b.createElement("span",null,"Called ",t.url)),b.createElement(ce,{title:At.t("simulator.httplog_dialog","HTTP Request Details"),headerClass:e,buttons:this.getButtons(),noPadding:!0},b.createElement("div",{className:Fu.a.webhook_details},b.createElement("div",{className:""},t.request),b.createElement("div",{className:Fu.a.response},t.response))))}},{key:"renderWebhook",value:function(e){var t=this;return this.props.http_logs?b.createElement(b.Fragment,null,this.props.http_logs.map(function(n){return t.renderHTTPRequest(e,n)})):this.props.url?this.renderHTTPRequest(e,this.props):void 0}},{key:"renderClickable",value:function(e,t){return b.createElement("div",{key:this.props.step_uuid},b.createElement("div",{className:Fu.a.has_detail,onClick:this.showDetails},e),b.createElement(Su,{show:this.state.detailsVisible},b.createElement("div",{className:Fu.a.event_viewer},t)))}},{key:"renderClassification",value:function(){var e=this;return b.createElement("table",{className:Fu.a.classification},b.createElement("tbody",null,(this.props.extra.intents||[]).map(function(e){return b.createElement("tr",{key:e.name+e.confidence},b.createElement("td",null,e.name),b.createElement("td",null,"intent"),b.createElement("td",null,e.confidence.toFixed(3)))}),Object.keys(this.props.extra.entities||[]).map(function(t){return e.props.extra.entities[t].map(function(e){return t!==e.value?b.createElement("tr",{key:e.value+e.confidence},b.createElement("td",null,e.value),b.createElement("td",null,t),b.createElement("td",null,e.confidence.toFixed(3))):null})})))}},{key:"renderLogEvent",value:function(){if(this.props.extra&&this.props.extra.intents)return this.renderClassification();switch(this.props.type){case"msg_received":return Vu(this.props.msg.text,this.props.msg.attachments,xu.MO);case"msg_created":case"ivr_created":return Vu(this.props.msg.text,this.props.msg.attachments,xu.MT);case"error":case"failure":return zu(this.props.text);case"msg_wait":return Bu(At.t("simulator.msg_wait","Waiting for reply"));case"contact_groups_changed":return this.renderGroupChange();case"contact_urns_changed":return Bu("Added a URN for the contact");case"contact_field_changed":return Bu(At.t("simulator.contact_field_changed",'Set contact "[[field]]" to "[[value]]"',{field:this.props.field.name,value:this.props.value.text}));case"run_result_changed":return Bu(At.t("simulator.run_result_changed",'Set result "[[field]]" to "[[value]]"',{field:this.props.name,value:this.props.value}));case"contact_name_changed":return Bu(At.t("simulator.contact_name_changed",'Set contact name to "[[name]]"',{name:this.props.name}));case"email_created":case"email_sent":return this.renderEmail();case"broadcast_created":return Vu(this.props.translations[this.props.base_language].text,this.props.msg?this.props.msg.attachments:[],xu.MT);case"resthook_called":return Bu(At.t("simulator.resthook_called",'Triggered flow event "[[resthook]]"',{resthook:this.props.resthook}));case"classifier_called":return this.renderWebhook(fe.call_classifier);case"webhook_called":return this.renderWebhook(fe.call_webhook);case"flow_entered":return Bu(At.t("simulator.flow_entered",'Entered flow "[[flow]]"',{flow:this.props.flow.name}));case"session_triggered":return Bu(At.t("simulator.session_triggered",'Started somebody else in "[[flow]]"',{flow:this.props.flow.name}));case"contact_language_changed":return Bu(At.t("simulator.contact_language_changed",'Set preferred language to "[[language]]"',{language:this.props.language}));case"info":return Bu(this.props.text);case"environment_refreshed":return null;case"airtime_transferred":var e=this.props;return b.createElement(b.Fragment,null,this.renderWebhook(fe.transfer_airtime),Bu(At.t("simulator.airtime_transferred","Transferred [[amount]] [[currency]] to [[recipient]]",{amount:e.actual_amount,currency:e.currency,recipient:(t=e.recipient,t.split(":")[1])})))}var t;return console.log("Simulator render missing",this.props),null}},{key:"render",value:function(){return b.createElement("div",{className:Fu.a.evt},this.renderLogEvent())}}]),t}(b.Component),Hu=n(13),Ku=n.n(Hu),Gu=n(149),Wu="https://s3.amazonaws.com/floweditor-assets.temba.io/simulator/sim_image_a.jpg",Yu="https://s3.amazonaws.com/floweditor-assets.temba.io/simulator/sim_image_b.jpg",Qu="https://s3.amazonaws.com/floweditor-assets.temba.io/simulator/sim_image_c.jpg",Xu="https://s3.amazonaws.com/floweditor-assets.temba.io/simulator/sim_video_a.mp4",Zu="https://s3.amazonaws.com/floweditor-assets.temba.io/simulator/sim_video_a_thumb.jpg";!function(e){e.audio="audio",e.images="images",e.videos="videos",e.location="location",e.digit="digit",e.digits="digits",e.quickReplies="quickReplies"}(Mu||(Mu={}));var $u=function(e){function t(e,n){var a;return Object(p.a)(this,t),(a=Object(m.a)(this,Object(f.a)(t).call(this,e))).debug=[],a.flows=[],a.currentFlow=void 0,a.inputBox=void 0,a.drawerEle=void 0,a.bottom=void 0,a.state={active:!1,visible:!1,events:[],contact:{uuid:X(),urns:["tel:+12065551212"],fields:{},groups:[]},keypadEntry:"",drawerHeight:0,channel:X(),time:Ru(),waitingForHint:!1,drawerOpen:!1,attachmentOptionsVisible:!1,sprinting:!1},a.bottomRef=a.bottomRef.bind(Object(v.a)(a)),a.inputBoxRef=a.inputBoxRef.bind(Object(v.a)(a)),a.currentFlow=a.props.definition.uuid,Object(y.react)(Object(v.a)(a),{include:[/^on/,/^get/,/^handle/]}),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"bottomRef",value:function(e){return this.bottom=e}},{key:"inputBoxRef",value:function(e){this.inputBox=e}},{key:"updateActivity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.state.session){var t,n=null,a={},r={},i=!0,o=!1,s=void 0;try{for(var l,c=this.state.session.runs[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value,d=null,p=!0,h=!1,m=void 0;try{for(var f,v=u.path[Symbol.iterator]();!(p=(f=v.next()).done);p=!0){var g=f.value;if(n){var _=n+":"+g.node_uuid,y=a[_];y||(y=0),a[_]=++y}n=g.exit_uuid,d=g}}catch(w){h=!0,m=w}finally{try{p||null==v.return||v.return()}finally{if(h)throw m}}if("waiting"===u.status&&d){var b=r[d.node_uuid];b||(b=0),r[d.node_uuid]=++b,t=u.flow_uuid}}}catch(w){o=!0,s=w}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}var O=this.props.activity.recentMessages||{};for(var k in e){var E=O[k]||[];E=e[k].concat(E),O[k]=E}var C={segments:a,nodes:r,recentMessages:O};this.props.mergeEditorState({activity:C}),t&&t!==this.currentFlow&&(this.currentFlow=t)}}},{key:"updateEvents",value:function(e,t,n,a){var r=this;if(e&&e.length>0){for(var i=[],o=null,s=!1;e.length>0&&!s;){var l=e.shift();if(Tu(l)){s=!0;for(var c="",u="",d=t.runs.length-1;d>=0;d--){for(var p=t.runs[d].path,h=p.length-2;h>=0;h--)if(p[h].uuid===l.step_uuid){c=p[h].exit_uuid,u=p[h+1].node_uuid;break}if(c&&u){var m="".concat(c,":").concat(u),f={sent:new Date(l.created_on),text:l.msg.text};m in n?n[m].unshift(f):n[m]=[f]}}Au(l)&&l.msg.quick_replies&&(o=l.msg.quick_replies)}i.push(l)}var v={events:Yt()(this.state.events,{$push:i})};null!==o&&(v.quickReplies=o),this.scrollToBottom(),this.setState(v,function(){0===e.length?a():window.setTimeout(function(){r.updateEvents(e,t,n,a)},200)})}else a()}},{key:"updateRunContext",value:function(e,t){var n=this,a=this.state.active||e.events&&e.events.length>0;this.setState({quickReplies:[]},function(){if(!e.events||0===e.events.length&&t){var r=e.session.runs,i=r[r.length-1],o=i.path[i.path.length-1];e.events=[{msg:{uuid:X(),urn:n.state.contact.urns[0],text:t.text,attachments:t.attachments},type:"msg_created",created_on:(new Date).toISOString(),step_uuid:o.uuid}]}var s={};n.updateEvents(e.events,e.session,s,function(){var t=!1,r=!0,i=!1,o=void 0;try{for(var l,c=e.session.runs[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){if("waiting"===l.value.status){t=!0;break}}}catch(m){i=!0,o=m}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}var u=n.state.events;!t&&a&&(u=Yt()(n.state.events,{$push:[{type:"info",text:"Exited flow",created_on:new Date}]}));var d=e.session&&e.session.wait&&void 0!==e.session.wait.hint,p=null;if(d)switch(e.session.wait.hint.type){case"audio":p=Mu.audio;break;case"video":p=Mu.videos;break;case"image":p=Mu.images;break;case"location":p=Mu.location;break;case"digits":p=Mu.digit,1!==e.session.wait.hint.count&&(p=Mu.digits);break;default:console.log("Unknown hint",e.session.wait.hint.type)}var h=d;!p&&n.hasQuickReplies()&&(p=Mu.quickReplies,h=!0),n.setState({active:t,sprinting:!1,session:e.session,events:u,drawerOpen:h,drawerType:p,waitingForHint:d},function(){n.updateActivity(s),n.handleFocusUpdate()})})})}},{key:"startFlow",value:function(){var e=this,t=(new Date).toISOString(),n={uuid:X(),urns:["tel:+12065551212"],fields:{},groups:[],created_on:t};this.props.language&&(n.language=this.props.language.id),this.setState({sprinting:!0,drawerOpen:!1,attachmentOptionsVisible:!1,events:[]},function(){var a={contact:e.state.contact,flow:Sc(e.props.definition,e.props.nodes,!1),trigger:{type:"manual",environment:{date_format:"DD-MM-YYYY",time_format:"hh:mm",timezone:"America/New_York",languages:[]},contact:n,flow:{uuid:e.props.definition.uuid,name:e.props.definition.name},params:{},triggered_on:t}};it.a.post(_t(e.context.config.endpoints.simulateStart),JSON.stringify(a,null,2)).then(function(t){e.updateRunContext(t.data)})})}},{key:"resume",value:function(e,t){var n=this;(e&&0!==e.trim().length||t)&&("\\debug"!==e?"\\recalc"!==e?this.setState({sprinting:!0,attachmentOptionsVisible:!1,drawerOpen:!1},function(){var a=(new Date).toISOString(),r={text:e,uuid:X(),urn:n.state.session.contact.urns[0],attachments:t?[t]:[]},i={flow:Sc(n.props.definition,n.props.nodes,!1),session:n.state.session,resume:{type:"msg",msg:r,resumed_on:a,contact:n.state.session.contact}};it.a.post(_t(n.context.config.endpoints.simulateResume),JSON.stringify(i,null,2)).then(function(e){n.updateRunContext(e.data,r)}).catch(function(e){e.response.status;var t=Yt()(n.state.events,{$push:[{type:"error",text:e.response.status>499?"Server error, try again later":e.response.data.error}]});n.setState({events:t})})}):console.log("recal.."):console.log(JSON.stringify(this.debug,null,2)))}},{key:"onReset",value:function(e){this.startFlow()}},{key:"scrollToBottom",value:function(e){var t=this,n=e||0;this.bottom&&window.setTimeout(function(){t.bottom&&t.bottom.scrollIntoView(!1)},n)}},{key:"componentDidUpdate",value:function(e,t){var n=this;null!==this.drawerEle&&(t.drawerHeight===this.drawerEle.clientHeight&&t.drawerOpen===this.state.drawerOpen||this.setState({drawerHeight:this.drawerEle.clientHeight},function(){n.scrollToBottom(800)}))}},{key:"onKeyUp",value:function(e){if("Enter"===e.key){var t=e.target,n=t.value;t.value="",this.resume(n)}}},{key:"onToggle",value:function(e){var t=this,n=!this.state.visible;this.props.mergeEditorState({simulating:n}),this.setState({visible:n},function(){t.state.visible?(t.updateActivity(),0===t.state.events.length&&t.startFlow(),t.handleFocusUpdate()):window.setTimeout(function(){t.props.mergeEditorState({activity:t.props.liveActivity})},500)})}},{key:"handleFocusUpdate",value:function(){this.inputBox&&this.inputBox.focus()}},{key:"sendAttachment",value:function(e){var t=this;this.setState({drawerOpen:!1,attachmentOptionsVisible:!1},function(){window.setTimeout(function(){t.resume(null,e)},200)})}},{key:"getImageDrawer",value:function(){var e=this;return O.a.createElement("div",{className:Ku.a.drawer_items},O.a.createElement("div",{className:Ku.a.drawer_item,onClick:function(){e.sendAttachment("image/jpeg:"+Wu)}},O.a.createElement("img",{src:Wu,alt:"Attachment"})),O.a.createElement("div",{className:Ku.a.drawer_item,onClick:function(){e.sendAttachment("image/jpeg:"+Yu)}},O.a.createElement("img",{src:Yu,alt:"Attachment"})),O.a.createElement("div",{className:Ku.a.drawer_item,onClick:function(){e.sendAttachment("image/jpeg:"+Qu)}},O.a.createElement("img",{src:Qu,alt:"Attachment"})))}},{key:"getLocationDrawer",value:function(){var e=this;return O.a.createElement("div",{className:Ku.a.map_thumb,onClick:function(){e.sendAttachment("geo:2.904194,-79.003418")}},O.a.createElement("img",{src:Gu,alt:"Attachment"}))}},{key:"getAudioDrawer",value:function(){var e=this;return O.a.createElement("div",{className:Ku.a.audio_picker,onClick:function(){e.sendAttachment("audio/mp3:https://s3.amazonaws.com/floweditor-assets.temba.io/simulator/sim_audio_a.mp3")}},O.a.createElement("div",{className:Ku.a.audio_icon+" fe-mic"}),O.a.createElement("div",{className:Ku.a.audio_message},"Upload Audio"))}},{key:"getVideoDrawer",value:function(){var e=this;return O.a.createElement("div",{className:Ku.a.drawer_items},O.a.createElement("div",{className:Ku.a.drawer_item,onClick:function(){e.sendAttachment("video/mp4:"+Xu)}},O.a.createElement("img",{src:Zu,alt:"Attachment"})),O.a.createElement("div",{className:Ku.a.drawer_item,onClick:function(){e.sendAttachment("video/mp4:"+Xu)}},O.a.createElement("img",{src:Zu,alt:"Attachment"})),O.a.createElement("div",{className:Ku.a.drawer_item,onClick:function(){e.sendAttachment("video/mp4:"+Xu)}},O.a.createElement("img",{src:Zu,alt:"Attachment"})))}},{key:"getQuickRepliesDrawer",value:function(){var e=this;return O.a.createElement("div",{className:Ku.a.quick_replies},this.state.quickReplies.map(function(t){return O.a.createElement("div",{className:Ku.a.quick_reply,onClick:function(){e.resume(t)},key:"reply_".concat(t)},t)}))}},{key:"handleKeyPress",value:function(e,t){t?"#"===e?(this.resume(this.state.keypadEntry),this.setState({keypadEntry:""})):this.setState(function(t){return{keypadEntry:t.keypadEntry+=e}}):this.resume(e)}},{key:"getKeyRow",value:function(e,t){var n=this;return O.a.createElement("div",{className:Ku.a.row},e.map(function(e){return O.a.createElement("div",{key:"btn_"+e,onClick:function(){n.handleKeyPress(e,t)},className:Ku.a.key},e)}))}},{key:"getKeypadDrawer",value:function(e){return O.a.createElement("div",{className:Ku.a.keypad},e?O.a.createElement("div",{className:Ku.a.keypad_entry},this.state.keypadEntry):null,O.a.createElement("div",{className:Ku.a.keys},this.getKeyRow(["1","2","3"],e),this.getKeyRow(["4","5","6"],e),this.getKeyRow(["7","8","9"],e),this.getKeyRow(["*","0","#"],e)))}},{key:"getDrawerContents",value:function(){switch(this.state.drawerType){case Mu.location:return this.getLocationDrawer();case Mu.audio:return this.getAudioDrawer();case Mu.images:return this.getImageDrawer();case Mu.videos:return this.getVideoDrawer();case Mu.quickReplies:return this.getQuickRepliesDrawer();case Mu.digits:case Mu.digit:return this.getKeypadDrawer(this.state.drawerType===Mu.digits)}return null}},{key:"handleDrawerRef",value:function(e){return this.drawerEle=e}},{key:"getDrawer",value:function(){var e={};return this.state.drawerOpen?(e.bottom=50,this.state.waitingForHint&&(e.bottom=25,e.zIndex=150,e.paddingBottom=10)):e.bottom=-this.state.drawerHeight,O.a.createElement("div",{ref:this.handleDrawerRef,style:e,className:Ku.a.drawer+" "+(this.state.drawerOpen?Ku.a.drawer_visible:"")+" "+(this.state.attachmentOptionsVisible?"":Ku.a.forced)},this.getDrawerContents())}},{key:"hasQuickReplies",value:function(){return(this.state.quickReplies||[]).length>0}},{key:"handleHideAttachments",value:function(){var e=this;this.setState({attachmentOptionsVisible:!1,drawerOpen:!1},function(){e.hasQuickReplies()&&window.setTimeout(function(){e.showAttachmentDrawer(Mu.quickReplies)},300)})}},{key:"getAttachmentButton",value:function(e,t){var n=this;return O.a.createElement("div",{className:e,onClick:function(){n.showAttachmentDrawer(t)}})}},{key:"getAttachmentOptions",value:function(){return O.a.createElement("div",{className:Ku.a.attachment_buttons+" "+(this.state.attachmentOptionsVisible?Ku.a.visible:"")},O.a.createElement("div",{className:"fe-x",onClick:this.handleHideAttachments}),this.getAttachmentButton("fe-picture2",Mu.images),this.getAttachmentButton("fe-video",Mu.videos),this.getAttachmentButton("fe-mic",Mu.audio),this.getAttachmentButton("fe-map-marker",Mu.location))}},{key:"handleHideAttachmentDrawer",value:function(){this.setState({drawerOpen:!1})}},{key:"showAttachmentDrawer",value:function(e){var t=this;if(this.state.drawerOpen){if(e===this.state.drawerType)return;this.handleHideAttachmentDrawer(),window.setTimeout(function(){t.showAttachmentDrawer(e)},300)}else this.setState(function(t){return{drawerOpen:!0,drawerType:e}})}},{key:"render",value:function(){var e=this,t=[],n=!0,a=!1,r=void 0;try{for(var i,o=this.state.events[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;t.push(O.a.createElement(qu,Object.assign({},s,{key:s.type+"_"+String(s.created_on)})))}}catch(d){a=!0,r=d}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}var l=this.state.visible?"":Ku.a.sim_hidden,c=this.state.visible?Ku.a.tab_hidden:"",u={height:366-(this.state.drawerOpen?this.state.drawerHeight-20:0)};return this.state.drawerOpen&&this.state.waitingForHint&&(u.height+=25),O.a.createElement("div",{className:Ku.a.sim_container},O.a.createElement("div",null,O.a.createElement("div",{id:"simulator",className:Ku.a.simulator+" "+l,key:"sim"},O.a.createElement("div",{className:Ku.a.screen},O.a.createElement("div",{className:Ku.a.header},O.a.createElement("div",{className:Ku.a.close+" fe-x",onClick:this.onToggle})),O.a.createElement("div",{className:Ku.a.messages,style:u},t,O.a.createElement("div",{id:"bottom",style:{float:"left",clear:"both",marginTop:20},ref:this.bottomRef})),O.a.createElement("div",{className:Ku.a.controls},O.a.createElement("input",{ref:this.inputBoxRef,type:"text",onKeyUp:this.onKeyUp,disabled:this.state.sprinting,placeholder:this.state.active?"Enter message":"Press home to start again"}),O.a.createElement("div",{className:Ku.a.show_attachments_button},O.a.createElement("div",{className:"fe-paperclip",onClick:function(){e.setState({attachmentOptionsVisible:!0,drawerOpen:!1})}}))),this.getAttachmentOptions(),this.getDrawer(),O.a.createElement("div",{className:Ku.a.footer},O.a.createElement("span",{className:Ku.a.reset+" "+(this.state.active?Ku.a.active:Ku.a.inactive),onClick:this.onReset}))))),O.a.createElement("div",{className:Ku.a.simulator_tab+" "+c,onClick:this.onToggle},O.a.createElement("div",{className:Ku.a.simulator_tab_icon+" fe-smartphone"}),O.a.createElement("div",{className:Ku.a.simulator_tab_text},"Run in",O.a.createElement("br",null),"Simulator")))}}]),t}(O.a.Component);$u.contextTypes={config:Ve};var Ju=Object(Hn.b)(function(e){var t=e.flowContext,n=t.definition,a=t.nodes,r=t.assetStore,i=e.editorState;return{liveActivity:i.liveActivity,activity:i.activity,assetStore:r,definition:n,nodes:a,language:i.language}},function(e){return Object(de.bindActionCreators)({},e)})($u),ed=n(124),td=n.n(ed),nd=n(33),ad=n.n(nd);function rd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var id=At.t("sticky.title","New Note"),od=At.t("sticky.body","..."),sd={yellow:ad.a.yellow,blue:ad.a.blue,green:ad.a.green,purple:ad.a.purple,gray:ad.a.gray},ld=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).dragging=!1,n.ele=void 0,n.debounceTextChanges=void 0,n.showConfirmation=void 0,n.DEFUALT_TITLE="New Note",n.DEFUALT_BODY="...",Object(y.react)(Object(v.a)(n),{include:[/^on/,/^get/,/^is/,/^handle/]}),n.state={title:n.props.sticky.title,body:n.props.sticky.body,color:n.props.sticky.color,showConfirmation:!1},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"isSelected",value:function(){return this.props.selected}},{key:"onRef",value:function(e){return this.ele=e}},{key:"componentWillUnmount",value:function(){this.showConfirmation&&window.clearTimeout(this.showConfirmation),this.debounceTextChanges&&window.clearTimeout(this.debounceTextChanges)}},{key:"handleDrag",value:function(e){}},{key:"handleDragStop",value:function(e){var t=T(e.finalPos[0],e.finalPos[1]),n=t.left,a=t.top;this.ele.style.left="".concat(n,"px"),this.ele.style.top="".concat(a,"px"),this.props.sticky.position={left:n,top:a},this.props.updateSticky(this.props.uuid,this.props.sticky)}},{key:"onUpdateText",value:function(){var e=this;this.debounceTextChanges&&window.clearTimeout(this.debounceTextChanges),this.debounceTextChanges=window.setTimeout(function(){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rd(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rd(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.props.sticky);t.title=e.state.title,t.body=e.state.body,e.props.updateSticky(e.props.uuid,t),e.debounceTextChanges=null},2e3)}},{key:"handleChangeTitle",value:function(e){this.setState({title:e.currentTarget.value}),this.onUpdateText()}},{key:"handleChangeBody",value:function(e){this.setState({body:e.currentTarget.value}),this.onUpdateText()}},{key:"handleClickRemove",value:function(e){var t=this;this.state.showConfirmation?this.props.updateSticky(this.props.uuid,null):(this.setState({showConfirmation:!0}),this.showConfirmation=window.setTimeout(function(){t.setState({showConfirmation:!1})},2e3))}},{key:"handleChangeColor",value:function(e){this.props.sticky.color=e,this.props.updateSticky(this.props.uuid,this.props.sticky),this.setState({color:e})}},{key:"handleSelectForValue",value:function(e,t){e.value===t&&window.setTimeout(function(){e.select()},0)}},{key:"handleTitleFocused",value:function(e){this.handleSelectForValue(e.currentTarget,id)}},{key:"handleBodyFocused",value:function(e){this.handleSelectForValue(e.currentTarget,od)}},{key:"getColorChooser",value:function(){var e=this;return b.createElement("div",{className:ad.a.color_chooser_container},b.createElement("div",{className:ad.a.color_chooser},Object.keys(sd).map(function(t){return b.createElement("div",{key:e.props.uuid+t,onClick:function(){e.handleChangeColor(t)},className:ad.a.color_option+" "+sd[t]})})))}},{key:"render",value:function(){var e=[ad.a.title_wrapper];this.state.showConfirmation&&e.push(ad.a.removal);var t=[ad.a.sticky_container];this.props.sticky.color||(this.props.sticky.color="yellow");var n=[ad.a.sticky];this.isSelected()&&n.push(ad.a.selected),t.push(sd[this.props.sticky.color]);var a=this.getColorChooser();return b.createElement("div",{key:this.props.uuid,className:t.join(" "),"data-spec":"sticky-container",ref:this.onRef,id:this.props.uuid},b.createElement("div",{className:n.join(" ")},b.createElement("div",{className:e.join(" ")},b.createElement("div",{className:ad.a.remove_button,onClick:this.handleClickRemove},b.createElement("span",{className:"fe-x"})),b.createElement("div",{className:ad.a.confirmation},"Remove?"),b.createElement(td.a,{className:ad.a.title,value:this.state.title,onChange:this.handleChangeTitle,onFocusCapture:this.handleTitleFocused})),b.createElement("div",{className:ad.a.body_wrapper},b.createElement(td.a,{className:ad.a.body,value:this.state.body,onChange:this.handleChangeBody,onFocusCapture:this.handleBodyFocused}),a)))}}]),t}(b.Component),cd=Object(Hn.b)(function(e){return{definition:e.flowContext.definition}},function(e){return Object(de.bindActionCreators)({updateSticky:fc},e)},null,{forwardRef:!1})(ld),ud=n(332).jsPlumb.importDefaults,dd={anchor:["Continuous",{shape:"Dot",faces:["top","left","right"]}],endpoint:["Dot",{radius:13,cssClass:"plumb-endpoint",hoverClass:"plumb-endpoint-hover"}],dropOptions:{tolerance:"touch",hoverClass:"plumb-drop-hover",isTarget:!1},dragAllowedWhenFull:!1,deleteEndpointsOnEmpty:!0,isTarget:!1},pd={anchor:"BottomCenter",maxConnections:1,dragAllowedWhenFull:!1,deleteEndpointsOnEmpty:!0,isSource:!0},hd=function(e,t){return["Continuous",{shape:"Dot",faces:e.getBoundingClientRect().bottom+P/3<t.getBoundingClientRect().top?["top"]:["right","left"]}]},md=["Flowchart",{stub:12,midpoint:.75,alwaysRespectStubs:!1,gap:[0,5],cornerRadius:3}],fd=function(){function e(){var t=this;Object(p.a)(this,e),this.jsPlumb=void 0,this.pendingConnections={},this.pendingConnectionTimeout=void 0,this.animateInterval=null,this.jsPlumb=ud({DragOptions:{cursor:"pointer",zIndex:1e3},DropOptions:{tolerance:"touch",hoverClass:"plumb-hover"},Endpoint:"Blank",EndpointStyle:{strokeStyle:"transparent"},PaintStyle:{strokeWidth:3.5},ConnectionsDetachable:!0,Connector:md,ConnectionOverlays:[["PlainArrow",{location:.999,width:12,length:12,cssClass:"jtk-arrow"}]],Container:"editor-container"}),this.debug=this.debug.bind(this),this.setSourceEnabled=this.setSourceEnabled.bind(this),this.makeSource=this.makeSource.bind(this),this.makeTarget=this.makeTarget.bind(this),this.connectExit=this.connectExit.bind(this),this.setDragSelection=this.setDragSelection.bind(this),this.clearDragSelection=this.clearDragSelection.bind(this),this.removeFromDragSelection=this.removeFromDragSelection.bind(this),this.cancelDurationRepaint=this.cancelDurationRepaint.bind(this),this.remove=this.remove.bind(this),this.repaintForDuration=this.repaintForDuration.bind(this),this.repaintFor=this.repaintFor.bind(this),this.handlePendingConnections=this.handlePendingConnections.bind(this),this.checkForPendingConnections=this.checkForPendingConnections.bind(this),this.connect=this.connect.bind(this),this.bind=this.bind.bind(this),this.repaint=this.repaint.bind(this),this.recalculate=this.recalculate.bind(this),this.recalculateUUIDs=this.recalculateUUIDs.bind(this),this.reset=this.reset.bind(this),this.updateClass=this.updateClass.bind(this),window.onresize=function(){return t.jsPlumb.repaintEverything()}}return Object(h.a)(e,[{key:"debug",value:function(){return this.jsPlumb}},{key:"setSourceEnabled",value:function(e,t){this.jsPlumb.setSourceEnabled(e,t)}},{key:"makeSource",value:function(e){return this.jsPlumb.makeSource(e,pd)}},{key:"makeTarget",value:function(e){this.jsPlumb.makeTarget(e,dd)}},{key:"connectExit",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.connect("".concat(e.uuid,":").concat(t.uuid),t.destination_uuid,n,e.exits.findIndex(function(e){return e.uuid===t.uuid}),e.exits.length)}},{key:"updateClass",value:function(e,t,n,a){var r="".concat(e.uuid,":").concat(t.uuid),i=this.jsPlumb.select({source:r});a?i.addClass(n):i.removeClass(n)}},{key:"removeFromDragSelection",value:function(e){this.jsPlumb.removeFromDragSelection(e)}},{key:"setDragSelection",value:function(e){var t=this;this.cancelDurationRepaint(),this.jsPlumb.clearDragSelection(),Object.keys(e).forEach(function(e){return t.jsPlumb.addToDragSelection(e)})}},{key:"clearDragSelection",value:function(){this.jsPlumb.clearDragSelection()}},{key:"cancelDurationRepaint",value:function(){this.animateInterval&&(window.clearInterval(this.animateInterval),this.animateInterval=null)}},{key:"repaintForDuration",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;this.cancelDurationRepaint();var n=t/10,a=0;this.animateInterval=window.setInterval(function(){e.jsPlumb.repaintEverything(),a++>n&&window.clearInterval(e.animateInterval)},10)}},{key:"repaintFor",value:function(e){var t=this;window.setInterval(function(){t.jsPlumb.repaintEverything()},1)}},{key:"handlePendingConnections",value:function(){var e=this,t={};for(var n in this.jsPlumb.batch(function(){var n=Object.keys(e.pendingConnections).length;for(var a in n>1&&console.log("batching "+n+" connections"),e.pendingConnections)if(e.pendingConnections.hasOwnProperty(a)){var r=e.pendingConnections[a],i=r.source,o=r.target,s=r.className,l=r.slot,c=r.totalSlots,u=o?["Bottom",hd(document.getElementById(i),document.getElementById(o))]:[];if(null!=i){e.jsPlumb.select({source:i}).delete({fireEvent:!1});var d=c<5?.75:.35,p=d+.15*l;l>c/2&&(p=d-.05+.15*(c-l)),p=Math.max(Math.min(.9,p),.1);var h=[].concat(md);h[1].midpoint=p,null!=o&&(s?e.jsPlumb.connect({source:i,target:o,anchors:u,fireEvent:!1,cssClass:s,detachable:!1,connector:h}):e.jsPlumb.connect({source:i,target:o,anchors:u,fireEvent:!1,cssClass:s,connector:h}))}null!=o&&(t[o]=!0),delete e.pendingConnections[a]}}),t)t.hasOwnProperty("target")&&this.recalculate(n)}},{key:"checkForPendingConnections",value:function(){var e=this;this.pendingConnectionTimeout&&window.clearTimeout(this.pendingConnectionTimeout),this.pendingConnectionTimeout=window.setTimeout(function(){e.handlePendingConnections()},0)}},{key:"connect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.pendingConnections["".concat(e,":").concat(t,":").concat(n)]={source:e,target:t,className:n,slot:a,totalSlots:r},this.checkForPendingConnections()}},{key:"bind",value:function(e,t){return this.jsPlumb.bind(e,t)}},{key:"repaint",value:function(e){e?(this.jsPlumb.recalculateOffsets(e),this.jsPlumb.repaint(e)):(this.jsPlumb.recalculateOffsets(),this.jsPlumb.repaintEverything())}},{key:"remove",value:function(e){this.jsPlumb.isSource(e)?(this.jsPlumb.unmakeSource(e),this.jsPlumb.remove(e)):this.jsPlumb.isTarget(e)&&this.jsPlumb.deleteConnectionsForElement(e)}},{key:"recalculateUUIDs",value:function(e){var t=this;this.jsPlumb.batch(function(){e.forEach(function(e){var n=t.jsPlumb.getConnections({target:e}).concat(t.jsPlumb.getConnections({source:e})),a=!0,r=!1,i=void 0;try{for(var o,s=n[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;l.endpoints[1].setAnchor(hd(l.endpoints[0].element,l.endpoints[1].element))}}catch(c){r=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}t.jsPlumb.revalidate(e)})})}},{key:"recalculate",value:function(e){this.jsPlumb.revalidate(e)}},{key:"reset",value:function(){this.jsPlumb.reset()}}]),e}(),vd=n(14),gd=function(){function e(t,n){Object(p.a)(this,e),this.props=void 0,this.state=void 0,this.props=t,this.state=n||{showUUIDs:!1}}return Object(h.a)(e,[{key:"showUUIDs",value:function(){var e=vd(this.state,{$merge:{showUUIDs:!0}});return this.props.mergeEditorState({debug:e}),e}}]),e}(),_d=n(176),yd=n.n(_d),bd=3,Od=function(e){function t(e,n){var a;return Object(p.a)(this,t),(a=Object(m.a)(this,Object(f.a)(t).call(this,e,n))).Plumber=void 0,a.ele=void 0,a.nodeContainerUUID=void 0,a.ghost=void 0,a.nodeContainerUUID=X(),a.Plumber=new fd,n.config.debug&&(window.fe=new gd(e,a.props.editorState.debug)),Object(y.react)(Object(v.a)(a),{include:[/Ref$/,/^on/,/^is/,/^get/]}),H("RenderAndPlumb"),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"onRef",value:function(e){return this.ele=e}},{key:"ghostRef",value:function(e){return this.ghost=e}},{key:"componentDidMount",value:function(){var e=this;this.Plumber.bind("connection",function(t){return e.props.updateConnection(t.sourceId,t.targetId)}),this.Plumber.bind("beforeDrag",function(t){e.beforeConnectionDrag(t)}),this.Plumber.bind("connectionDrag",function(t){e.props.onConnectionDrag(t,e.context.config.flowType)}),this.Plumber.bind("connectionDragStop",function(t){return e.onConnectorDrop(t)}),this.Plumber.bind("beforeStartDetach",function(t){return!e.props.editorState.translating&&e.context.config.mutable}),this.Plumber.bind("beforeDetach",function(e){return!0}),this.Plumber.bind("beforeDrop",function(t){return e.onBeforeConnectorDrop(t)});var t={left:0,top:0};this.ele&&(t=this.ele.getBoundingClientRect()),this.props.mergeEditorState({containerOffset:{left:t.left,top:t.top+window.scrollY}}),window.setTimeout(function(){return e.Plumber.repaint()},500)}},{key:"componentWillUnmount",value:function(){this.Plumber.reset()}},{key:"UNSAFE_componentWillUpdate",value:function(e){e.editorState.activityInterval===this.props.editorState.activityInterval&&5e3!==this.props.editorState.activityInterval&&this.props.mergeEditorState({activityInterval:5e3})}},{key:"onBeforeConnectorDrop",value:function(e){this.props.resetNodeEditingState();var t=e.sourceId.split(":")[0];try{Cc(this.props.nodes,t,e.targetId)}catch(n){return!1}return!0}},{key:"onConnectorDrop",value:function(e){var t=this.props.editorState.ghostNode;if(q(t)&&!function(e){return e.suspendedElementId===e.targetId&&null!==e.source}(e)){this.Plumber.recalculate(t.node.uuid);var n=ui(t);this.Plumber.connect(n.nodeUUID+":"+n.exitUUID,t.node.uuid);var a=this.ghost&&T(this.ghost.ele.offsetLeft,this.ghost.ele.offsetTop)||{left:0,top:0},r=a.left,i=a.top;this.props.editorState.ghostNode.ui.position={left:r,top:i};var o=null;t.node.actions&&1===t.node.actions.length&&(o=t.node.actions[0]),this.props.onOpenNodeEditor({originalNode:t,originalAction:o})}return document.removeEventListener("mousemove",window.ghostListener),!0}},{key:"beforeConnectionDrag",value:function(e){return e.source&&e.source.dispatchEvent(new Event("disconnect")),!this.props.editorState.translating}},{key:"getNodes",value:function(){var e=this,t=1===Object.keys(this.props.nodes).length;return jc(this.props.nodes).map(function(n,a){return{uuid:n.node.uuid,position:n.ui.position,ele:function(r){return b.createElement(Eu,{onlyNode:t,startingNode:0===a,selected:r,key:n.node.uuid,"data-spec":"node",nodeUUID:n.node.uuid,plumberMakeTarget:e.Plumber.makeTarget,plumberRemove:e.Plumber.remove,plumberRecalculate:e.Plumber.recalculate,plumberMakeSource:e.Plumber.makeSource,plumberConnectExit:e.Plumber.connectExit,plumberUpdateClass:e.Plumber.updateClass})}}})}},{key:"getStickies",value:function(){var e=this.props.definition._ui.stickies||{};return Object.keys(e).map(function(t){return{uuid:t,ele:function(n){return b.createElement(cd,{key:t,uuid:t,sticky:e[t],selected:n})},position:e[t].position}})}},{key:"getDragNode",value:function(){return q(this.props.editorState.ghostNode)?b.createElement("div",{"data-spec":"ghost-node",key:this.props.editorState.ghostNode.node.uuid,style:{position:"absolute",display:"block",visibility:"hidden"}},b.createElement(Eu,{onlyNode:!1,selected:!1,startingNode:!1,ref:this.ghostRef,ghost:!0,nodeUUID:this.props.editorState.ghostNode.node.uuid,plumberMakeTarget:this.Plumber.makeTarget,plumberRemove:this.Plumber.remove,plumberRecalculate:this.Plumber.recalculate,plumberMakeSource:this.Plumber.makeSource,plumberConnectExit:this.Plumber.connectExit,plumberUpdateClass:this.Plumber.updateClass})):null}},{key:"getSimulator",value:function(){return V(this.context.config.endpoints&&this.context.config.endpoints.simulateStart)(b.createElement(Ju,{key:"simulator",mergeEditorState:this.props.mergeEditorState}))}},{key:"getNodeEditor",value:function(){return V(null!==this.props.nodeEditorSettings)(b.createElement(Du,{key:"node-editor",plumberConnectExit:this.Plumber.connectExit,plumberRepaintForDuration:this.Plumber.repaintForDuration}))}},{key:"isClickOnCanvas",value:function(e){return e.target.id===this.nodeContainerUUID}},{key:"onDoubleClick",value:function(e){if(this.isClickOnCanvas(e)){var t=T(e.pageX-this.props.editorState.containerOffset.left-100+R,e.pageY-this.props.editorState.containerOffset.top-2*R-40),n=t.left,a=t.top;this.props.updateSticky(X(),{position:{left:n,top:a},title:id,body:od})}}},{key:"getEmptyFlow",value:function(){var e=this;return b.createElement("div",{key:"create_node",className:yd.a.empty_flow},b.createElement(Dt.a,{i18nKey:"empty_flow_message"},b.createElement("h1",null,"Let's get started"),b.createElement("div",null,"We recommend starting your flow by sending a message. This message will be sent to anybody right after they join the flow. This is your chance to send a single message or ask them a question.")),b.createElement(ae,{name:"Create Message",onClick:function(){var t=Nc(null,null,1,e.context.config.flowType);e.props.onOpenNodeEditor({originalNode:t,originalAction:t.node.actions[0]})}}))}},{key:"render",value:function(){var e=this,t=this.getNodes(),n=[];n=0===t.length?[this.getEmptyFlow()]:[this.getSimulator(),this.getDragNode()];var a=this.getStickies().concat(t);return b.createElement("div",{onDoubleClick:this.onDoubleClick,ref:this.onRef},b.createElement(Wc,{mutable:this.context.config.mutable,draggingNew:!!this.props.editorState.ghostNode&&!this.props.nodeEditorSettings,onDragging:function(t){t.forEach(function(n){n in e.props.nodes&&e.props.nodes[n].node.exits.forEach(function(e){e.destination_uuid&&t.push(n+":"+e.uuid)})}),e.Plumber.recalculateUUIDs(t)},uuid:this.nodeContainerUUID,dragActive:this.props.editorState.dragActive,mergeEditorState:this.props.mergeEditorState,onRemoveNodes:this.props.onRemoveNodes,draggables:a,onUpdatePositions:this.props.onUpdateCanvasPositions},n,this.getNodeEditor()))}}]),t}(b.Component);Od.contextTypes={config:Ve};var kd=Object(Hn.b)(function(e){var t=e.flowContext,n=t.definition,a=t.dependencies,r=t.nodes,i=e.editorState;return{nodeEditorSettings:e.nodeEditor.settings,definition:n,nodes:r,dependencies:a,editorState:i}},function(e){return Object(de.bindActionCreators)({mergeEditorState:Ql,resetNodeEditingState:cc,onConnectionDrag:mc,onOpenNodeEditor:gc,onUpdateCanvasPositions:hc,onRemoveNodes:pc,updateConnection:rc,updateSticky:fc},e)})(Od),Ed=n(65),Cd=n.n(Ed),wd=n(87),Sd=n.n(wd),jd=function(e){function t(e,n){var a;return Object(p.a)(this,t),a=Object(m.a)(this,Object(f.a)(t).call(this,e,n)),Object(y.react)(Object(v.a)(a),{include:[/^handle/]}),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleLanguageChanged",value:function(e){this.props.handleLanguageChange(e)}},{key:"handleLanguageSort",value:function(e,t){return"base"===e.id?-1:"base"===t.id?1:void 0!==e.order&&void 0!==t.order?e.order-t.order:e.name.localeCompare(t.name)}},{key:"render",value:function(){var e=this;if(!this.props.language)return null;var t=Object.keys(this.props.languages.items).map(function(t){return e.props.languages.items[t]}).sort(this.handleLanguageSort);return 1===t.length?null:b.createElement("div",{className:"language-selector"},t.map(function(t,n){return b.createElement("div",{key:"lang_"+t.id,className:Sd.a.language},n>0?b.createElement("div",{className:Sd.a.separator},"|"):null,b.createElement("div",{className:Sd.a.language_link+" "+(e.props.language.id===t.id?Sd.a.active:""),onClick:function(){e.handleLanguageChanged(t)}},t.name))}))}}]),t}(b.Component),Nd=Object(Hn.b)(function(e){var t=e.flowContext.assetStore,n=e.editorState.language;return{languages:t.languages,language:n}},function(e){return Object(de.bindActionCreators)({handleLanguageChange:ec},e)})(jd),xd=n(50),Pd=n.n(xd),Dd=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).poppedEle=void 0,n.state={width:400},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(){this.state.width!==this.poppedEle.offsetWidth&&this.setState({width:this.poppedEle.offsetWidth})}},{key:"handlePoppedRef",value:function(e){return this.poppedEle=e}},{key:"handleTabClick",value:function(){this.props.onShow()}},{key:"handleClose",value:function(){this.props.onHide()}},{key:"render",value:function(){return b.createElement("div",{className:Pd.a.pop_wrapper+" "+(this.props.visible?Pd.a.visible:""),style:{right:-this.state.width,top:this.props.top}},b.createElement("div",{className:Pd.a.tab_wrapper},b.createElement("div",{className:Pd.a.tab,style:{background:this.props.color},onClick:this.handleTabClick},b.createElement("div",{className:Pd.a.icon},b.createElement("span",{className:this.props.icon})),b.createElement("div",{className:Pd.a.label},this.props.label))),b.createElement("div",{ref:this.handlePoppedRef,className:Pd.a.popped,style:{borderColor:this.props.color,right:this.props.visible?15+this.state.width:0,top:-100}},b.createElement("div",{className:Pd.a.header,style:{background:this.props.color}},b.createElement("div",{className:Pd.a.close+" fe-x",onClick:this.handleClose}),b.createElement("div",{className:Pd.a.header_label},this.props.header)),b.createElement(b.Fragment,null,this.props.children)))}}]),t}(b.Component),Rd=n(177),Td=n.n(Rd),Ad=n(41),Ud=n.n(Ad),Fd=Xe.a.bind(Ud.a),Id=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).onRevisionClicked=function(e){return function(t){t.stopPropagation(),t.preventDefault(),gt(n.props.assetStore.revisions,e.id).then(function(t){n.props.loadFlowDefinition(t,n.props.assetStore),n.setState({revision:e})})}},n.onRevertClicked=function(e){return function(e){e.stopPropagation(),e.preventDefault(),n.props.createNewRevision(),n.setState({visible:!1,revision:null})}},n.state={revisions:[],revision:null,definition:null,visible:!1},Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"handleUpdateRevisions",value:function(){var e=this;if(null!==this.props.assetStore){var t=this.props.assetStore.revisions;return ut(t.endpoint,t.type,t.id||"id").then(function(t){t.length>0&&(t[0].content.current=!0),e.setState({revisions:t})})}}},{key:"handleTabClicked",value:function(){var e=this;this.setState(function(e){return{visible:!e.visible}},function(){e.state.visible?e.handleUpdateRevisions():e.state.revision&&e.state.revision.id!==e.state.revisions[0].id&&gt(e.props.assetStore.revisions,e.state.revisions[0].id).then(function(t){e.props.loadFlowDefinition(t,e.props.assetStore),e.setState({revision:null})})})}},{key:"render",value:function(){var e,t=this,n=Fd((e={},Object(_.a)(e,Ud.a.visible,this.state.visible),Object(_.a)(e,Ud.a.simulating,this.props.simulating),e));return O.a.createElement("div",{className:n},O.a.createElement("div",{className:Ud.a.mask}),O.a.createElement(Dd,{header:At.t("revisions.header","Revisions"),color:"#8e5ea7",icon:"fe-time",label:At.t("revisions.label","Revision History"),top:"360px",visible:this.state.visible,onShow:this.handleTabClicked,onHide:this.handleTabClicked},O.a.createElement("div",{className:Ud.a.explorer_wrapper},O.a.createElement("div",{className:Ud.a.explorer},O.a.createElement("div",{className:Ud.a.revisions},this.state.revisions.map(function(e){var n=e.content,a=t.state.revision&&e.id===t.state.revision.id,r=n.current||a?Ud.a.selected:"";return O.a.createElement("div",{className:Ud.a.revision+" "+r,key:"revision_"+e.id,onClick:t.onRevisionClicked(e)},V(n.current)(O.a.createElement("div",{className:Ud.a.button+" "+Ud.a.current},"current")),V(a&&!n.current)(O.a.createElement("div",{onClick:t.onRevertClicked(e),className:Ud.a.button},"revert")),O.a.createElement("div",{className:Ud.a.created_on},Td()(new Date(n.created_on),"mmmm d, yyyy, h:MM TT",t.props.utc)),O.a.createElement("div",{className:Ud.a.email},n.user.name||n.user.email))}))))))}}]),t}(O.a.Component),Md=n(178),Ld=n(179),zd=n.n(Ld),Bd=Object(de.combineReducers)({flowContext:Ce,editorState:Vl,nodeEditor:Jt}),Vd={flowContext:be,editorState:Bl,nodeEditor:Xt},qd=[zd.a];function Hd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Kd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hd(n,!0).forEach(function(t){Object(_.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hd(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Gd=n(333).default,Wd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vd;return Object(de.createStore)(Bd,e,Object(Md.composeWithDevTools)(de.applyMiddleware.apply(void 0,qd)))}(),Yd={config:Ve},Qd=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(y.react)(Object(v.a)(n),{include:[/^handle/]}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.context.config,t=e.endpoints,n=e.flow,a=e.onLoad,r=e.forceSaveOnLoad;this.props.fetchFlow(t,n,a,r)}},{key:"handleDownloadClicked",value:function(){!function(e,t){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",t+".json"),document.body.appendChild(a),a.click(),a.remove()}(Sc(this.props.definition,this.props.nodes),"definition")}},{key:"handleVisibilityChanged",value:function(e){this.props.mergeEditorState({visible:e,activityInterval:5e3})}},{key:"getAlertModal",value:function(){var e=this;return this.props.modalMessage?b.createElement(Su,{width:"600px",show:!0},b.createElement(ce,{className:Cd.a.alert_modal,title:this.props.modalMessage.title,headerClass:"alert",buttons:{primary:{name:"Ok",onClick:function(){e.props.mergeEditorState({modalMessage:null})}}}},b.createElement("div",{className:Cd.a.alert_body},this.props.modalMessage.body))):null}},{key:"getSavingIndicator",value:function(){return this.props.saving?b.createElement("div",{className:Cd.a.saving},b.createElement(ue,null,b.createElement(du,{units:5,color:"#3498db",size:7}))):null}},{key:"getFooter",value:function(){return!this.props.fetchingFlow&&this.context.config.showDownload?b.createElement("div",{className:Cd.a.footer},b.createElement("div",{className:Cd.a.download_button},b.createElement(ae,{name:"Download",onClick:this.handleDownloadClicked,type:N.primary}))):null}},{key:"render",value:function(){return b.createElement(Gd,{onChange:this.handleVisibilityChanged},b.createElement("div",{id:"editor-container",className:this.props.translating?Cd.a.translating:void 0,"data-spec":"editor-container"},this.getFooter(),this.getAlertModal(),b.createElement("div",{className:Cd.a.editor,"data-spec":"editor"},V(this.props.languages&&Object.keys(this.props.languages.items).length>0)(b.createElement(Nd,null)),this.getSavingIndicator(),V(this.props.definition&&this.props.language&&!this.props.fetchingFlow)(b.createElement(kd,null)),b.createElement(Id,{simulating:this.props.simulating,loadFlowDefinition:this.props.loadFlowDefinition,createNewRevision:this.props.createNewRevision,assetStore:this.props.assetStore}))))}}]),t}(b.Component);Qd.contextTypes=Yd;var Xd=Object(Hn.b)(function(e){var t=e.flowContext,n=t.definition,a=t.dependencies,r=t.nodes,i=t.assetStore,o=e.editorState,s=o.translating,l=o.language,c=o.fetchingFlow,u=o.simulating;return{modalMessage:o.modalMessage,saving:o.saving,simulating:u,assetStore:i,translating:s,language:l,fetchingFlow:c,definition:n,dependencies:a,nodes:r,languages:i?i.languages:null}},function(e){return Object(de.bindActionCreators)({fetchFlow:$l,loadFlowDefinition:Zl,createNewRevision:Xl,mergeEditorState:Ql},e)})(Qd),Zd=function(e){var t=e.config;return b.createElement(hl,{config:Kd({},t)},b.createElement(Hn.a,{store:Wd},b.createElement(Xd,null)))},$d=n(36),Jd=n.n($d);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.showFlowEditor=function(e,t){Jd.a.render(O.a.createElement(Zd,{config:t}),e)},"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},34:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",node_container:"Node_node_container__2eaRs",uuid:"Node_uuid__1gU_w",ghost:"Node_ghost__1rJWj",nondragged:"Node_nondragged__3odZa",selected:"Node_selected__1ck3F",node:"Node_node__2ympr",immutable:"Node_immutable__2NDYM",save_as:"Node_save_as__27Fv-",save_result:"Node_save_result__cnC6y",result_name:"Node_result_name__1F10Q",cropped:"Node_cropped__3mV37",exit_table:"Node_exit_table__3NybR",exits:"Node_exits__3zABv",add:"Node_add__3PamH",drag_group:"Node_drag_group__1h4JV",flow_start:"Node_flow_start__2ZLmX",flow_start_message:"Node_flow_start_message__21Gdu",active:"Node_active__31xXM",pulse:"Node_pulse__14AYP"}},35:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",group:"CaseElement_group__1fyWB",divider:"CaseElement_divider__mkeU9",kase:"CaseElement_kase__2vP_O",has_intent:"CaseElement_has_intent__z8znp",choice:"CaseElement_choice__2RZct",has_top_intent:"CaseElement_has_top_intent__3fsYv",multi_operand:"CaseElement_multi_operand__eTLuc",form_group:"CaseElement_form_group__1PJTx",single_operand:"CaseElement_single_operand__o0kaN",categorize_as:"CaseElement_categorize_as__XFySp",category:"CaseElement_category__2yfW1",remove_icon:"CaseElement_remove_icon__1PFzv",dnd_icon:"CaseElement_dnd_icon__wjvHF",relative_date:"CaseElement_relative_date__DGZXt",empty:"CaseElement_empty__35kBB"}},39:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",action:"Action_action__NVQRK",has_router:"Action_has_router__1Ad-S",body:"Action_body__RtQCZ",add_contact_urn:"Action_add_contact_urn__3Z706",add_input_labels:"Action_add_input_labels__3IeO3",send_msg:"Action_send_msg__1QYPk",set_contact_field:"Action_set_contact_field__1HDvu",set_contact_name:"Action_set_contact_name__1woBb",call_webhook:"Action_call_webhook__2kR_s",call_resthook:"Action_call_resthook__2zGlX",set_contact_language:"Action_set_contact_language__G9Ko5",set_contact_channel:"Action_set_contact_channel__1YEwX",add_contact_groups:"Action_add_contact_groups__3H0fU",remove_contact_groups:"Action_remove_contact_groups__3h7vs",play_audio:"Action_play_audio__ShGHx",say_msg:"Action_say_msg__3CqFc",set_run_result:"Action_set_run_result__1CLz_",send_email:"Action_send_email__2MDnO",send_broadcast:"Action_send_broadcast__1SCyf",transfer_airtime:"Action_transfer_airtime__2LvoA",missing:"Action_missing__1Ghl9",enter_flow:"Action_enter_flow__2ogxI",call_classifier:"Action_call_classifier__tKBlJ",start_session:"Action_start_session__1yM-7",not_localizable:"Action_not_localizable__2rKMk",overlay:"Action_overlay__ZEDK0",immutable:"Action_immutable__qAZdN",translate_from:"Action_translate_from__3BID_",translate_to:"Action_translate_to__TPeJw",translating:"Action_translating__2n0n7",missing_localization:"Action_missing_localization__1zslf",localized:"Action_localized__3Mwip"}},40:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",link:"WebhookRouterForm_link__1jXIk",info:"WebhookRouterForm_info__qgGFO",method:"WebhookRouterForm_method__1IR0U",url:"WebhookRouterForm_url__T29iJ",code:"WebhookRouterForm_code__3x1A-",instructions:"WebhookRouterForm_instructions__3LG_X",headers_title:"WebhookRouterForm_headers_title__1GMIG",remove_ico:"WebhookRouterForm_remove_ico__l-jUh",example:"WebhookRouterForm_example__1ev4D",header:"WebhookRouterForm_header__2waYT",header_name:"WebhookRouterForm_header_name__3eQVG",header_value:"WebhookRouterForm_header_value__1Fxrk",body_form:"WebhookRouterForm_body_form__3BHas",req_body:"WebhookRouterForm_req_body__1rKz_"}},41:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",simulating:"RevisionExplorer_simulating__3ar2x",mask:"RevisionExplorer_mask__14GgE",visible:"RevisionExplorer_visible__365U6",explorer_wrapper:"RevisionExplorer_explorer_wrapper__3FIUU",explorer:"RevisionExplorer_explorer__1yYSY",revisions:"RevisionExplorer_revisions__1nYCu",revision:"RevisionExplorer_revision__3f_kl",selected:"RevisionExplorer_selected__2zSg4",button:"RevisionExplorer_button__2srjQ",current:"RevisionExplorer_current__Zlqcr",created_on:"RevisionExplorer_created_on__qKoNX",email:"RevisionExplorer_email__Z9xlH"}},43:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",ele:"FormElement_ele__1FpYO",border:"FormElement_border__3bx0s",error_list:"FormElement_error_list__1SrT3",error:"FormElement_error__1Peb9",arrow_up:"FormElement_arrow_up__2HvAv",send_msg_error:"FormElement_send_msg_error__3LIUw",label:"FormElement_label__2dN0p",invalid:"FormElement_invalid__1fOa-",help_text:"FormElement_help_text__a6EcV"}},45:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",checkbox:"SendMsgForm_checkbox__-JOyy",quick_reply_summary:"SendMsgForm_quick_reply_summary__DkA4i",type_choice:"SendMsgForm_type_choice__1dciq",url_attachment:"SendMsgForm_url_attachment__1Su5F",upload:"SendMsgForm_upload__22kwL",remove_upload:"SendMsgForm_remove_upload__2qqap",url:"SendMsgForm_url__2eR-o",remove:"SendMsgForm_remove__20sFL",existing_quick_replies:"SendMsgForm_existing_quick_replies__W866I",existing_quick_reply:"SendMsgForm_existing_quick_reply__2C65m",add_quick_replies:"SendMsgForm_add_quick_replies__3vLIC",template_text:"SendMsgForm_template_text__1zkKJ",variable:"SendMsgForm_variable__3mVDI"}},47:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",delimited:"ResultRouterForm_delimited__D-_e5",non_delimited:"ResultRouterForm_non_delimited__yDNVq",lead_in:"ResultRouterForm_lead_in__2myeK",lead_in_sub:"ResultRouterForm_lead_in_sub__3oqJC",result_select:"ResultRouterForm_result_select__1cu2c",result_select_delimited:"ResultRouterForm_result_select_delimited__f-y6Z",should_delimit:"ResultRouterForm_should_delimit__1Z8-4",field_number:"ResultRouterForm_field_number__2WFxV",delimiter:"ResultRouterForm_delimiter__2i5Hr"}},49:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",titlebar:"TitleBar_titlebar__1_zDw",titletext:"TitleBar_titletext__3s2we",normal:"TitleBar_normal__z0QaD",remove_confirm:"TitleBar_remove_confirm__3ywj-",remove_button:"TitleBar_remove_button__2lO9D",up_button:"TitleBar_up_button__2Imiq"}},50:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",pop_wrapper:"PopTab_pop_wrapper__2kOzQ",visible:"PopTab_visible__2udNm",popped:"PopTab_popped__2Imlz",tab_wrapper:"PopTab_tab_wrapper__3n1QM",tab:"PopTab_tab__2Rm5M",label:"PopTab_label__nf1JX",icon:"PopTab_icon__irClb",header:"PopTab_header__1NqmE",header_label:"PopTab_header_label__2YD7z",close:"PopTab_close__3O5BS"}},54:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",random:"shared_random__URuHQ",wait_for_audio:"shared_wait_for_audio__1LjH-",wait_for_image:"shared_wait_for_image__3VU9W",wait_for_video:"shared_wait_for_video__1nv-a",wait_for_location:"shared_wait_for_location__2al5E",wait_for_menu:"shared_wait_for_menu__hot7M",wait_for_digits:"shared_wait_for_digits__35WPZ",wait_for_response:"shared_wait_for_response__ZKUbx",add_contact_groups:"shared_add_contact_groups__2dqfS",remove_contact_groups:"shared_remove_contact_groups__1dJrQ",send_email:"shared_send_email__dY51y",send_broadcast:"shared_send_broadcast__3LXs5",msg:"shared_msg__28OwU",say_msg:"shared_say_msg__2U3R0",send_msg:"shared_send_msg__2tEfv",transfer_airtime:"shared_transfer_airtime__1H5tV",enter_flow:"shared_enter_flow__XHnXb",start_session:"shared_start_session__1f3aq",set_run_result:"shared_set_run_result__1QltP",add_input_labels:"shared_add_input_labels__2pTX0",add_contact_urn:"shared_add_contact_urn__3nXG-",set_contact_name:"shared_set_contact_name__KV1Re",set_contact_field:"shared_set_contact_field__3VSZH",set_contact_language:"shared_set_contact_language__4ZBkW",set_contact_channel:"shared_set_contact_channel__3NhjI",play_audio:"shared_play_audio__2OF7K",missing:"shared_missing__2oICX",call_classifier:"shared_call_classifier__3zcuw",split_by_random:"shared_split_by_random__Zh1SY",split_by_expression:"shared_split_by_expression__3k23C",split_by_groups:"shared_split_by_groups__5EnH4",split_by_contact_field:"shared_split_by_contact_field__1XjX5",split_by_intent:"shared_split_by_intent__1H9sN",split_by_run_result:"shared_split_by_run_result__X4-Wp",call_resthook:"shared_call_resthook__16wqp",call_webhook:"shared_call_webhook__1h1Cb",breaks:"shared_breaks__2F4AL",url:"shared_url__1vtQK",node_asset:"shared_node_asset__2MOdQ",node_group:"shared_node_group__ju7iK",node_label:"shared_node_label__1lQNA",advanced_title:"shared_advanced_title__2auaT",alert:"shared_alert__1JnkA"}},61:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",count:"CharCount_count__ABAEX",tooltip:"CharCount_tooltip__1p2RV",fine_print:"CharCount_fine_print__RYzHy",divider:"CharCount_divider__3pF0R",tooltip_text:"CharCount_tooltip_text__3ruDu",unicode:"CharCount_unicode__1nLUL"}},62:function(e,t,n){e.exports={player:"MediaPlayer_player__gYGWS",playing:"MediaPlayer_playing__2Jrw_",button:"MediaPlayer_button__rRXz1",circles:"MediaPlayer_circles__1pr_0",circle_background:"MediaPlayer_circle_background__OMPcS",circle_foreground:"MediaPlayer_circle_foreground__1L6K9"}},63:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",translating_categories:"RouterLocalizationForm_translating_categories__34-3g",translating_category:"RouterLocalizationForm_translating_category__1GtBO",translating_from:"RouterLocalizationForm_translating_from__1jvjb",translating_to:"RouterLocalizationForm_translating_to__1m7uk",translating_operator_title:"RouterLocalizationForm_translating_operator_title__3vA3V",translating_operator_instructions:"RouterLocalizationForm_translating_operator_instructions___Yv3N",translating_operator_container:"RouterLocalizationForm_translating_operator_container__39jsM",translating_operator:"RouterLocalizationForm_translating_operator__AgpTS"}},64:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",drag_helper:"DragHelper_drag_helper__a_fFa",visible:"DragHelper_visible__1Z4lg",arrow:"DragHelper_arrow__YH1ED",tail:"DragHelper_tail__12x7O",help_text:"DragHelper_help_text__2luNE",head:"DragHelper_head__3ViUG",bold:"DragHelper_bold__2v--u"}},65:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",editor:"components_editor__36a9s",translating:"components_translating__1uBgy",footer:"components_footer__1OFgP",download_button:"components_download_button__392jz",alert_body:"components_alert_body__2Bxt0",alert_modal:"components_alert_modal__3xFu-",saving:"components_saving__1mebj"}},73:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",message:"AssetSelector_message__1viBV"}},74:function(e,t,n){e.exports={label:"CheckboxElement_label__3vFGD",title:"CheckboxElement_title__3QShp",description:"CheckboxElement_description__3BguK",description_solo:"CheckboxElement_description_solo__2o0rh"}},75:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",quick_replies:"SendMsg_quick_replies__2bre8",attachment:"SendMsg_attachment__1JoQl",summary:"SendMsg_summary__2c05X",whatsapp:"SendMsg_whatsapp__2O95I",line:"SendMsg_line__LMI4I"}},76:function(e,t,n){e.exports={form_element:"CurrencyElement_form_element__F0wio",transfer:"CurrencyElement_transfer__1IAVm",currency:"CurrencyElement_currency__278L2",amount:"CurrencyElement_amount__fJKsJ",remove:"CurrencyElement_remove__3D5_y"}},80:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",btn:"Button_btn__1hdG6",disabled:"Button_disabled__xk6Qi",primary:"Button_primary__3PDu-",active:"Button_active__3BxT0",secondary:"Button_secondary__1LfJY",tertiary:"Button_tertiary__3UJsa"}},82:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",pill:"Pill_pill__3FyMl",clickable:"Pill_clickable__24gn3",icon:"Pill_icon__QZrb0",large:"Pill_large__3mcHa"}},83:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",recipients:"SendBroadcast_recipients__1ZSQV",node:"SendBroadcast_node__26RLX",to:"SendBroadcast_to__25_7K",name:"SendBroadcast_name__RNJWu",icon:"SendBroadcast_icon__2YfpF",more:"SendBroadcast_more__11MJm",message:"SendBroadcast_message__6ZIco",line:"SendBroadcast_line__3Dm3R"}},84:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",lead_in:"MenuRouterForm_lead_in__253j6",digit:"MenuRouterForm_digit__ruJhi",category:"MenuRouterForm_category__2Khjv",menu:"MenuRouterForm_menu__OrNSa",menu_option:"MenuRouterForm_menu_option__2e-jl"}},85:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",lead_in:"RandomRouterForm_lead_in__2iUt2",bucket_select:"RandomRouterForm_bucket_select__5jt8Q",bucket_list:"RandomRouterForm_bucket_list__14I85",bucket_name:"RandomRouterForm_bucket_name__t3I5z"}},86:function(e,t,n){e.exports={timeout_control_container:"TimeoutControl_timeout_control_container__ChGjA",left_section:"TimeoutControl_left_section__23W9H",label:"TimeoutControl_label__3L-JA",checkbox:"TimeoutControl_checkbox__NYV4k",drop_down:"TimeoutControl_drop_down__2Yy9r"}},87:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",language:"LanguageSelector_language__3Q3TZ",language_link:"LanguageSelector_language_link__32yIO",active:"LanguageSelector_active__3RqNy",separator:"LanguageSelector_separator__2oanc"}},94:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13"}},95:function(e,t,n){e.exports={ele:"SendEmailForm_ele__2CvL5",subject:"SendEmailForm_subject__U7jTR",message:"SendEmailForm_message__1k6GE"}},96:function(e,t,n){e.exports={form:"SetRunResultForm_form__HNnt4",name:"SetRunResultForm_name__1aW9R",value:"SetRunResultForm_value__36pab",category:"SetRunResultForm_category__TuHWy"}},97:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",node:"StartSession_node__d1IsL",to:"StartSession_to__2uqPY",name:"StartSession_name__HfSVl",icon:"StartSession_icon__1l-0q",more:"StartSession_more__8uoUD",message:"StartSession_message__1KRsK",flow:"StartSession_flow__zPhXS"}},98:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",canvas_container:"Canvas_canvas_container__oR3SR",canvas:"Canvas_canvas__XH7zY",drag_selection:"Canvas_drag_selection__3wxA2"}},99:function(e,t,n){e.exports={grid_size:"20",node_spacing:"13",node_padding:"3","background-size":"13",counter:"Counter_counter__1_pCt",visible:"Counter_visible__3Avdq",clickable:"Counter_clickable__3pprF"}}},[[180,1,2]]]);
//# sourceMappingURL=main.6e7f564a.chunk.js.map